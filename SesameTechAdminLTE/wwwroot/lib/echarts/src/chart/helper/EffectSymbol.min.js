/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/src/chart/helper/EffectSymbol.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as zrUtil from"zrender/src/core/util";import{createSymbol}from"../../util/symbol";import{Group}from"../../util/graphic";import{parsePercent}from"../../util/number";import SymbolClz from"./Symbol";var EFFECT_RIPPLE_NUMBER=3;function normalizeSymbolSize(t){return zrUtil.isArray(t)||(t=[+t,+t]),t}function updateRipplePath(t,e){var o=e.rippleEffectColor||e.color;t.eachChild(function(t){t.attr({z:e.z,zlevel:e.zlevel,style:{stroke:"stroke"===e.brushType?o:null,fill:"fill"===e.brushType?o:null}})})}function EffectSymbol(t,e){Group.call(this);var o=new SymbolClz(t,e),i=new Group;this.add(o),this.add(i),i.beforeUpdate=function(){this.attr(o.getScale())},this.updateData(t,e)}var effectSymbolProto=EffectSymbol.prototype;effectSymbolProto.stopEffectAnimation=function(){this.childAt(1).removeAll()},effectSymbolProto.startEffectAnimation=function(t){for(var e=t.symbolType,o=t.color,i=this.childAt(1),f=0;f<EFFECT_RIPPLE_NUMBER;f++){var r=createSymbol(e,-1,-1,2,2,o);r.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scale:[.5,.5]});var l=-f/EFFECT_RIPPLE_NUMBER*t.period+t.effectOffset;r.animate("",!0).when(t.period,{scale:[t.rippleScale/2,t.rippleScale/2]}).delay(l).start(),r.animateStyle(!0).when(t.period,{opacity:0}).delay(l).start(),i.add(r)}updateRipplePath(i,t)},effectSymbolProto.updateEffectAnimation=function(t){for(var e=this._effectCfg,o=this.childAt(1),i=["symbolType","period","rippleScale"],f=0;f<i.length;f++){var r=i[f];if(e[r]!==t[r])return this.stopEffectAnimation(),void this.startEffectAnimation(t)}updateRipplePath(o,t)},effectSymbolProto.highlight=function(){this.trigger("emphasis")},effectSymbolProto.downplay=function(){this.trigger("normal")},effectSymbolProto.updateData=function(t,e){var o=t.hostModel;this.childAt(0).updateData(t,e);var i=this.childAt(1),f=t.getItemModel(e),r=t.getItemVisual(e,"symbol"),l=normalizeSymbolSize(t.getItemVisual(e,"symbolSize")),a=t.getItemVisual(e,"color");i.attr("scale",l),i.traverse(function(t){t.attr({fill:a})});var s=f.getShallow("symbolOffset");if(s){var n=i.position;n[0]=parsePercent(s[0],l[0]),n[1]=parsePercent(s[1],l[1])}i.rotation=(f.getShallow("symbolRotate")||0)*Math.PI/180||0;var c={};if(c.showEffectOn=o.get("showEffectOn"),c.rippleScale=f.get("rippleEffect.scale"),c.brushType=f.get("rippleEffect.brushType"),c.period=1e3*f.get("rippleEffect.period"),c.effectOffset=e/t.count(),c.z=f.getShallow("z")||0,c.zlevel=f.getShallow("zlevel")||0,c.symbolType=r,c.color=a,c.rippleEffectColor=f.get("rippleEffect.color"),this.off("mouseover").off("mouseout").off("emphasis").off("normal"),"render"===c.showEffectOn)this._effectCfg?this.updateEffectAnimation(c):this.startEffectAnimation(c),this._effectCfg=c;else{this._effectCfg=null,this.stopEffectAnimation();var p=this.childAt(0),h=function(){p.highlight(),"render"!==c.showEffectOn&&this.startEffectAnimation(c)},m=function(){p.downplay(),"render"!==c.showEffectOn&&this.stopEffectAnimation()};this.on("mouseover",h,this).on("mouseout",m,this).on("emphasis",h,this).on("normal",m,this)}this._effectCfg=c},effectSymbolProto.fadeOut=function(t){this.off("mouseover").off("mouseout").off("emphasis").off("normal"),t&&t()},zrUtil.inherits(EffectSymbol,Group);export default EffectSymbol;
//# sourceMappingURL=/sm/d99bd374438fb5466f0c72657b3cce35f186ae572bb17e558c9a010a17e412a2.map