/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/src/chart/gauge/GaugeView.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import PointerPath from"./PointerPath";import*as graphic from"../../util/graphic";import ChartView from"../../view/Chart";import{parsePercent,round,linearMap}from"../../util/number";function parsePosition(e,t){var r=e.get("center"),i=t.getWidth(),a=t.getHeight(),n=Math.min(i,a);return{cx:parsePercent(r[0],t.getWidth()),cy:parsePercent(r[1],t.getHeight()),r:parsePercent(e.get("radius"),n/2)}}function formatLabel(e,t){return t&&("string"==typeof t?e=t.replace("{value}",null!=e?e:""):"function"==typeof t&&(e=t(e))),e}var PI2=2*Math.PI,GaugeView=ChartView.extend({type:"gauge",render:function(e,t,r){this.group.removeAll();var i=e.get("axisLine.lineStyle.color"),a=parsePosition(e,r);this._renderMain(e,t,r,i,a)},dispose:function(){},_renderMain:function(e,t,r,i,a){for(var n=this.group,l=e.getModel("axisLine"),o=l.getModel("lineStyle"),g=e.get("clockwise"),s=-e.get("startAngle")/180*Math.PI,c=((m=-e.get("endAngle")/180*Math.PI)-s)%PI2,h=s,p=o.get("width"),d=l.get("show"),u=0;d&&u<i.length;u++){var m=s+c*Math.min(Math.max(i[u][0],0),1),f=new graphic.Sector({shape:{startAngle:h,endAngle:m,cx:a.cx,cy:a.cy,clockwise:g,r0:a.r-p,r:a.r},silent:!0});f.setStyle({fill:i[u][1]}),f.setStyle(o.getLineStyle(["color","borderWidth","borderColor"])),n.add(f),h=m}var y=function(e){if(e<=0)return i[0][1];for(var t=0;t<i.length;t++)if(i[t][0]>=e&&(0===t?0:i[t-1][0])<e)return i[t][1];return i[t-1][1]};if(!g){var x=s;s=m,m=x}this._renderTicks(e,t,r,y,a,s,m,g),this._renderPointer(e,t,r,y,a,s,m,g),this._renderTitle(e,t,r,y,a),this._renderDetail(e,t,r,y,a)},_renderTicks:function(e,t,r,i,a,n,l,o){for(var g=this.group,s=a.cx,c=a.cy,h=a.r,p=+e.get("min"),d=+e.get("max"),u=e.getModel("splitLine"),m=e.getModel("axisTick"),f=e.getModel("axisLabel"),y=e.get("splitNumber"),x=m.get("splitNumber"),v=parsePercent(u.get("length"),h),M=parsePercent(m.get("length"),h),P=n,w=(l-n)/y,S=w/x,I=u.getModel("lineStyle").getLineStyle(),L=m.getModel("lineStyle").getLineStyle(),_=0;_<=y;_++){var A=Math.cos(P),T=Math.sin(P);if(u.get("show")){var b=new graphic.Line({shape:{x1:A*h+s,y1:T*h+c,x2:A*(h-v)+s,y2:T*(h-v)+c},style:I,silent:!0});"auto"===I.stroke&&b.setStyle({stroke:i(_/y)}),g.add(b)}if(f.get("show")){var k=formatLabel(round(_/y*(d-p)+p),f.get("formatter")),C=f.get("distance"),D=i(_/y);g.add(new graphic.Text({style:graphic.setTextStyle({},f,{text:k,x:A*(h-v-C)+s,y:T*(h-v-C)+c,textVerticalAlign:T<-.4?"top":T>.4?"bottom":"middle",textAlign:A<-.4?"left":A>.4?"right":"center"},{autoColor:D}),silent:!0}))}if(m.get("show")&&_!==y){for(var G=0;G<=x;G++){A=Math.cos(P),T=Math.sin(P);var N=new graphic.Line({shape:{x1:A*h+s,y1:T*h+c,x2:A*(h-M)+s,y2:T*(h-M)+c},silent:!0,style:L});"auto"===L.stroke&&N.setStyle({stroke:i((_+G/x)/y)}),g.add(N),P+=S}P-=S}else P+=w}},_renderPointer:function(e,t,r,i,a,n,l,o){var g=this.group,s=this._data;if(e.get("pointer.show")){var c=[+e.get("min"),+e.get("max")],h=[n,l],p=e.getData(),d=p.mapDimension("value");p.diff(s).add(function(t){var r=new PointerPath({shape:{angle:n}});graphic.initProps(r,{shape:{angle:linearMap(p.get(d,t),c,h,!0)}},e),g.add(r),p.setItemGraphicEl(t,r)}).update(function(t,r){var i=s.getItemGraphicEl(r);graphic.updateProps(i,{shape:{angle:linearMap(p.get(d,t),c,h,!0)}},e),g.add(i),p.setItemGraphicEl(t,i)}).remove(function(e){var t=s.getItemGraphicEl(e);g.remove(t)}).execute(),p.eachItemGraphicEl(function(e,t){var r=p.getItemModel(t),n=r.getModel("pointer");e.setShape({x:a.cx,y:a.cy,width:parsePercent(n.get("width"),a.r),r:parsePercent(n.get("length"),a.r)}),e.useStyle(r.getModel("itemStyle").getItemStyle()),"auto"===e.style.fill&&e.setStyle("fill",i(linearMap(p.get(d,t),c,[0,1],!0))),graphic.setHoverStyle(e,r.getModel("emphasis.itemStyle").getItemStyle())}),this._data=p}else s&&s.eachItemGraphicEl(function(e){g.remove(e)})},_renderTitle:function(e,t,r,i,a){var n=e.getData(),l=n.mapDimension("value"),o=e.getModel("title");if(o.get("show")){var g=o.get("offsetCenter"),s=a.cx+parsePercent(g[0],a.r),c=a.cy+parsePercent(g[1],a.r),h=+e.get("min"),p=+e.get("max"),d=e.getData().get(l,0),u=i(linearMap(d,[h,p],[0,1],!0));this.group.add(new graphic.Text({silent:!0,style:graphic.setTextStyle({},o,{x:s,y:c,text:n.getName(0),textAlign:"center",textVerticalAlign:"middle"},{autoColor:u,forceRich:!0})}))}},_renderDetail:function(e,t,r,i,a){var n=e.getModel("detail"),l=+e.get("min"),o=+e.get("max");if(n.get("show")){var g=n.get("offsetCenter"),s=a.cx+parsePercent(g[0],a.r),c=a.cy+parsePercent(g[1],a.r),h=parsePercent(n.get("width"),a.r),p=parsePercent(n.get("height"),a.r),d=e.getData(),u=d.get(d.mapDimension("value"),0),m=i(linearMap(u,[l,o],[0,1],!0));this.group.add(new graphic.Text({silent:!0,style:graphic.setTextStyle({},n,{x:s,y:c,text:formatLabel(u,n.get("formatter")),textWidth:isNaN(h)?null:h,textHeight:isNaN(p)?null:p,textAlign:"center",textVerticalAlign:"middle"},{autoColor:m,forceRich:!0})}))}}});export default GaugeView;
//# sourceMappingURL=/sm/4ad27af3a1920c0d39b993d8a315e13f666830e23740055046c23d4a8dc9a6e4.map