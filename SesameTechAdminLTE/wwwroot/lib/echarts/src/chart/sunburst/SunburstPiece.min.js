/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/src/chart/sunburst/SunburstPiece.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as zrUtil from"zrender/src/core/util";import*as graphic from"../../util/graphic";var NodeHighlightPolicy={NONE:"none",DESCENDANT:"descendant",ANCESTOR:"ancestor",SELF:"self"},DEFAULT_SECTOR_Z=2,DEFAULT_TEXT_Z=4;function SunburstPiece(e,t,o){graphic.Group.call(this);var i=new graphic.Sector({z2:DEFAULT_SECTOR_Z});i.seriesIndex=t.seriesIndex;var l=new graphic.Text({z2:DEFAULT_TEXT_Z,silent:e.getModel("label").get("silent")});function n(){l.ignore=l.hoverIgnore}function r(){l.ignore=l.normalIgnore}this.add(i),this.add(l),this.updateData(!0,e,"normal",t,o),this.on("emphasis",n).on("normal",r).on("mouseover",n).on("mouseout",r)}var SunburstPieceProto=SunburstPiece.prototype;SunburstPieceProto.updateData=function(e,t,o,i,l){this.node=t,t.piece=this,i=i||this._seriesModel,l=l||this._ecModel;var n=this.childAt(0);n.dataIndex=t.dataIndex;var r=t.getModel(),a=t.getLayout(),s=zrUtil.extend({},a);s.label=null;var h=getNodeColor(t,i,l);fillDefaultColor(t,i,h);var u,d=r.getModel("itemStyle").getItemStyle();if("normal"===o)u=d;else{var c=r.getModel(o+".itemStyle").getItemStyle();u=zrUtil.merge(c,d)}u=zrUtil.defaults({lineJoin:"bevel",fill:u.fill||h},u),e?(n.setShape(s),n.shape.r=a.r0,graphic.updateProps(n,{shape:{r:a.r}},i,t.dataIndex),n.useStyle(u)):"object"==typeof u.fill&&u.fill.type||"object"==typeof n.style.fill&&n.style.fill.type?(graphic.updateProps(n,{shape:s},i),n.useStyle(u)):graphic.updateProps(n,{shape:s,style:u},i),this._updateLabel(i,h,o);var g=r.getShallow("cursor");if(g&&n.attr("cursor",g),e){var p=i.getShallow("highlightPolicy");this._initEvents(n,t,i,p)}this._seriesModel=i||this._seriesModel,this._ecModel=l||this._ecModel},SunburstPieceProto.onEmphasis=function(e){var t=this;this.node.hostTree.root.eachNode(function(o){o.piece&&(t.node===o?o.piece.updateData(!1,o,"emphasis"):isNodeHighlighted(o,t.node,e)?o.piece.childAt(0).trigger("highlight"):e!==NodeHighlightPolicy.NONE&&o.piece.childAt(0).trigger("downplay"))})},SunburstPieceProto.onNormal=function(){this.node.hostTree.root.eachNode(function(e){e.piece&&e.piece.updateData(!1,e,"normal")})},SunburstPieceProto.onHighlight=function(){this.updateData(!1,this.node,"highlight")},SunburstPieceProto.onDownplay=function(){this.updateData(!1,this.node,"downplay")},SunburstPieceProto._updateLabel=function(e,t,o){var i=this.node.getModel(),l=i.getModel("label"),n="normal"===o||"emphasis"===o?l:i.getModel(o+".label"),r=i.getModel("emphasis.label"),a=zrUtil.retrieve(e.getFormattedLabel(this.node.dataIndex,o,null,null,"label"),this.node.name);!1===I("show")&&(a="");var s=this.node.getLayout(),h=n.get("minAngle");null==h&&(h=l.get("minAngle")),h=h/180*Math.PI;var u=s.endAngle-s.startAngle;null!=h&&Math.abs(u)<h&&(a="");var d=this.childAt(1);graphic.setLabelStyle(d.style,d.hoverStyle||{},l,r,{defaultText:n.getShallow("show")?a:null,autoColor:t,useInsideStyle:!0});var c,g=(s.startAngle+s.endAngle)/2,p=Math.cos(g),f=Math.sin(g),m=I("position"),P=I("distance")||0,v=I("align");"outside"===m?(c=s.r+P,v=g>Math.PI/2?"right":"left"):v&&"center"!==v?"left"===v?(c=s.r0+P,g>Math.PI/2&&(v="right")):"right"===v&&(c=s.r-P,g>Math.PI/2&&(v="left")):(c=(s.r+s.r0)/2,v="center"),d.attr("style",{text:a,textAlign:v,textVerticalAlign:I("verticalAlign")||"middle",opacity:I("opacity")});var y=c*p+s.cx,S=c*f+s.cy;d.attr("position",[y,S]);var M=I("rotate"),b=0;function I(e){var t=n.get(e);return null==t?l.get(e):t}"radial"===M?(b=-g)<-Math.PI/2&&(b+=Math.PI):"tangential"===M?(b=Math.PI/2-g)>Math.PI/2?b-=Math.PI:b<-Math.PI/2&&(b+=Math.PI):"number"==typeof M&&(b=M*Math.PI/180),d.attr("rotation",b)},SunburstPieceProto._initEvents=function(e,t,o,i){e.off("mouseover").off("mouseout").off("emphasis").off("normal");var l=this,n=function(){l.onEmphasis(i)},r=function(){l.onNormal()};o.isAnimationEnabled()&&e.on("mouseover",n).on("mouseout",r).on("emphasis",n).on("normal",r).on("downplay",function(){l.onDownplay()}).on("highlight",function(){l.onHighlight()})},zrUtil.inherits(SunburstPiece,graphic.Group);export default SunburstPiece;function getNodeColor(e,t,o){var i=e.getVisual("color"),l=e.getVisual("visualMeta");l&&0!==l.length||(i=null);var n=e.getModel("itemStyle").get("color");if(n)return n;if(i)return i;if(0===e.depth)return o.option.color[0];var r=o.option.color.length;return n=o.option.color[getRootId(e)%r]}function getRootId(e){for(var t=e;t.depth>1;)t=t.parentNode;var o=e.getAncestors()[0];return zrUtil.indexOf(o.children,t)}function isNodeHighlighted(e,t,o){return o!==NodeHighlightPolicy.NONE&&(o===NodeHighlightPolicy.SELF?e===t:o===NodeHighlightPolicy.ANCESTOR?e===t||e.isAncestorOf(t):e===t||e.isDescendantOf(t))}function fillDefaultColor(e,t,o){t.getData().setItemVisual(e.dataIndex,"color",o)}
//# sourceMappingURL=/sm/f9719edd352207ad131861efd69897dd80d7d7a98c916a65185fdbc6a9bbe405.map