/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/src/chart/funnel/funnelLayout.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as layout from"../../util/layout";import{parsePercent,linearMap}from"../../util/number";function getViewRect(e,t){return layout.getLayoutRect(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function getSortedIndices(e,t){for(var i=e.mapDimension("value"),n=e.mapArray(i,function(e){return e}),r=[],a="ascending"===t,o=0,g=e.count();o<g;o++)r[o]=o;return"function"==typeof t?r.sort(t):"none"!==t&&r.sort(function(e,t){return a?n[e]-n[t]:n[t]-n[e]}),r}function labelLayout(e){e.each(function(t){var i,n,r,a,o=e.getItemModel(t),g=o.getModel("label").get("position"),l=o.getModel("labelLine"),c=e.getItemLayout(t),u=c.points,s="inner"===g||"inside"===g||"center"===g||"insideLeft"===g||"insideRight"===g;if(s)"insideLeft"===g?(n=(u[0][0]+u[3][0])/2+5,r=(u[0][1]+u[3][1])/2,i="left"):"insideRight"===g?(n=(u[1][0]+u[2][0])/2-5,r=(u[1][1]+u[2][1])/2,i="right"):(n=(u[0][0]+u[1][0]+u[2][0]+u[3][0])/4,r=(u[0][1]+u[1][1]+u[2][1]+u[3][1])/4,i="center"),a=[[n,r],[n,r]];else{var h,f,d,m=l.get("length");"left"===g?(h=(u[3][0]+u[0][0])/2,f=(u[3][1]+u[0][1])/2,n=(d=h-m)-5,i="right"):"right"===g?(h=(u[1][0]+u[2][0])/2,f=(u[1][1]+u[2][1])/2,n=(d=h+m)+5,i="left"):"rightTop"===g?(h=u[1][0],f=u[1][1],n=(d=h+m)+5,i="top"):"rightBottom"===g?(h=u[2][0],f=u[2][1],n=(d=h+m)+5,i="bottom"):"leftTop"===g?(h=u[0][0],f=u[1][1],n=(d=h-m)-5,i="right"):"leftBottom"===g?(h=u[3][0],f=u[2][1],n=(d=h-m)-5,i="right"):(h=(u[1][0]+u[2][0])/2,f=(u[1][1]+u[2][1])/2,n=(d=h+m)+5,i="left");a=[[h,f],[d,f]],r=f}c.label={linePoints:a,x:n,y:r,verticalAlign:"middle",textAlign:i,inside:s}})}export default function(e,t,i){e.eachSeriesByType("funnel",function(e){var i=e.getData(),n=i.mapDimension("value"),r=e.get("sort"),a=getViewRect(e,t),o=getSortedIndices(i,r),g=[parsePercent(e.get("minSize"),a.width),parsePercent(e.get("maxSize"),a.width)],l=i.getDataExtent(n),c=e.get("min"),u=e.get("max");null==c&&(c=Math.min(l[0],0)),null==u&&(u=l[1]);var s=e.get("funnelAlign"),h=e.get("gap"),f=(a.height-h*(i.count()-1))/i.count(),d=a.y,m=function(e,t){var r,o=i.get(n,e)||0,l=linearMap(o,[c,u],g,!0);switch(s){case"left":r=a.x;break;case"center":r=a.x+(a.width-l)/2;break;case"right":r=a.x+a.width-l}return[[r,t],[r+l,t]]};"ascending"===r&&(f=-f,h=-h,d+=a.height,o=o.reverse());for(var p=0;p<o.length;p++){var y=o[p],v=o[p+1],x=i.getItemModel(y).get("itemStyle.height");null==x?x=f:(x=parsePercent(x,a.height),"ascending"===r&&(x=-x));var b=m(y,d),L=m(v,d+x);d+=x+h,i.setItemLayout(y,{points:b.concat(L.slice().reverse())})}labelLayout(i)})}
//# sourceMappingURL=/sm/31c9ed0e850ebc2db9fcc508030cd3aee49a6e3ea47e28ccf9dee1aa7588cbe5.map