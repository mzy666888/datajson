/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/src/model/OptionManager.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as zrUtil from"zrender/src/core/util";import*as modelUtil from"../util/model";import ComponentModel from"./Component";var each=zrUtil.each,clone=zrUtil.clone,map=zrUtil.map,merge=zrUtil.merge,QUERY_REG=/^(min|max)?(.+)$/;function OptionManager(i){this._api=i,this._timelineOptions=[],this._mediaList=[],this._mediaDefault,this._currentMediaIndices=[],this._optionBackup,this._newBaseOption}function parseRawOption(i,t,e){var n,o,a=[],r=[],s=i.timeline;if(i.baseOption&&(o=i.baseOption),(s||i.options)&&(o=o||{},a=(i.options||[]).slice()),i.media){o=o||{};var p=i.media;each(p,function(i){i&&i.option&&(i.query?r.push(i):n||(n=i))})}return o||(o=i),o.timeline||(o.timeline=s),each([o].concat(a).concat(zrUtil.map(r,function(i){return i.option})),function(i){each(t,function(t){t(i,e)})}),{baseOption:o,timelineOptions:a,mediaDefault:n,mediaList:r}}function applyMediaQuery(i,t,e){var n={width:t,height:e,aspectratio:t/e},o=!0;return zrUtil.each(i,function(i,t){var e=t.match(QUERY_REG);if(e&&e[1]&&e[2]){var a=e[1],r=e[2].toLowerCase();compare(n[r],i,a)||(o=!1)}}),o}function compare(i,t,e){return"min"===e?i>=t:"max"===e?i<=t:i===t}function indicesEquals(i,t){return i.join(",")===t.join(",")}function mergeOption(i,t){each(t=t||{},function(t,e){if(null!=t){var n=i[e];if(ComponentModel.hasClass(e)){t=modelUtil.normalizeToArray(t),n=modelUtil.normalizeToArray(n);var o=modelUtil.mappingToExists(n,t);i[e]=map(o,function(i){return i.option&&i.exist?merge(i.exist,i.option,!0):i.exist||i.option})}else i[e]=merge(n,t,!0)}})}OptionManager.prototype={constructor:OptionManager,setOption:function(i,t){i&&zrUtil.each(modelUtil.normalizeToArray(i.series),function(i){i&&i.data&&zrUtil.isTypedArray(i.data)&&zrUtil.setAsPrimitive(i.data)}),i=clone(i);var e=this._optionBackup,n=parseRawOption.call(this,i,t,!e);this._newBaseOption=n.baseOption,e?(mergeOption(e.baseOption,n.baseOption),n.timelineOptions.length&&(e.timelineOptions=n.timelineOptions),n.mediaList.length&&(e.mediaList=n.mediaList),n.mediaDefault&&(e.mediaDefault=n.mediaDefault)):this._optionBackup=n},mountOption:function(i){var t=this._optionBackup;return this._timelineOptions=map(t.timelineOptions,clone),this._mediaList=map(t.mediaList,clone),this._mediaDefault=clone(t.mediaDefault),this._currentMediaIndices=[],clone(i?t.baseOption:this._newBaseOption)},getTimelineOption:function(i){var t,e=this._timelineOptions;if(e.length){var n=i.getComponent("timeline");n&&(t=clone(e[n.getCurrentIndex()],!0))}return t},getMediaOption:function(i){var t=this._api.getWidth(),e=this._api.getHeight(),n=this._mediaList,o=this._mediaDefault,a=[],r=[];if(!n.length&&!o)return r;for(var s=0,p=n.length;s<p;s++)applyMediaQuery(n[s].query,t,e)&&a.push(s);return!a.length&&o&&(a=[-1]),a.length&&!indicesEquals(a,this._currentMediaIndices)&&(r=map(a,function(i){return clone(-1===i?o.option:n[i].option)})),this._currentMediaIndices=a,r}};export default OptionManager;
//# sourceMappingURL=/sm/78b577c477e93b124aca8c0fe93f8a4f22b4424e06104ea6f8b99ead91adf969.map