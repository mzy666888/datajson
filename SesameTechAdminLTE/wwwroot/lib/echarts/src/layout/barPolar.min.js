/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/src/layout/barPolar.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as zrUtil from"zrender/src/core/util";import{parsePercent}from"../util/number";import{isDimensionStacked}from"../data/helper/dataStackHelper";function getSeriesStackId(t){return t.get("stack")||"__ec_stack_"+t.seriesIndex}function getAxisKey(t,e){return e.dim+t.model.componentIndex}function barLayoutPolar(t,e,a){var i={},r=calRadialBar(zrUtil.filter(e.getSeriesByType(t),function(t){return!e.isSeriesFiltered(t)&&t.coordinateSystem&&"polar"===t.coordinateSystem.type}));e.eachSeriesByType(t,function(t){if("polar"===t.coordinateSystem.type){var e=t.getData(),a=t.coordinateSystem,n=a.getBaseAxis(),d=getAxisKey(a,n),o=getSeriesStackId(t),s=r[d][o],c=s.offset,h=s.width,m=a.getOtherAxis(n),g=t.coordinateSystem.cx,u=t.coordinateSystem.cy,l=t.get("barMinHeight")||0,p=t.get("barMinAngle")||0;i[o]=i[o]||[];for(var y=e.mapDimension(m.dim),f=e.mapDimension(n.dim),x=isDimensionStacked(e,y),S="radius"!==n.dim||!t.get("roundCap",!0),v=m.getExtent()[0],W=0,b=e.count();W<b;W++){var w=e.get(y,W),M=e.get(f,W);if(!isNaN(w)){var k,A,P,z,I=w>=0?"p":"n",B=v;if(x&&(i[o][M]||(i[o][M]={p:v,n:v}),B=i[o][M][I]),"radius"===m.dim){var U=m.dataToRadius(w)-v,D=n.dataToAngle(M);Math.abs(U)<l&&(U=(U<0?-1:1)*l),k=B,A=B+U,z=(P=D-c)-h,x&&(i[o][M][I]=A)}else{var T=m.dataToAngle(w,S)-v,C=n.dataToRadius(M);Math.abs(T)<p&&(T=(T<0?-1:1)*p),A=(k=C+c)+h,P=B,z=B+T,x&&(i[o][M][I]=z)}e.setItemLayout(W,{cx:g,cy:u,r0:k,r:A,startAngle:-P*Math.PI/180,endAngle:-z*Math.PI/180})}}}},this)}function calRadialBar(t,e){var a={};zrUtil.each(t,function(t,e){var i=t.getData(),r=t.coordinateSystem,n=r.getBaseAxis(),d=getAxisKey(r,n),o=n.getExtent(),s="category"===n.type?n.getBandWidth():Math.abs(o[1]-o[0])/i.count(),c=a[d]||{bandWidth:s,remainedWidth:s,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},h=c.stacks;a[d]=c;var m=getSeriesStackId(t);h[m]||c.autoWidthCount++,h[m]=h[m]||{width:0,maxWidth:0};var g=parsePercent(t.get("barWidth"),s),u=parsePercent(t.get("barMaxWidth"),s),l=t.get("barGap"),p=t.get("barCategoryGap");g&&!h[m].width&&(g=Math.min(c.remainedWidth,g),h[m].width=g,c.remainedWidth-=g),u&&(h[m].maxWidth=u),null!=l&&(c.gap=l),null!=p&&(c.categoryGap=p)});var i={};return zrUtil.each(a,function(t,e){i[e]={};var a=t.stacks,r=t.bandWidth,n=parsePercent(t.categoryGap,r),d=parsePercent(t.gap,1),o=t.remainedWidth,s=t.autoWidthCount,c=(o-n)/(s+(s-1)*d);c=Math.max(c,0),zrUtil.each(a,function(t,e){var a=t.maxWidth;a&&a<c&&(a=Math.min(a,o),t.width&&(a=Math.min(a,t.width)),o-=a,t.width=a,s--)}),c=(o-n)/(s+(s-1)*d),c=Math.max(c,0);var h,m=0;zrUtil.each(a,function(t,e){t.width||(t.width=c),h=t,m+=t.width*(1+d)}),h&&(m-=h.width*d);var g=-m/2;zrUtil.each(a,function(t,a){i[e][a]=i[e][a]||{offset:g,width:t.width},g+=t.width*(1+d)})}),i}export default barLayoutPolar;
//# sourceMappingURL=/sm/c941cb771b15b3d726f2183e34c3241589c1aed5bf651dd0a0a9423ca780244a.map