/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/src/util/graphic.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as zrUtil from"zrender/src/core/util";import*as pathTool from"zrender/src/tool/path";import*as colorTool from"zrender/src/tool/color";import*as matrix from"zrender/src/core/matrix";import*as vector from"zrender/src/core/vector";import Path from"zrender/src/graphic/Path";import Transformable from"zrender/src/mixin/Transformable";import ZImage from"zrender/src/graphic/Image";import Group from"zrender/src/container/Group";import Text from"zrender/src/graphic/Text";import Circle from"zrender/src/graphic/shape/Circle";import Sector from"zrender/src/graphic/shape/Sector";import Ring from"zrender/src/graphic/shape/Ring";import Polygon from"zrender/src/graphic/shape/Polygon";import Polyline from"zrender/src/graphic/shape/Polyline";import Rect from"zrender/src/graphic/shape/Rect";import Line from"zrender/src/graphic/shape/Line";import BezierCurve from"zrender/src/graphic/shape/BezierCurve";import Arc from"zrender/src/graphic/shape/Arc";import CompoundPath from"zrender/src/graphic/CompoundPath";import LinearGradient from"zrender/src/graphic/LinearGradient";import RadialGradient from"zrender/src/graphic/RadialGradient";import BoundingRect from"zrender/src/core/BoundingRect";import IncrementalDisplayable from"zrender/src/graphic/IncrementalDisplayable";import*as subPixelOptimizeUtil from"zrender/src/graphic/helper/subPixelOptimize";var mathMax=Math.max,mathMin=Math.min,EMPTY_OBJ={};export var Z2_EMPHASIS_LIFT=1;export var CACHED_LABEL_STYLE_PROPERTIES={color:"textFill",textBorderColor:"textStroke",textBorderWidth:"textStrokeWidth"};var EMPHASIS="emphasis",NORMAL="normal",_highlightNextDigit=1,_highlightKeyMap={},_customShapeMap={};export function extendShape(t){return Path.extend(t)}export function extendPath(t,e){return pathTool.extendFromString(t,e)}export function registerShape(t,e){_customShapeMap[t]=e}export function getShapeClass(t){if(_customShapeMap.hasOwnProperty(t))return _customShapeMap[t]}export function makePath(t,e,r,o){var i=pathTool.createFromString(t,e);return r&&("center"===o&&(r=centerGraphic(r,i.getBoundingRect())),resizePath(i,r)),i}export function makeImage(t,e,r){var o=new ZImage({style:{image:t,x:e.x,y:e.y,width:e.width,height:e.height},onload:function(t){if("center"===r){var i={width:t.width,height:t.height};o.setStyle(centerGraphic(e,i))}}});return o}function centerGraphic(t,e){var r,o=e.width/e.height,i=t.height*o;return r=i<=t.width?t.height:(i=t.width)/o,{x:t.x+t.width/2-i/2,y:t.y+t.height/2-r/2,width:i,height:r}}export var mergePath=pathTool.mergePath;export function resizePath(t,e){if(t.applyTransform){var r=t.getBoundingRect().calculateTransform(e);t.applyTransform(r)}}export function subPixelOptimizeLine(t){return subPixelOptimizeUtil.subPixelOptimizeLine(t.shape,t.shape,t.style),t}export function subPixelOptimizeRect(t){return subPixelOptimizeUtil.subPixelOptimizeRect(t.shape,t.shape,t.style),t}export var subPixelOptimize=subPixelOptimizeUtil.subPixelOptimize;function hasFillOrStroke(t){return null!=t&&"none"!==t}var liftedColorMap=zrUtil.createHashMap(),liftedColorCount=0;function liftColor(t){if("string"!=typeof t)return t;var e=liftedColorMap.get(t);return e||(e=colorTool.lift(t,-.1),liftedColorCount<1e4&&(liftedColorMap.set(t,e),liftedColorCount++)),e}function cacheElementStl(t){if(t.__hoverStlDirty){t.__hoverStlDirty=!1;var e=t.__hoverStl;if(e){var r=t.__cachedNormalStl={};t.__cachedNormalZ2=t.z2;var o=t.style;for(var i in e)null!=e[i]&&(r[i]=o[i]);r.fill=o.fill,r.stroke=o.stroke}else t.__cachedNormalStl=t.__cachedNormalZ2=null}}function singleEnterEmphasis(t){var e=t.__hoverStl;if(e&&!t.__highlighted){var r=t.__zr,o=t.useHoverLayer&&r&&"canvas"===r.painter.type;if(t.__highlighted=o?"layer":"plain",!(t.isGroup||!r&&t.useHoverLayer)){var i=t,l=t.style;o&&(l=(i=r.addHover(t)).style),rollbackDefaultTextStyle(l),o||cacheElementStl(i),l.extendFrom(e),setDefaultHoverFillStroke(l,e,"fill"),setDefaultHoverFillStroke(l,e,"stroke"),applyDefaultTextStyle(l),o||(t.dirty(!1),t.z2+=Z2_EMPHASIS_LIFT)}}}function setDefaultHoverFillStroke(t,e,r){!hasFillOrStroke(e[r])&&hasFillOrStroke(t[r])&&(t[r]=liftColor(t[r]))}function singleEnterNormal(t){var e=t.__highlighted;if(e&&(t.__highlighted=!1,!t.isGroup))if("layer"===e)t.__zr&&t.__zr.removeHover(t);else{var r=t.style,o=t.__cachedNormalStl;o&&(rollbackDefaultTextStyle(r),t.setStyle(o),applyDefaultTextStyle(r));var i=t.__cachedNormalZ2;null!=i&&t.z2-i===Z2_EMPHASIS_LIFT&&(t.z2=i)}}function traverseUpdate(t,e,r){var o,i=NORMAL,l=NORMAL;t.__highlighted&&(i=EMPHASIS,o=!0),e(t,r),t.__highlighted&&(l=EMPHASIS,o=!0),t.isGroup&&t.traverse(function(t){!t.isGroup&&e(t,r)}),o&&t.__highDownOnUpdate&&t.__highDownOnUpdate(i,l)}export function setElementHoverStyle(t,e){e=t.__hoverStl=!1!==e&&(t.hoverStyle||e||{}),t.__hoverStlDirty=!0,t.__highlighted&&(t.__cachedNormalStl=null,singleEnterNormal(t),singleEnterEmphasis(t))}function onElementMouseOver(t){!shouldSilent(this,t)&&!this.__highByOuter&&traverseUpdate(this,singleEnterEmphasis)}function onElementMouseOut(t){!shouldSilent(this,t)&&!this.__highByOuter&&traverseUpdate(this,singleEnterNormal)}function onElementEmphasisEvent(t){this.__highByOuter|=1<<(t||0),traverseUpdate(this,singleEnterEmphasis)}function onElementNormalEvent(t){!(this.__highByOuter&=~(1<<(t||0)))&&traverseUpdate(this,singleEnterNormal)}function shouldSilent(t,e){return t.__highDownSilentOnTouch&&e.zrByTouch}export function setHoverStyle(t,e){setAsHighDownDispatcher(t,!0),traverseUpdate(t,setElementHoverStyle,e)}export function setAsHighDownDispatcher(t,e){var r=!1===e;if(t.__highDownSilentOnTouch=t.highDownSilentOnTouch,t.__highDownOnUpdate=t.highDownOnUpdate,!r||t.__highDownDispatcher){var o=r?"off":"on";t[o]("mouseover",onElementMouseOver)[o]("mouseout",onElementMouseOut),t[o]("emphasis",onElementEmphasisEvent)[o]("normal",onElementNormalEvent),t.__highByOuter=t.__highByOuter||0,t.__highDownDispatcher=!r}}export function isHighDownDispatcher(t){return!(!t||!t.__highDownDispatcher)}export function getHighlightDigit(t){var e=_highlightKeyMap[t];return null==e&&_highlightNextDigit<=32&&(e=_highlightKeyMap[t]=_highlightNextDigit++),e}export function setLabelStyle(t,e,r,o,i,l,a){var n,h=(i=i||EMPTY_OBJ).labelFetcher,s=i.labelDataIndex,c=i.labelDimIndex,p=r.getShallow("show"),u=o.getShallow("show");(p||u)&&(h&&(n=h.getFormattedLabel(s,"normal",null,c)),null==n&&(n=zrUtil.isFunction(i.defaultText)?i.defaultText(s,i):i.defaultText));var f=p?n:null,g=u?zrUtil.retrieve2(h?h.getFormattedLabel(s,"emphasis",null,c):null,n):null;null==f&&null==g||(setTextStyle(t,r,l,i),setTextStyle(e,o,a,i,!0)),t.text=f,e.text=g}export function modifyLabelStyle(t,e,r){var o=t.style;e&&(rollbackDefaultTextStyle(o),t.setStyle(e),applyDefaultTextStyle(o)),o=t.__hoverStl,r&&o&&(rollbackDefaultTextStyle(o),zrUtil.extend(o,r),applyDefaultTextStyle(o))}export function setTextStyle(t,e,r,o,i){return setTextStyleCommon(t,e,o,i),r&&zrUtil.extend(t,r),t}export function setText(t,e,r){var o,i={isRectText:!0};!1===r?o=!0:i.autoColor=r,setTextStyleCommon(t,e,i,o)}function setTextStyleCommon(t,e,r,o){if((r=r||EMPTY_OBJ).isRectText){var i;r.getTextPosition?i=r.getTextPosition(e,o):"outside"===(i=e.getShallow("position")||(o?null:"inside"))&&(i="top"),t.textPosition=i,t.textOffset=e.getShallow("offset");var l=e.getShallow("rotate");null!=l&&(l*=Math.PI/180),t.textRotation=l,t.textDistance=zrUtil.retrieve2(e.getShallow("distance"),o?null:5)}var a,n=e.ecModel,h=n&&n.option.textStyle,s=getRichItemNames(e);if(s)for(var c in a={},s)if(s.hasOwnProperty(c)){var p=e.getModel(["rich",c]);setTokenTextStyle(a[c]={},p,h,r,o)}return t.rich=a,setTokenTextStyle(t,e,h,r,o,!0),r.forceRich&&!r.textStyle&&(r.textStyle={}),t}function getRichItemNames(t){for(var e;t&&t!==t.ecModel;){var r=(t.option||EMPTY_OBJ).rich;if(r)for(var o in e=e||{},r)r.hasOwnProperty(o)&&(e[o]=1);t=t.parentModel}return e}function setTokenTextStyle(t,e,r,o,i,l){r=!i&&r||EMPTY_OBJ,t.textFill=getAutoColor(e.getShallow("color"),o)||r.color,t.textStroke=getAutoColor(e.getShallow("textBorderColor"),o)||r.textBorderColor,t.textStrokeWidth=zrUtil.retrieve2(e.getShallow("textBorderWidth"),r.textBorderWidth),i||(l&&(t.insideRollbackOpt=o,applyDefaultTextStyle(t)),null==t.textFill&&(t.textFill=o.autoColor)),t.fontStyle=e.getShallow("fontStyle")||r.fontStyle,t.fontWeight=e.getShallow("fontWeight")||r.fontWeight,t.fontSize=e.getShallow("fontSize")||r.fontSize,t.fontFamily=e.getShallow("fontFamily")||r.fontFamily,t.textAlign=e.getShallow("align"),t.textVerticalAlign=e.getShallow("verticalAlign")||e.getShallow("baseline"),t.textLineHeight=e.getShallow("lineHeight"),t.textWidth=e.getShallow("width"),t.textHeight=e.getShallow("height"),t.textTag=e.getShallow("tag"),l&&o.disableBox||(t.textBackgroundColor=getAutoColor(e.getShallow("backgroundColor"),o),t.textPadding=e.getShallow("padding"),t.textBorderColor=getAutoColor(e.getShallow("borderColor"),o),t.textBorderWidth=e.getShallow("borderWidth"),t.textBorderRadius=e.getShallow("borderRadius"),t.textBoxShadowColor=e.getShallow("shadowColor"),t.textBoxShadowBlur=e.getShallow("shadowBlur"),t.textBoxShadowOffsetX=e.getShallow("shadowOffsetX"),t.textBoxShadowOffsetY=e.getShallow("shadowOffsetY")),t.textShadowColor=e.getShallow("textShadowColor")||r.textShadowColor,t.textShadowBlur=e.getShallow("textShadowBlur")||r.textShadowBlur,t.textShadowOffsetX=e.getShallow("textShadowOffsetX")||r.textShadowOffsetX,t.textShadowOffsetY=e.getShallow("textShadowOffsetY")||r.textShadowOffsetY}function getAutoColor(t,e){return"auto"!==t?t:e&&e.autoColor?e.autoColor:null}function applyDefaultTextStyle(t){var e,r=t.textPosition,o=t.insideRollbackOpt;if(o&&null==t.textFill){var i=o.autoColor,l=o.isRectText,a=o.useInsideStyle,n=!1!==a&&(!0===a||l&&r&&"string"==typeof r&&r.indexOf("inside")>=0),h=!n&&null!=i;(n||h)&&(e={textFill:t.textFill,textStroke:t.textStroke,textStrokeWidth:t.textStrokeWidth}),n&&(t.textFill="#fff",null==t.textStroke&&(t.textStroke=i,null==t.textStrokeWidth&&(t.textStrokeWidth=2))),h&&(t.textFill=i)}t.insideRollback=e}function rollbackDefaultTextStyle(t){var e=t.insideRollback;e&&(t.textFill=e.textFill,t.textStroke=e.textStroke,t.textStrokeWidth=e.textStrokeWidth,t.insideRollback=null)}export function getFont(t,e){var r=e||e.getModel("textStyle");return zrUtil.trim([t.fontStyle||r&&r.getShallow("fontStyle")||"",t.fontWeight||r&&r.getShallow("fontWeight")||"",(t.fontSize||r&&r.getShallow("fontSize")||12)+"px",t.fontFamily||r&&r.getShallow("fontFamily")||"sans-serif"].join(" "))}function animateOrSetProps(t,e,r,o,i,l){if("function"==typeof i&&(l=i,i=null),o&&o.isAnimationEnabled()){var a=t?"Update":"",n=o.getShallow("animationDuration"+a),h=o.getShallow("animationEasing"+a),s=o.getShallow("animationDelay"+a);"function"==typeof s&&(s=s(i,o.getAnimationDelayParams?o.getAnimationDelayParams(e,i):null)),"function"==typeof n&&(n=n(i)),n>0?e.animateTo(r,n,s||0,h,l,!!l):(e.stopAnimation(),e.attr(r),l&&l())}else e.stopAnimation(),e.attr(r),l&&l()}export function updateProps(t,e,r,o,i){animateOrSetProps(!0,t,e,r,o,i)}export function initProps(t,e,r,o,i){animateOrSetProps(!1,t,e,r,o,i)}export function getTransform(t,e){for(var r=matrix.identity([]);t&&t!==e;)matrix.mul(r,t.getLocalTransform(),r),t=t.parent;return r}export function applyTransform(t,e,r){return e&&!zrUtil.isArrayLike(e)&&(e=Transformable.getLocalTransform(e)),r&&(e=matrix.invert([],e)),vector.applyTransform([],t,e)}export function transformDirection(t,e,r){var o=0===e[4]||0===e[5]||0===e[0]?1:Math.abs(2*e[4]/e[0]),i=0===e[4]||0===e[5]||0===e[2]?1:Math.abs(2*e[4]/e[2]),l=["left"===t?-o:"right"===t?o:0,"top"===t?-i:"bottom"===t?i:0];return l=applyTransform(l,e,r),Math.abs(l[0])>Math.abs(l[1])?l[0]>0?"right":"left":l[1]>0?"bottom":"top"}export function groupTransition(t,e,r,o){if(t&&e){var i,l=(i={},t.traverse(function(t){!t.isGroup&&t.anid&&(i[t.anid]=t)}),i);e.traverse(function(t){if(!t.isGroup&&t.anid){var e=l[t.anid];if(e){var o=a(t);t.attr(a(e)),updateProps(t,o,r,t.dataIndex)}}})}function a(t){var e={position:vector.clone(t.position),rotation:t.rotation};return t.shape&&(e.shape=zrUtil.extend({},t.shape)),e}}export function clipPointsByRect(t,e){return zrUtil.map(t,function(t){var r=t[0];r=mathMax(r,e.x),r=mathMin(r,e.x+e.width);var o=t[1];return o=mathMax(o,e.y),[r,o=mathMin(o,e.y+e.height)]})}export function clipRectByRect(t,e){var r=mathMax(t.x,e.x),o=mathMin(t.x+t.width,e.x+e.width),i=mathMax(t.y,e.y),l=mathMin(t.y+t.height,e.y+e.height);if(o>=r&&l>=i)return{x:r,y:i,width:o-r,height:l-i}}export function createIcon(t,e,r){var o=(e=zrUtil.extend({rectHover:!0},e)).style={strokeNoScale:!0};if(r=r||{x:-1,y:-1,width:2,height:2},t)return 0===t.indexOf("image://")?(o.image=t.slice(8),zrUtil.defaults(o,r),new ZImage(e)):makePath(t.replace("path://",""),e,r,"center")}export function linePolygonIntersect(t,e,r,o,i){for(var l=0,a=i[i.length-1];l<i.length;l++){var n=i[l];if(lineLineIntersect(t,e,r,o,n[0],n[1],a[0],a[1]))return!0;a=n}}export function lineLineIntersect(t,e,r,o,i,l,a,n){var h=r-t,s=o-e,c=a-i,p=n-l,u=crossProduct2d(c,p,h,s);if(nearZero(u))return!1;var f=t-i,g=e-l,d=crossProduct2d(f,g,h,s)/u;if(d<0||d>1)return!1;var m=crossProduct2d(f,g,c,p)/u;return!(m<0||m>1)}function crossProduct2d(t,e,r,o){return t*o-r*e}function nearZero(t){return t<=1e-6&&t>=-1e-6}registerShape("circle",Circle),registerShape("sector",Sector),registerShape("ring",Ring),registerShape("polygon",Polygon),registerShape("polyline",Polyline),registerShape("rect",Rect),registerShape("line",Line),registerShape("bezierCurve",BezierCurve),registerShape("arc",Arc);export{Group,ZImage as Image,Text,Circle,Sector,Ring,Polygon,Polyline,Rect,Line,BezierCurve,Arc,IncrementalDisplayable,CompoundPath,LinearGradient,RadialGradient,BoundingRect};
//# sourceMappingURL=/sm/be4b6955fffc6eb4ecc3102ec535379e9e1116fad0755f158c3ae04bc4c7c135.map