/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/src/stream/task.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{assert,isArray}from"zrender/src/core/util";import{__DEV__}from"../config";export function createTask(t){return new Task(t)}function Task(t){t=t||{},this._reset=t.reset,this._plan=t.plan,this._count=t.count,this._onDirty=t.onDirty,this._dirty=!0,this.context}var taskProto=Task.prototype;taskProto.perform=function(t){var s,e=this._upstream,r=t&&t.skip;if(this._dirty&&e){var i=this.context;i.data=i.outputData=e.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this),this._plan&&!r&&(s=this._plan(this.context));var n,o=a(this._modBy),u=this._modDataCount||0,_=a(t&&t.modBy),d=t&&t.modDataCount||0;function a(t){return!(t>=1)&&(t=1),t}o===_&&u===d||(s="reset"),(this._dirty||"reset"===s)&&(this._dirty=!1,n=reset(this,r)),this._modBy=_,this._modDataCount=d;var h=t&&t.step;if(e?(__DEV__&&assert(null!=e._outputDueEnd),this._dueEnd=e._outputDueEnd):(__DEV__&&assert(!this._progress||this._count),this._dueEnd=this._count?this._count(this.context):1/0),this._progress){var p=this._dueIndex,c=Math.min(null!=h?this._dueIndex+h:1/0,this._dueEnd);if(!r&&(n||p<c)){var l=this._progress;if(isArray(l))for(var f=0;f<l.length;f++)doProgress(this,l[f],p,c,_,d);else doProgress(this,l,p,c,_,d)}this._dueIndex=c;var m=null!=this._settedOutputEnd?this._settedOutputEnd:c;__DEV__&&assert(m>=this._outputDueEnd),this._outputDueEnd=m}else this._dueIndex=this._outputDueEnd=null!=this._settedOutputEnd?this._settedOutputEnd:this._dueEnd;return this.unfinished()};var iterator=function(){var t,s,e,r,i,n={reset:function(_,d,a,h){s=_,t=d,e=a,r=h,i=Math.ceil(r/e),n.next=e>1&&r>0?u:o}};return n;function o(){return s<t?s++:null}function u(){var n=s%i*e+Math.ceil(s/i),o=s>=t?null:n<r?n:s;return s++,o}}();function doProgress(t,s,e,r,i,n){iterator.reset(e,r,i,n),t._callingProgress=s,t._callingProgress({start:e,end:r,count:r-e,next:iterator.next},t.context)}function reset(t,s){var e,r;t._dueIndex=t._outputDueEnd=t._dueEnd=0,t._settedOutputEnd=null,!s&&t._reset&&((e=t._reset(t.context))&&e.progress&&(r=e.forceFirstProgress,e=e.progress),isArray(e)&&!e.length&&(e=null)),t._progress=e,t._modBy=t._modDataCount=null;var i=t._downstream;return i&&i.dirty(),r}taskProto.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},taskProto.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},taskProto.pipe=function(t){__DEV__&&assert(t&&!t._disposed&&t!==this),(this._downstream!==t||this._dirty)&&(this._downstream=t,t._upstream=this,t.dirty())},taskProto.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},taskProto.getUpstream=function(){return this._upstream},taskProto.getDownstream=function(){return this._downstream},taskProto.setOutputEnd=function(t){this._outputDueEnd=this._settedOutputEnd=t};
//# sourceMappingURL=/sm/9c0c65a107a4902266c1d16eeb5c48a9eb17fa8f9ad010e34a22c11e6d8b6018.map