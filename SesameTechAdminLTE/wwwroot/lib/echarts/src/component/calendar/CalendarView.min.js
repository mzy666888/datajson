/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/src/component/calendar/CalendarView.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as echarts from"../../echarts";import*as zrUtil from"zrender/src/core/util";import*as graphic from"../../util/graphic";import*as formatUtil from"../../util/format";import*as numberUtil from"../../util/number";var MONTH_TEXT={EN:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],CN:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},WEEK_TEXT={EN:["S","M","T","W","T","F","S"],CN:["日","一","二","三","四","五","六"]};export default echarts.extendComponentView({type:"calendar",_tlpoints:null,_blpoints:null,_firstDayOfMonth:null,_firstDayPoints:null,render:function(t,e,r){var i=this.group;i.removeAll();var n=t.coordinateSystem,a=n.getRangeInfo(),o=n.getOrient();this._renderDayRect(t,a,i),this._renderLines(t,a,o,i),this._renderYearText(t,a,o,i),this._renderMonthText(t,o,i),this._renderWeekText(t,a,o,i)},_renderDayRect:function(t,e,r){for(var i=t.coordinateSystem,n=t.getModel("itemStyle").getItemStyle(),a=i.getCellWidth(),o=i.getCellHeight(),s=e.start.time;s<=e.end.time;s=i.getNextNDay(s,1).time){var l=i.dataToRect([s],!1).tl,g=new graphic.Rect({shape:{x:l[0],y:l[1],width:a,height:o},cursor:"default",style:n});r.add(g)}},_renderLines:function(t,e,r,i){var n=this,a=t.coordinateSystem,o=t.getModel("splitLine.lineStyle").getLineStyle(),s=t.get("splitLine.show"),l=o.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var g=e.start,h=0;g.time<=e.end.time;h++){f(g.formatedDate),0===h&&(g=a.getDateInfo(e.start.y+"-"+e.start.m));var d=g.date;d.setMonth(d.getMonth()+1),g=a.getDateInfo(d)}function f(e){n._firstDayOfMonth.push(a.getDateInfo(e)),n._firstDayPoints.push(a.dataToRect([e],!1).tl);var l=n._getLinePointsOfOneWeek(t,e,r);n._tlpoints.push(l[0]),n._blpoints.push(l[l.length-1]),s&&n._drawSplitline(l,o,i)}f(a.getNextNDay(e.end.time,1).formatedDate),s&&this._drawSplitline(n._getEdgesPoints(n._tlpoints,l,r),o,i),s&&this._drawSplitline(n._getEdgesPoints(n._blpoints,l,r),o,i)},_getEdgesPoints:function(t,e,r){var i=[t[0].slice(),t[t.length-1].slice()],n="horizontal"===r?0:1;return i[0][n]=i[0][n]-e/2,i[1][n]=i[1][n]+e/2,i},_drawSplitline:function(t,e,r){var i=new graphic.Polyline({z2:20,shape:{points:t},style:e});r.add(i)},_getLinePointsOfOneWeek:function(t,e,r){var i=t.coordinateSystem;e=i.getDateInfo(e);for(var n=[],a=0;a<7;a++){var o=i.getNextNDay(e.time,a),s=i.dataToRect([o.time],!1);n[2*o.day]=s.tl,n[2*o.day+1]=s["horizontal"===r?"bl":"tr"]}return n},_formatterLabel:function(t,e){return"string"==typeof t&&t?formatUtil.formatTplSimple(t,e):"function"==typeof t?t(e):e.nameMap},_yearTextPositionControl:function(t,e,r,i,n){e=e.slice();var a=["center","bottom"];"bottom"===i?(e[1]+=n,a=["center","top"]):"left"===i?e[0]-=n:"right"===i?(e[0]+=n,a=["center","top"]):e[1]-=n;var o=0;return"left"!==i&&"right"!==i||(o=Math.PI/2),{rotation:o,position:e,style:{textAlign:a[0],textVerticalAlign:a[1]}}},_renderYearText:function(t,e,r,i){var n=t.getModel("yearLabel");if(n.get("show")){var a=n.get("margin"),o=n.get("position");o||(o="horizontal"!==r?"top":"left");var s=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],l=(s[0][0]+s[1][0])/2,g=(s[0][1]+s[1][1])/2,h="horizontal"===r?0:1,d={top:[l,s[h][1]],bottom:[l,s[1-h][1]],left:[s[1-h][0],g],right:[s[h][0],g]},f=e.start.y;+e.end.y>+e.start.y&&(f=f+"-"+e.end.y);var p=n.get("formatter"),m={start:e.start.y,end:e.end.y,nameMap:f},y=this._formatterLabel(p,m),c=new graphic.Text({z2:30});graphic.setTextStyle(c.style,n,{text:y}),c.attr(this._yearTextPositionControl(c,d[o],r,o,a)),i.add(c)}},_monthTextPositionControl:function(t,e,r,i,n){var a="left",o="top",s=t[0],l=t[1];return"horizontal"===r?(l+=n,e&&(a="center"),"start"===i&&(o="bottom")):(s+=n,e&&(o="middle"),"start"===i&&(a="right")),{x:s,y:l,textAlign:a,textVerticalAlign:o}},_renderMonthText:function(t,e,r){var i=t.getModel("monthLabel");if(i.get("show")){var n=i.get("nameMap"),a=i.get("margin"),o=i.get("position"),s=i.get("align"),l=[this._tlpoints,this._blpoints];zrUtil.isString(n)&&(n=MONTH_TEXT[n.toUpperCase()]||[]);var g="start"===o?0:1,h="horizontal"===e?0:1;a="start"===o?-a:a;for(var d="center"===s,f=0;f<l[g].length-1;f++){var p=l[g][f].slice(),m=this._firstDayOfMonth[f];if(d){var y=this._firstDayPoints[f];p[h]=(y[h]+l[0][f+1][h])/2}var c=i.get("formatter"),_=n[+m.m-1],u={yyyy:m.y,yy:(m.y+"").slice(2),MM:m.m,M:+m.m,nameMap:_},x=this._formatterLabel(c,u),v=new graphic.Text({z2:30});zrUtil.extend(graphic.setTextStyle(v.style,i,{text:x}),this._monthTextPositionControl(p,d,e,o,a)),r.add(v)}}},_weekTextPositionControl:function(t,e,r,i,n){var a="center",o="middle",s=t[0],l=t[1],g="start"===r;return"horizontal"===e?(s=s+i+(g?1:-1)*n[0]/2,a=g?"right":"left"):(l=l+i+(g?1:-1)*n[1]/2,o=g?"bottom":"top"),{x:s,y:l,textAlign:a,textVerticalAlign:o}},_renderWeekText:function(t,e,r,i){var n=t.getModel("dayLabel");if(n.get("show")){var a=t.coordinateSystem,o=n.get("position"),s=n.get("nameMap"),l=n.get("margin"),g=a.getFirstDayOfWeek();zrUtil.isString(s)&&(s=WEEK_TEXT[s.toUpperCase()]||[]);var h=a.getNextNDay(e.end.time,7-e.lweek).time,d=[a.getCellWidth(),a.getCellHeight()];l=numberUtil.parsePercent(l,d["horizontal"===r?0:1]),"start"===o&&(h=a.getNextNDay(e.start.time,-(7+e.fweek)).time,l=-l);for(var f=0;f<7;f++){var p,m=a.getNextNDay(h,f),y=a.dataToRect([m.time],!1).center;p=Math.abs((f+g)%7);var c=new graphic.Text({z2:30});zrUtil.extend(graphic.setTextStyle(c.style,n,{text:s[p]}),this._weekTextPositionControl(y,r,o,l,d)),i.add(c)}}}});
//# sourceMappingURL=/sm/6f3fd51e5edda4e705921bba097de17f8a94d383a99b189d06efe68af864913e.map