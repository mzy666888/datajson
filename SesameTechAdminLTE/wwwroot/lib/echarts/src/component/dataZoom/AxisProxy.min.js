/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/src/component/dataZoom/AxisProxy.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as zrUtil from"zrender/src/core/util";import*as numberUtil from"../../util/number";import*as helper from"./helper";import sliderMove from"../helper/sliderMove";var each=zrUtil.each,asc=numberUtil.asc,AxisProxy=function(e,t,i,n){this._dimName=e,this._axisIndex=t,this._valueWindow,this._percentWindow,this._dataExtent,this._minMaxSpan,this.ecModel=n,this._dataZoomModel=i};function calculateDataExtent(e,t,i){var n=[1/0,-1/0];return each(i,function(e){var i=e.getData();i&&each(i.mapDimension(t,!0),function(e){var t=i.getApproximateExtent(e);t[0]<n[0]&&(n[0]=t[0]),t[1]>n[1]&&(n[1]=t[1])})}),n[1]<n[0]&&(n=[NaN,NaN]),fixExtentByAxis(e,n),n}function fixExtentByAxis(e,t){var i=e.getAxisModel(),n=i.getMin(!0),a="category"===i.get("type"),o=a&&i.getCategories().length;null!=n&&"dataMin"!==n&&"function"!=typeof n?t[0]=n:a&&(t[0]=o>0?0:NaN);var r=i.getMax(!0);return null!=r&&"dataMax"!==r&&"function"!=typeof r?t[1]=r:a&&(t[1]=o>0?o-1:NaN),i.get("scale",!0)||(t[0]>0&&(t[0]=0),t[1]<0&&(t[1]=0)),t}function setAxisModel(e,t){var i=e.getAxisModel(),n=e._percentWindow,a=e._valueWindow;if(n){var o=numberUtil.getPixelPrecision(a,[0,500]);o=Math.min(o,20);var r=t||0===n[0]&&100===n[1];i.setRange(r?null:+a[0].toFixed(o),r?null:+a[1].toFixed(o))}}function setMinMaxSpan(e){var t=e._minMaxSpan={},i=e._dataZoomModel,n=e._dataExtent;each(["min","max"],function(a){var o=i.get(a+"Span"),r=i.get(a+"ValueSpan");null!=r&&(r=e.getAxisModel().axis.scale.parse(r)),null!=r?o=numberUtil.linearMap(n[0]+r,n,[0,100],!0):null!=o&&(r=numberUtil.linearMap(o,[0,100],n,!0)-n[0]),t[a+"Span"]=o,t[a+"ValueSpan"]=r})}AxisProxy.prototype={constructor:AxisProxy,hostedBy:function(e){return this._dataZoomModel===e},getDataValueWindow:function(){return this._valueWindow.slice()},getDataPercentWindow:function(){return this._percentWindow.slice()},getTargetSeriesModels:function(){var e=[],t=this.ecModel;return t.eachSeries(function(i){if(helper.isCoordSupported(i.get("coordinateSystem"))){var n=this._dimName,a=t.queryComponents({mainType:n+"Axis",index:i.get(n+"AxisIndex"),id:i.get(n+"AxisId")})[0];this._axisIndex===(a&&a.componentIndex)&&e.push(i)}},this),e},getAxisModel:function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},getOtherAxisModel:function(){var e,t,i,n=this._dimName,a=this.ecModel,o=this.getAxisModel();return"x"===n||"y"===n?(t="gridIndex",e="x"===n?"y":"x"):(t="polarIndex",e="angle"===n?"radius":"angle"),a.eachComponent(e+"Axis",function(e){(e.get(t)||0)===(o.get(t)||0)&&(i=e)}),i},getMinMaxSpan:function(){return zrUtil.clone(this._minMaxSpan)},calculateDataWindow:function(e){var t,i=this._dataExtent,n=this.getAxisModel().axis.scale,a=this._dataZoomModel.getRangePropMode(),o=[0,100],r=[],s=[];each(["start","end"],function(l,d){var u=e[l],c=e[l+"Value"];"percent"===a[d]?(null==u&&(u=o[d]),c=n.parse(numberUtil.linearMap(u,o,i))):(t=!0,c=null==c?i[d]:n.parse(c),u=numberUtil.linearMap(c,i,o)),s[d]=c,r[d]=u}),asc(s),asc(r);var l=this._minMaxSpan;function d(e,t,i,a,o){var r=o?"Span":"ValueSpan";sliderMove(0,e,i,"all",l["min"+r],l["max"+r]);for(var s=0;s<2;s++)t[s]=numberUtil.linearMap(e[s],i,a,!0),o&&(t[s]=n.parse(t[s]))}return t?d(s,r,i,o,!1):d(r,s,o,i,!0),{valueWindow:s,percentWindow:r}},reset:function(e){if(e===this._dataZoomModel){var t=this.getTargetSeriesModels();this._dataExtent=calculateDataExtent(this,this._dimName,t),setMinMaxSpan(this);var i=this.calculateDataWindow(e.settledOption);this._valueWindow=i.valueWindow,this._percentWindow=i.percentWindow,setAxisModel(this)}},restore:function(e){e===this._dataZoomModel&&(this._valueWindow=this._percentWindow=null,setAxisModel(this,!0))},filterData:function(e,t){if(e===this._dataZoomModel){var i=this._dimName,n=this.getTargetSeriesModels(),a=e.get("filterMode"),o=this._valueWindow;"none"!==a&&each(n,function(e){var t=e.getData(),n=t.mapDimension(i,!0);n.length&&("weakFilter"===a?t.filterSelf(function(e){for(var i,a,r,s=0;s<n.length;s++){var l=t.get(n[s],e),d=!isNaN(l),u=l<o[0],c=l>o[1];if(d&&!u&&!c)return!0;d&&(r=!0),u&&(i=!0),c&&(a=!0)}return r&&i&&a}):each(n,function(i){if("empty"===a)e.setData(t=t.map(i,function(e){return function(e){return e>=o[0]&&e<=o[1]}(e)?e:NaN}));else{var n={};n[i]=o,t.selectRange(n)}}),each(n,function(e){t.setApproximateExtent(o,e)}))})}}};export default AxisProxy;
//# sourceMappingURL=/sm/228422bdefd945a879a23aaadbf643d613cd2093172b040c3c738b20cbb92a06.map