/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/src/component/marker/MarkLineView.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as zrUtil from"zrender/src/core/util";import List from"../../data/List";import*as numberUtil from"../../util/number";import*as markerHelper from"./markerHelper";import LineDraw from"../../chart/helper/LineDraw";import MarkerView from"./MarkerView";import{getStackedDimension}from"../../data/helper/dataStackHelper";var markLineTransform=function(e,t,r,i){var a=e.getData(),n=i.type;if(!zrUtil.isArray(i)&&("min"===n||"max"===n||"average"===n||"median"===n||null!=i.xAxis||null!=i.yAxis)){var o,l;if(null!=i.yAxis||null!=i.xAxis)o=t.getAxis(null!=i.yAxis?"y":"x"),l=zrUtil.retrieve(i.yAxis,i.xAxis);else{var m=markerHelper.getAxisInfo(i,a,t,e);o=m.valueAxis;var s=getStackedDimension(a,m.valueDataDim);l=markerHelper.numCalculate(a,s,n)}var u="x"===o.dim?0:1,d=1-u,f=zrUtil.clone(i),c={};f.type=null,f.coord=[],c.coord=[],f.coord[d]=-1/0,c.coord[d]=1/0;var g=r.get("precision");g>=0&&"number"==typeof l&&(l=+l.toFixed(Math.min(g,20))),f.coord[u]=c.coord[u]=l,i=[f,c,{type:n,valueIndex:i.valueIndex,value:l}]}return(i=[markerHelper.dataTransform(e,i[0]),markerHelper.dataTransform(e,i[1]),zrUtil.extend({},i[2])])[2].type=i[2].type||"",zrUtil.merge(i[2],i[0]),zrUtil.merge(i[2],i[1]),i};function isInifinity(e){return!isNaN(e)&&!isFinite(e)}function ifMarkLineHasOnlyDim(e,t,r,i){var a=1-e,n=i.dimensions[e];return isInifinity(t[a])&&isInifinity(r[a])&&t[e]===r[e]&&i.getAxis(n).containData(t[e])}function markLineFilter(e,t){if("cartesian2d"===e.type){var r=t[0].coord,i=t[1].coord;if(r&&i&&(ifMarkLineHasOnlyDim(1,r,i,e)||ifMarkLineHasOnlyDim(0,r,i,e)))return!0}return markerHelper.dataFilter(e,t[0])&&markerHelper.dataFilter(e,t[1])}function updateSingleMarkerEndLayout(e,t,r,i,a){var n,o=i.coordinateSystem,l=e.getItemModel(t),m=numberUtil.parsePercent(l.get("x"),a.getWidth()),s=numberUtil.parsePercent(l.get("y"),a.getHeight());if(isNaN(m)||isNaN(s)){if(i.getMarkerPosition)n=i.getMarkerPosition(e.getValues(e.dimensions,t));else{var u=o.dimensions,d=e.get(u[0],t),f=e.get(u[1],t);n=o.dataToPoint([d,f])}if("cartesian2d"===o.type){var c=o.getAxis("x"),g=o.getAxis("y");u=o.dimensions;isInifinity(e.get(u[0],t))?n[0]=c.toGlobalCoord(c.getExtent()[r?0:1]):isInifinity(e.get(u[1],t))&&(n[1]=g.toGlobalCoord(g.getExtent()[r?0:1]))}isNaN(m)||(n[0]=m),isNaN(s)||(n[1]=s)}else n=[m,s];e.setItemLayout(t,n)}export default MarkerView.extend({type:"markLine",updateTransform:function(e,t,r){t.eachSeries(function(e){var t=e.markLineModel;if(t){var i=t.getData(),a=t.__from,n=t.__to;a.each(function(t){updateSingleMarkerEndLayout(a,t,!0,e,r),updateSingleMarkerEndLayout(n,t,!1,e,r)}),i.each(function(e){i.setItemLayout(e,[a.getItemLayout(e),n.getItemLayout(e)])}),this.markerGroupMap.get(e.id).updateLayout()}},this)},renderSeries:function(e,t,r,i){var a=e.coordinateSystem,n=e.id,o=e.getData(),l=this.markerGroupMap,m=l.get(n)||l.set(n,new LineDraw);this.group.add(m.group);var s=createList(a,e,t),u=s.from,d=s.to,f=s.line;t.__from=u,t.__to=d,t.setData(f);var c=t.get("symbol"),g=t.get("symbolSize");function y(t,r,a){var n=t.getItemModel(r);updateSingleMarkerEndLayout(t,r,a,e,i),t.setItemVisual(r,{symbolSize:n.get("symbolSize")||g[a?0:1],symbol:n.get("symbol",!0)||c[a?0:1],color:n.get("itemStyle.color")||o.getVisual("color")})}zrUtil.isArray(c)||(c=[c,c]),"number"==typeof g&&(g=[g,g]),s.from.each(function(e){y(u,e,!0),y(d,e,!1)}),f.each(function(e){var t=f.getItemModel(e).get("lineStyle.color");f.setItemVisual(e,{color:t||u.getItemVisual(e,"color")}),f.setItemLayout(e,[u.getItemLayout(e),d.getItemLayout(e)]),f.setItemVisual(e,{fromSymbolSize:u.getItemVisual(e,"symbolSize"),fromSymbol:u.getItemVisual(e,"symbol"),toSymbolSize:d.getItemVisual(e,"symbolSize"),toSymbol:d.getItemVisual(e,"symbol")})}),m.updateData(f),s.line.eachItemGraphicEl(function(e,r){e.traverse(function(e){e.dataModel=t})}),m.__keep=!0,m.group.silent=t.get("silent")||e.get("silent")}});function createList(e,t,r){var i;i=e?zrUtil.map(e&&e.dimensions,function(e){var r=t.getData().getDimensionInfo(t.getData().mapDimension(e))||{};return zrUtil.defaults({name:e},r)}):[{name:"value",type:"float"}];var a=new List(i,r),n=new List(i,r),o=new List([],r),l=zrUtil.map(r.get("data"),zrUtil.curry(markLineTransform,t,e,r));e&&(l=zrUtil.filter(l,zrUtil.curry(markLineFilter,e)));var m=e?markerHelper.dimValueGetter:function(e){return e.value};return a.initData(zrUtil.map(l,function(e){return e[0]}),null,m),n.initData(zrUtil.map(l,function(e){return e[1]}),null,m),o.initData(zrUtil.map(l,function(e){return e[2]})),o.hasItemOption=!0,{from:a,to:n,line:o}}
//# sourceMappingURL=/sm/a33d327c8b19003999a1cf401fdee0ca2631a452188c4baecce505755a50c1db.map