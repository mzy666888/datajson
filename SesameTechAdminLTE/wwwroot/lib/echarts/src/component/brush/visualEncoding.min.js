/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/src/component/brush/visualEncoding.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as echarts from"../../echarts";import*as zrUtil from"zrender/src/core/util";import BoundingRect from"zrender/src/core/BoundingRect";import*as visualSolution from"../../visual/visualSolution";import selector from"./selector";import*as throttleUtil from"../../util/throttle";import BrushTargetManager from"../helper/BrushTargetManager";var STATE_LIST=["inBrush","outOfBrush"],DISPATCH_METHOD="__ecBrushSelect",DISPATCH_FLAG="__ecInBrushSelectEvent",PRIORITY_BRUSH=echarts.PRIORITY.VISUAL.BRUSH;function dispatchAction(e,r,t,n,i){if(i){var o=e.getZr();if(!o[DISPATCH_FLAG])o[DISPATCH_METHOD]||(o[DISPATCH_METHOD]=doDispatch),throttleUtil.createOrUpdate(o,DISPATCH_METHOD,t,r)(e,n)}}function doDispatch(e,r){if(!e.isDisposed()){var t=e.getZr();t[DISPATCH_FLAG]=!0,e.dispatchAction({type:"brushSelect",batch:r}),t[DISPATCH_FLAG]=!1}}function checkInRange(e,r,t,n){for(var i=0,o=r.length;i<o;i++){var a=r[i];if(e[a.brushType](n,t,a.selectors,a))return!0}}function getSelectorsByBrushType(e){var r=e.brushSelector;if(zrUtil.isString(r)){var t=[];return zrUtil.each(selector,function(e,n){t[n]=function(t,n,i,o){var a=n.getItemLayout(t);return e[r](a,i,o)}}),t}if(zrUtil.isFunction(r)){var n={};return zrUtil.each(selector,function(e,t){n[t]=r}),n}return r}function brushModelNotControll(e,r){var t=e.option.seriesIndex;return null!=t&&"all"!==t&&(zrUtil.isArray(t)?zrUtil.indexOf(t,r)<0:r!==t)}function bindSelector(e){var r=e.selectors={};return zrUtil.each(selector[e.brushType],function(t,n){r[n]=function(n){return t(n,r,e)}}),e}echarts.registerLayout(PRIORITY_BRUSH,function(e,r,t){e.eachComponent({mainType:"brush"},function(r){t&&"takeGlobalCursor"===t.type&&r.setBrushOption("brush"===t.key?t.brushOption:{brushType:!1}),(r.brushTargetManager=new BrushTargetManager(r.option,e)).setInputRanges(r.areas,e)})}),echarts.registerVisual(PRIORITY_BRUSH,function(e,r,t){var n,i,o=[];e.eachComponent({mainType:"brush"},function(r,t){var a={brushId:r.id,brushIndex:t,brushName:r.name,areas:zrUtil.clone(r.areas),selected:[]};o.push(a);var u=r.option,s=u.brushLink,c=[],l=[],h=[],f=0;t||(n=u.throttleType,i=u.throttleDelay);var p=zrUtil.map(r.areas,function(e){return bindSelector(zrUtil.defaults({boundingRect:boundingRectBuilders[e.brushType](e)},e))}),g=visualSolution.createVisualMappings(r.option,STATE_LIST,function(e){e.mappingMethod="fixed"});function d(e){return"all"===s||c[e]}function T(e){return!!e.length}zrUtil.isArray(s)&&zrUtil.each(s,function(e){c[e]=1}),e.eachSeries(function(t,n){var i=h[n]=[];"parallel"===t.subType?function(e,r){var t=e.coordinateSystem;f|=t.hasAxisBrushed(),d(r)&&t.eachActiveState(e.getData(),function(e,r){"active"===e&&(l[r]=1)})}(t,n):function(t,n,i){var o=getSelectorsByBrushType(t);if(!o||brushModelNotControll(r,n))return;if(zrUtil.each(p,function(n){o[n.brushType]&&r.brushTargetManager.controlSeries(n,t,e)&&i.push(n),f|=T(i)}),d(n)&&T(i)){var a=t.getData();a.each(function(e){checkInRange(o,i,a,e)&&(l[e]=1)})}}(t,n,i)}),e.eachSeries(function(e,r){var t={seriesId:e.id,seriesIndex:r,seriesName:e.name,dataIndex:[]};a.selected.push(t);var n=getSelectorsByBrushType(e),i=h[r],o=e.getData(),u=d(r)?function(e){return l[e]?(t.dataIndex.push(o.getRawIndex(e)),"inBrush"):"outOfBrush"}:function(e){return checkInRange(n,i,o,e)?(t.dataIndex.push(o.getRawIndex(e)),"inBrush"):"outOfBrush"};(d(r)?f:T(i))&&visualSolution.applyVisual(STATE_LIST,g,o,u)})}),dispatchAction(r,n,i,o,t)});var boundingRectBuilders={lineX:zrUtil.noop,lineY:zrUtil.noop,rect:function(e){return getBoundingRectFromMinMax(e.range)},polygon:function(e){for(var r,t=e.range,n=0,i=t.length;n<i;n++){r=r||[[1/0,-1/0],[1/0,-1/0]];var o=t[n];o[0]<r[0][0]&&(r[0][0]=o[0]),o[0]>r[0][1]&&(r[0][1]=o[0]),o[1]<r[1][0]&&(r[1][0]=o[1]),o[1]>r[1][1]&&(r[1][1]=o[1])}return r&&getBoundingRectFromMinMax(r)}};function getBoundingRectFromMinMax(e){return new BoundingRect(e[0][0],e[1][0],e[0][1]-e[0][0],e[1][1]-e[1][0])}
//# sourceMappingURL=/sm/f8a98642e8350d50e4cb4eb7e37b17a251aa58c03435cb793c7125d8266572bf.map