/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/src/coord/axisTickLabelBuilder.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as zrUtil from"zrender/src/core/util";import*as textContain from"zrender/src/contain/text";import{makeInner}from"../util/model";import{makeLabelFormatter,getOptionCategoryInterval,shouldShowAllLabels}from"./axisHelper";var inner=makeInner();export function createAxisLabels(e){return"category"===e.type?makeCategoryLabels(e):makeRealNumberLabels(e)}export function createAxisTicks(e,t){return"category"===e.type?makeCategoryTicks(e,t):{ticks:e.scale.getTicks()}}function makeCategoryLabels(e){var t=e.getLabelModel(),a=makeCategoryLabelsActually(e,t);return!t.get("show")||e.scale.isBlank()?{labels:[],labelCategoryInterval:a.labelCategoryInterval}:a}function makeCategoryLabelsActually(e,t){var a,r=getListCache(e,"labels"),l=getOptionCategoryInterval(t),n=listCacheGet(r,l);return n||listCacheSet(r,l,{labels:zrUtil.isFunction(l)?makeLabelsByCustomizedCategoryInterval(e,l):makeLabelsByNumericCategoryInterval(e,a="auto"===l?makeAutoCategoryInterval(e):l),labelCategoryInterval:a})}function makeCategoryTicks(e,t){var a,r,l=getListCache(e,"ticks"),n=getOptionCategoryInterval(t),o=listCacheGet(l,n);if(o)return o;if(t.get("show")&&!e.scale.isBlank()||(a=[]),zrUtil.isFunction(n))a=makeLabelsByCustomizedCategoryInterval(e,n,!0);else if("auto"===n){var i=makeCategoryLabelsActually(e,e.getLabelModel());r=i.labelCategoryInterval,a=zrUtil.map(i.labels,function(e){return e.tickValue})}else a=makeLabelsByNumericCategoryInterval(e,r=n,!0);return listCacheSet(l,n,{ticks:a,tickCategoryInterval:r})}function makeRealNumberLabels(e){var t=e.scale.getTicks(),a=makeLabelFormatter(e);return{labels:zrUtil.map(t,function(t,r){return{formattedLabel:a(t,r),rawLabel:e.scale.getLabel(t),tickValue:t}})}}function getListCache(e,t){return inner(e)[t]||(inner(e)[t]=[])}function listCacheGet(e,t){for(var a=0;a<e.length;a++)if(e[a].key===t)return e[a].value}function listCacheSet(e,t,a){return e.push({key:t,value:a}),a}function makeAutoCategoryInterval(e){var t=inner(e).autoInterval;return null!=t?t:inner(e).autoInterval=e.calculateCategoryInterval()}export function calculateCategoryInterval(e){var t=fetchAutoCategoryIntervalCalculationParams(e),a=makeLabelFormatter(e),r=(t.axisRotate-t.labelRotate)/180*Math.PI,l=e.scale,n=l.getExtent(),o=l.count();if(n[1]-n[0]<1)return 0;var i=1;o>40&&(i=Math.max(1,Math.floor(o/40)));for(var s=n[0],u=e.dataToCoord(s+1)-e.dataToCoord(s),c=Math.abs(u*Math.cos(r)),g=Math.abs(u*Math.sin(r)),m=0,b=0;s<=n[1];s+=i){var C,v,h=textContain.getBoundingRect(a(s),t.font,"center","top");C=1.3*h.width,v=1.3*h.height,m=Math.max(m,C,7),b=Math.max(b,v,7)}var k=m/c,y=b/g;isNaN(k)&&(k=1/0),isNaN(y)&&(y=1/0);var f=Math.max(0,Math.floor(Math.min(k,y))),L=inner(e.model),x=e.getExtent(),d=L.lastAutoInterval,I=L.lastTickCount;return null!=d&&null!=I&&Math.abs(d-f)<=1&&Math.abs(I-o)<=1&&d>f&&L.axisExtend0===x[0]&&L.axisExtend1===x[1]?f=d:(L.lastTickCount=o,L.lastAutoInterval=f,L.axisExtend0=x[0],L.axisExtend1=x[1]),f}function fetchAutoCategoryIntervalCalculationParams(e){var t=e.getLabelModel();return{axisRotate:e.getRotate?e.getRotate():e.isHorizontal&&!e.isHorizontal()?90:0,labelRotate:t.get("rotate")||0,font:t.getFont()}}function makeLabelsByNumericCategoryInterval(e,t,a){var r=makeLabelFormatter(e),l=e.scale,n=l.getExtent(),o=e.getLabelModel(),i=[],s=Math.max((t||0)+1,1),u=n[0],c=l.count();0!==u&&s>1&&c/s>2&&(u=Math.round(Math.ceil(u/s)*s));var g=shouldShowAllLabels(e),m=o.get("showMinLabel")||g,b=o.get("showMaxLabel")||g;m&&u!==n[0]&&v(n[0]);for(var C=u;C<=n[1];C+=s)v(C);function v(e){i.push(a?e:{formattedLabel:r(e),rawLabel:l.getLabel(e),tickValue:e})}return b&&C-s!==n[1]&&v(n[1]),i}function makeLabelsByCustomizedCategoryInterval(e,t,a){var r=e.scale,l=makeLabelFormatter(e),n=[];return zrUtil.each(r.getTicks(),function(e){var o=r.getLabel(e);t(e,o)&&n.push(a?e:{formattedLabel:l(e),rawLabel:o,tickValue:e})}),n}
//# sourceMappingURL=/sm/d50e2c9489df1a0c0a0238a040247de44b110204aa4ff35fe54aeceaaa693a2b.map