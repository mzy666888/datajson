/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/src/coord/parallel/Parallel.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as zrUtil from"zrender/src/core/util";import*as matrix from"zrender/src/core/matrix";import*as layoutUtil from"../../util/layout";import*as axisHelper from"../../coord/axisHelper";import ParallelAxis from"./ParallelAxis";import*as graphic from"../../util/graphic";import*as numberUtil from"../../util/number";import sliderMove from"../../component/helper/sliderMove";var each=zrUtil.each,mathMin=Math.min,mathMax=Math.max,mathFloor=Math.floor,mathCeil=Math.ceil,round=numberUtil.round,PI=Math.PI;function Parallel(t,a,i){this._axesMap=zrUtil.createHashMap(),this._axesLayout={},this.dimensions=t.dimensions,this._rect,this._model=t,this._init(t,a,i)}function restrict(t,a){return mathMin(mathMax(t,a[0]),a[1])}function layoutAxisWithoutExpand(t,a){var i=a.layoutLength/(a.axisCount-1);return{position:i*t,axisNameAvailableWidth:i,axisLabelShow:!0}}function layoutAxisWithExpand(t,a){var i,e,n=a.layoutLength,o=a.axisExpandWidth,s=a.axisCount,r=a.axisCollapseWidth,l=a.winInnerIndices,x=r,h=!1;return t<l[0]?(i=t*r,e=r):t<=l[1]?(i=a.axisExpandWindow0Pos+t*o-a.axisExpandWindow[0],x=o,h=!0):(i=n-(s-1-t)*r,e=r),{position:i,axisNameAvailableWidth:x,axisLabelShow:h,nameTruncateMaxWidth:e}}Parallel.prototype={type:"parallel",constructor:Parallel,_init:function(t,a,i){var e=t.dimensions,n=t.parallelAxisIndex;each(e,function(t,i){var e=n[i],o=a.getComponent("parallelAxis",e),s=this._axesMap.set(t,new ParallelAxis(t,axisHelper.createScaleByModel(o),[0,0],o.get("type"),e)),r="category"===s.type;s.onBand=r&&o.get("boundaryGap"),s.inverse=o.get("inverse"),o.axis=s,s.model=o,s.coordinateSystem=o.coordinateSystem=this},this)},update:function(t,a){this._updateAxesFromSeries(this._model,t)},containPoint:function(t){var a=this._makeLayoutInfo(),i=a.axisBase,e=a.layoutBase,n=a.pixelDimIndex,o=t[1-n],s=t[n];return o>=i&&o<=i+a.axisLength&&s>=e&&s<=e+a.layoutLength},getModel:function(){return this._model},_updateAxesFromSeries:function(t,a){a.eachSeries(function(i){if(t.contains(i,a)){var e=i.getData();each(this.dimensions,function(t){var a=this._axesMap.get(t);a.scale.unionExtentFromData(e,e.mapDimension(t)),axisHelper.niceScaleExtent(a.scale,a.model)},this)}},this)},resize:function(t,a){this._rect=layoutUtil.getLayoutRect(t.getBoxLayoutParams(),{width:a.getWidth(),height:a.getHeight()}),this._layoutAxes()},getRect:function(){return this._rect},_makeLayoutInfo:function(){var t,a=this._model,i=this._rect,e=["x","y"],n=["width","height"],o=a.get("layout"),s="horizontal"===o?0:1,r=i[n[s]],l=[0,r],x=this.dimensions.length,h=restrict(a.get("axisExpandWidth"),l),u=restrict(a.get("axisExpandCount")||0,[0,x]),d=a.get("axisExpandable")&&x>3&&x>u&&u>1&&h>0&&r>0,c=a.get("axisExpandWindow");c?(t=restrict(c[1]-c[0],l),c[1]=c[0]+t):(t=restrict(h*(u-1),l),(c=[h*(a.get("axisExpandCenter")||mathFloor(x/2))-t/2])[1]=c[0]+t);var m=(r-t)/(x-u);m<3&&(m=0);var p=[mathFloor(round(c[0]/h,1))+1,mathCeil(round(c[1]/h,1))-1],f=m/h*c[0];return{layout:o,pixelDimIndex:s,layoutBase:i[e[s]],layoutLength:r,axisBase:i[e[1-s]],axisLength:i[n[1-s]],axisExpandable:d,axisExpandWidth:h,axisCollapseWidth:m,axisExpandWindow:c,axisCount:x,winInnerIndices:p,axisExpandWindow0Pos:f}},_layoutAxes:function(){var t=this._rect,a=this._axesMap,i=this.dimensions,e=this._makeLayoutInfo(),n=e.layout;a.each(function(t){var a=[0,e.axisLength],i=t.inverse?1:0;t.setExtent(a[i],a[1-i])}),each(i,function(a,i){var o=(e.axisExpandable?layoutAxisWithExpand:layoutAxisWithoutExpand)(i,e),s={horizontal:{x:o.position,y:e.axisLength},vertical:{x:0,y:o.position}},r={horizontal:PI/2,vertical:0},l=[s[n].x+t.x,s[n].y+t.y],x=r[n],h=matrix.create();matrix.rotate(h,h,x),matrix.translate(h,h,l),this._axesLayout[a]={position:l,rotation:x,transform:h,axisNameAvailableWidth:o.axisNameAvailableWidth,axisLabelShow:o.axisLabelShow,nameTruncateMaxWidth:o.nameTruncateMaxWidth,tickDirection:1,labelDirection:1}},this)},getAxis:function(t){return this._axesMap.get(t)},dataToPoint:function(t,a){return this.axisCoordToPoint(this._axesMap.get(a).dataToCoord(t),a)},eachActiveState:function(t,a,i,e){null==i&&(i=0),null==e&&(e=t.count());var n=this._axesMap,o=this.dimensions,s=[],r=[];zrUtil.each(o,function(a){s.push(t.mapDimension(a)),r.push(n.get(a).model)});for(var l=this.hasAxisBrushed(),x=i;x<e;x++){var h;if(l){h="active";for(var u=t.getValues(s,x),d=0,c=o.length;d<c;d++){if("inactive"===r[d].getActiveState(u[d])){h="inactive";break}}}else h="normal";a(h,x)}},hasAxisBrushed:function(){for(var t=this.dimensions,a=this._axesMap,i=!1,e=0,n=t.length;e<n;e++)"normal"!==a.get(t[e]).model.getActiveState()&&(i=!0);return i},axisCoordToPoint:function(t,a){var i=this._axesLayout[a];return graphic.applyTransform([t,0],i.transform)},getAxisLayout:function(t){return zrUtil.clone(this._axesLayout[t])},getSlidedAxisExpandWindow:function(t){var a=this._makeLayoutInfo(),i=a.pixelDimIndex,e=a.axisExpandWindow.slice(),n=e[1]-e[0],o=[0,a.axisExpandWidth*(a.axisCount-1)];if(!this.containPoint(t))return{behavior:"none",axisExpandWindow:e};var s,r=t[i]-a.layoutBase-a.axisExpandWindow0Pos,l="slide",x=a.axisCollapseWidth,h=this._model.get("axisExpandSlideTriggerArea"),u=null!=h[0];if(x)u&&x&&r<n*h[0]?(l="jump",s=r-n*h[2]):u&&x&&r>n*(1-h[0])?(l="jump",s=r-n*(1-h[2])):(s=r-n*h[1])>=0&&(s=r-n*(1-h[1]))<=0&&(s=0),(s*=a.axisExpandWidth/x)?sliderMove(s,e,o,"all"):l="none";else{n=e[1]-e[0];(e=[mathMax(0,o[1]*r/n-n/2)])[1]=mathMin(o[1],e[0]+n),e[0]=e[1]-n}return{axisExpandWindow:e,behavior:l}}};export default Parallel;
//# sourceMappingURL=/sm/d62de06f16bdfdaadc2f5eca83126cbebf1716eb2cbc067247934bff48a04900.map