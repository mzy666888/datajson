/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/extension/bmap/BMapCoordSys.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var Overlay,_echarts=require("echarts"),zrUtil=_echarts.util,graphic=_echarts.graphic,matrix=_echarts.matrix;function BMapCoordSys(t,e){this._bmap=t,this.dimensions=["lng","lat"],this._mapOffset=[0,0],this._api=e,this._projection=new BMap.MercatorProjection}function dataToCoordSize(t,e){return e=e||[0,0],zrUtil.map([0,1],function(o){var r=e[o],a=t[o]/2,i=[],n=[];return i[o]=r-a,n[o]=r+a,i[1-o]=n[1-o]=e[1-o],Math.abs(this.dataToPoint(i)[o]-this.dataToPoint(n)[o])},this)}function createOverlayCtor(){function t(t){this._root=t}return t.prototype=new BMap.Overlay,t.prototype.initialize=function(t){return t.getPanes().labelPane.appendChild(this._root),this._root},t.prototype.draw=function(){},t}BMapCoordSys.prototype.dimensions=["lng","lat"],BMapCoordSys.prototype.setZoom=function(t){this._zoom=t},BMapCoordSys.prototype.setCenter=function(t){this._center=this._projection.lngLatToPoint(new BMap.Point(t[0],t[1]))},BMapCoordSys.prototype.setMapOffset=function(t){this._mapOffset=t},BMapCoordSys.prototype.getBMap=function(){return this._bmap},BMapCoordSys.prototype.dataToPoint=function(t){var e=new BMap.Point(t[0],t[1]),o=this._bmap.pointToOverlayPixel(e),r=this._mapOffset;return[o.x-r[0],o.y-r[1]]},BMapCoordSys.prototype.pointToData=function(t){var e=this._mapOffset;return[(t=this._bmap.overlayPixelToPoint({x:t[0]+e[0],y:t[1]+e[1]})).lng,t.lat]},BMapCoordSys.prototype.getViewRect=function(){var t=this._api;return new graphic.BoundingRect(0,0,t.getWidth(),t.getHeight())},BMapCoordSys.prototype.getRoamTransform=function(){return matrix.create()},BMapCoordSys.prototype.prepareCustoms=function(t){var e=this.getViewRect();return{coordSys:{type:"bmap",x:e.x,y:e.y,width:e.width,height:e.height},api:{coord:zrUtil.bind(this.dataToPoint,this),size:zrUtil.bind(dataToCoordSize,this)}}},BMapCoordSys.dimensions=BMapCoordSys.prototype.dimensions,BMapCoordSys.create=function(t,e){var o,r=e.getDom();t.eachComponent("bmap",function(t){var a=e.getZr().painter,i=a.getViewportRoot();if("undefined"==typeof BMap)throw new Error("BMap api is not loaded");if(Overlay=Overlay||createOverlayCtor(),o)throw new Error("Only one bmap component can exist");if(!t.__bmap){var n=r.querySelector(".ec-extension-bmap");n&&(i.style.left="0px",i.style.top="0px",r.removeChild(n)),(n=document.createElement("div")).style.cssText="width:100%;height:100%",n.classList.add("ec-extension-bmap"),r.appendChild(n);var p=t.__bmap=new BMap.Map(n),s=new Overlay(i);p.addOverlay(s),a.getViewportRootOffset=function(){return{offsetLeft:0,offsetTop:0}}}p=t.__bmap;var d=t.get("center"),c=t.get("zoom");if(d&&c){var y=new BMap.Point(d[0],d[1]);p.centerAndZoom(y,c)}(o=new BMapCoordSys(p,e)).setMapOffset(t.__mapOffset||[0,0]),o.setZoom(c),o.setCenter(d),t.coordinateSystem=o}),t.eachSeries(function(t){"bmap"===t.get("coordinateSystem")&&(t.coordinateSystem=o)})};var _default=BMapCoordSys;module.exports=_default;
//# sourceMappingURL=/sm/b28aedae2dcdfc4ac0008c0097c2847b759a30ae3b836ffe0bef2991566101ae.map