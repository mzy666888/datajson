/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/extension-src/bmap/BMapCoordSys.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{util as zrUtil,graphic,matrix}from"echarts";function BMapCoordSys(t,o){this._bmap=t,this.dimensions=["lng","lat"],this._mapOffset=[0,0],this._api=o,this._projection=new BMap.MercatorProjection}function dataToCoordSize(t,o){return o=o||[0,0],zrUtil.map([0,1],function(e){var r=o[e],a=t[e]/2,i=[],n=[];return i[e]=r-a,n[e]=r+a,i[1-e]=n[1-e]=o[1-e],Math.abs(this.dataToPoint(i)[e]-this.dataToPoint(n)[e])},this)}var Overlay;function createOverlayCtor(){function t(t){this._root=t}return t.prototype=new BMap.Overlay,t.prototype.initialize=function(t){return t.getPanes().labelPane.appendChild(this._root),this._root},t.prototype.draw=function(){},t}BMapCoordSys.prototype.dimensions=["lng","lat"],BMapCoordSys.prototype.setZoom=function(t){this._zoom=t},BMapCoordSys.prototype.setCenter=function(t){this._center=this._projection.lngLatToPoint(new BMap.Point(t[0],t[1]))},BMapCoordSys.prototype.setMapOffset=function(t){this._mapOffset=t},BMapCoordSys.prototype.getBMap=function(){return this._bmap},BMapCoordSys.prototype.dataToPoint=function(t){var o=new BMap.Point(t[0],t[1]),e=this._bmap.pointToOverlayPixel(o),r=this._mapOffset;return[e.x-r[0],e.y-r[1]]},BMapCoordSys.prototype.pointToData=function(t){var o=this._mapOffset;return[(t=this._bmap.overlayPixelToPoint({x:t[0]+o[0],y:t[1]+o[1]})).lng,t.lat]},BMapCoordSys.prototype.getViewRect=function(){var t=this._api;return new graphic.BoundingRect(0,0,t.getWidth(),t.getHeight())},BMapCoordSys.prototype.getRoamTransform=function(){return matrix.create()},BMapCoordSys.prototype.prepareCustoms=function(t){var o=this.getViewRect();return{coordSys:{type:"bmap",x:o.x,y:o.y,width:o.width,height:o.height},api:{coord:zrUtil.bind(this.dataToPoint,this),size:zrUtil.bind(dataToCoordSize,this)}}},BMapCoordSys.dimensions=BMapCoordSys.prototype.dimensions,BMapCoordSys.create=function(t,o){var e,r=o.getDom();t.eachComponent("bmap",function(t){var a=o.getZr().painter,i=a.getViewportRoot();if("undefined"==typeof BMap)throw new Error("BMap api is not loaded");if(Overlay=Overlay||createOverlayCtor(),e)throw new Error("Only one bmap component can exist");if(!t.__bmap){var n=r.querySelector(".ec-extension-bmap");n&&(i.style.left="0px",i.style.top="0px",r.removeChild(n)),(n=document.createElement("div")).style.cssText="width:100%;height:100%",n.classList.add("ec-extension-bmap"),r.appendChild(n);var p=t.__bmap=new BMap.Map(n),s=new Overlay(i);p.addOverlay(s),a.getViewportRootOffset=function(){return{offsetLeft:0,offsetTop:0}}}p=t.__bmap;var d=t.get("center"),y=t.get("zoom");if(d&&y){var c=new BMap.Point(d[0],d[1]);p.centerAndZoom(c,y)}(e=new BMapCoordSys(p,o)).setMapOffset(t.__mapOffset||[0,0]),e.setZoom(y),e.setCenter(d),t.coordinateSystem=e}),t.eachSeries(function(t){"bmap"===t.get("coordinateSystem")&&(t.coordinateSystem=e)})};export default BMapCoordSys;
//# sourceMappingURL=/sm/29759516a65225579a933cfa72e166f15cc7bbc6aac3583a64d87bc362e4783b.map