/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/coord/parallel/Parallel.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var zrUtil=require("zrender/lib/core/util"),matrix=require("zrender/lib/core/matrix"),layoutUtil=require("../../util/layout"),axisHelper=require("../../coord/axisHelper"),ParallelAxis=require("./ParallelAxis"),graphic=require("../../util/graphic"),numberUtil=require("../../util/number"),sliderMove=require("../../component/helper/sliderMove"),each=zrUtil.each,mathMin=Math.min,mathMax=Math.max,mathFloor=Math.floor,mathCeil=Math.ceil,round=numberUtil.round,PI=Math.PI;function Parallel(t,i,a){this._axesMap=zrUtil.createHashMap(),this._axesLayout={},this.dimensions=t.dimensions,this._rect,this._model=t,this._init(t,i,a)}function restrict(t,i){return mathMin(mathMax(t,i[0]),i[1])}function layoutAxisWithoutExpand(t,i){var a=i.layoutLength/(i.axisCount-1);return{position:a*t,axisNameAvailableWidth:a,axisLabelShow:!0}}function layoutAxisWithExpand(t,i){var a,e,n=i.layoutLength,o=i.axisExpandWidth,s=i.axisCount,r=i.axisCollapseWidth,l=i.winInnerIndices,x=r,h=!1;return t<l[0]?(a=t*r,e=r):t<=l[1]?(a=i.axisExpandWindow0Pos+t*o-i.axisExpandWindow[0],x=o,h=!0):(a=n-(s-1-t)*r,e=r),{position:a,axisNameAvailableWidth:x,axisLabelShow:h,nameTruncateMaxWidth:e}}Parallel.prototype={type:"parallel",constructor:Parallel,_init:function(t,i,a){var e=t.dimensions,n=t.parallelAxisIndex;each(e,function(t,a){var e=n[a],o=i.getComponent("parallelAxis",e),s=this._axesMap.set(t,new ParallelAxis(t,axisHelper.createScaleByModel(o),[0,0],o.get("type"),e)),r="category"===s.type;s.onBand=r&&o.get("boundaryGap"),s.inverse=o.get("inverse"),o.axis=s,s.model=o,s.coordinateSystem=o.coordinateSystem=this},this)},update:function(t,i){this._updateAxesFromSeries(this._model,t)},containPoint:function(t){var i=this._makeLayoutInfo(),a=i.axisBase,e=i.layoutBase,n=i.pixelDimIndex,o=t[1-n],s=t[n];return o>=a&&o<=a+i.axisLength&&s>=e&&s<=e+i.layoutLength},getModel:function(){return this._model},_updateAxesFromSeries:function(t,i){i.eachSeries(function(a){if(t.contains(a,i)){var e=a.getData();each(this.dimensions,function(t){var i=this._axesMap.get(t);i.scale.unionExtentFromData(e,e.mapDimension(t)),axisHelper.niceScaleExtent(i.scale,i.model)},this)}},this)},resize:function(t,i){this._rect=layoutUtil.getLayoutRect(t.getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()}),this._layoutAxes()},getRect:function(){return this._rect},_makeLayoutInfo:function(){var t,i=this._model,a=this._rect,e=["x","y"],n=["width","height"],o=i.get("layout"),s="horizontal"===o?0:1,r=a[n[s]],l=[0,r],x=this.dimensions.length,h=restrict(i.get("axisExpandWidth"),l),u=restrict(i.get("axisExpandCount")||0,[0,x]),d=i.get("axisExpandable")&&x>3&&x>u&&u>1&&h>0&&r>0,c=i.get("axisExpandWindow");c?(t=restrict(c[1]-c[0],l),c[1]=c[0]+t):(t=restrict(h*(u-1),l),(c=[h*(i.get("axisExpandCenter")||mathFloor(x/2))-t/2])[1]=c[0]+t);var p=(r-t)/(x-u);p<3&&(p=0);var m=[mathFloor(round(c[0]/h,1))+1,mathCeil(round(c[1]/h,1))-1],g=p/h*c[0];return{layout:o,pixelDimIndex:s,layoutBase:a[e[s]],layoutLength:r,axisBase:a[e[1-s]],axisLength:a[n[1-s]],axisExpandable:d,axisExpandWidth:h,axisCollapseWidth:p,axisExpandWindow:c,axisCount:x,winInnerIndices:m,axisExpandWindow0Pos:g}},_layoutAxes:function(){var t=this._rect,i=this._axesMap,a=this.dimensions,e=this._makeLayoutInfo(),n=e.layout;i.each(function(t){var i=[0,e.axisLength],a=t.inverse?1:0;t.setExtent(i[a],i[1-a])}),each(a,function(i,a){var o=(e.axisExpandable?layoutAxisWithExpand:layoutAxisWithoutExpand)(a,e),s={horizontal:{x:o.position,y:e.axisLength},vertical:{x:0,y:o.position}},r={horizontal:PI/2,vertical:0},l=[s[n].x+t.x,s[n].y+t.y],x=r[n],h=matrix.create();matrix.rotate(h,h,x),matrix.translate(h,h,l),this._axesLayout[i]={position:l,rotation:x,transform:h,axisNameAvailableWidth:o.axisNameAvailableWidth,axisLabelShow:o.axisLabelShow,nameTruncateMaxWidth:o.nameTruncateMaxWidth,tickDirection:1,labelDirection:1}},this)},getAxis:function(t){return this._axesMap.get(t)},dataToPoint:function(t,i){return this.axisCoordToPoint(this._axesMap.get(i).dataToCoord(t),i)},eachActiveState:function(t,i,a,e){null==a&&(a=0),null==e&&(e=t.count());var n=this._axesMap,o=this.dimensions,s=[],r=[];zrUtil.each(o,function(i){s.push(t.mapDimension(i)),r.push(n.get(i).model)});for(var l=this.hasAxisBrushed(),x=a;x<e;x++){var h;if(l){h="active";for(var u=t.getValues(s,x),d=0,c=o.length;d<c;d++){if("inactive"===r[d].getActiveState(u[d])){h="inactive";break}}}else h="normal";i(h,x)}},hasAxisBrushed:function(){for(var t=this.dimensions,i=this._axesMap,a=!1,e=0,n=t.length;e<n;e++)"normal"!==i.get(t[e]).model.getActiveState()&&(a=!0);return a},axisCoordToPoint:function(t,i){var a=this._axesLayout[i];return graphic.applyTransform([t,0],a.transform)},getAxisLayout:function(t){return zrUtil.clone(this._axesLayout[t])},getSlidedAxisExpandWindow:function(t){var i=this._makeLayoutInfo(),a=i.pixelDimIndex,e=i.axisExpandWindow.slice(),n=e[1]-e[0],o=[0,i.axisExpandWidth*(i.axisCount-1)];if(!this.containPoint(t))return{behavior:"none",axisExpandWindow:e};var s,r=t[a]-i.layoutBase-i.axisExpandWindow0Pos,l="slide",x=i.axisCollapseWidth,h=this._model.get("axisExpandSlideTriggerArea"),u=null!=h[0];if(x)u&&x&&r<n*h[0]?(l="jump",s=r-n*h[2]):u&&x&&r>n*(1-h[0])?(l="jump",s=r-n*(1-h[2])):(s=r-n*h[1])>=0&&(s=r-n*(1-h[1]))<=0&&(s=0),(s*=i.axisExpandWidth/x)?sliderMove(s,e,o,"all"):l="none";else{n=e[1]-e[0];(e=[mathMax(0,o[1]*r/n-n/2)])[1]=mathMin(o[1],e[0]+n),e[0]=e[1]-n}return{axisExpandWindow:e,behavior:l}}};var _default=Parallel;module.exports=_default;
//# sourceMappingURL=/sm/f765ff8e8a291435df15cb48345305af6e9d1e5bcf0e904eb4934ee7a5dc2e94.map