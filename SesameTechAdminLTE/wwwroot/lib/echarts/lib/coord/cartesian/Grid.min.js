/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/coord/cartesian/Grid.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var _config=require("../../config"),__DEV__=_config.__DEV__,_util=require("zrender/lib/core/util"),isObject=_util.isObject,each=_util.each,map=_util.map,indexOf=_util.indexOf,retrieve=_util.retrieve,_layout=require("../../util/layout"),getLayoutRect=_layout.getLayoutRect,_axisHelper=require("../../coord/axisHelper"),createScaleByModel=_axisHelper.createScaleByModel,ifAxisCrossZero=_axisHelper.ifAxisCrossZero,niceScaleExtent=_axisHelper.niceScaleExtent,estimateLabelUnionRect=_axisHelper.estimateLabelUnionRect,Cartesian2D=require("./Cartesian2D"),Axis2D=require("./Axis2D"),CoordinateSystem=require("../../CoordinateSystem"),_dataStackHelper=require("../../data/helper/dataStackHelper"),getStackedDimension=_dataStackHelper.getStackedDimension;function isAxisUsedInTheGrid(e,t,i){return e.getCoordSysModel()===t}function Grid(e,t,i){this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this._initCartesian(e,t,i),this.model=e}require("./GridModel");var gridProto=Grid.prototype;function fixAxisOnZero(e,t,i,n){i.getAxesOnZeroOf=function(){return o?[o]:[]};var o,r=e[t],s=i.model,a=s.get("axisLine.onZero"),d=s.get("axisLine.onZeroAxisIndex");if(a){if(null!=d)canOnZeroToAxis(r[d])&&(o=r[d]);else for(var c in r)if(r.hasOwnProperty(c)&&canOnZeroToAxis(r[c])&&!n[x(r[c])]){o=r[c];break}o&&(n[x(o)]=!0)}function x(e){return e.dim+"_"+e.index}}function canOnZeroToAxis(e){return e&&"category"!==e.type&&"time"!==e.type&&ifAxisCrossZero(e)}function updateAxisTransform(e,t){var i=e.getExtent(),n=i[0]+i[1];e.toGlobalCoord="x"===e.dim?function(e){return e+t}:function(e){return n-e+t},e.toLocalCoord="x"===e.dim?function(e){return e-t}:function(e){return n-e+t}}gridProto.type="grid",gridProto.axisPointerEnabled=!0,gridProto.getRect=function(){return this._rect},gridProto.update=function(e,t){var i=this._axesMap;this._updateScale(e,this.model),each(i.x,function(e){niceScaleExtent(e.scale,e.model)}),each(i.y,function(e){niceScaleExtent(e.scale,e.model)});var n={};each(i.x,function(e){fixAxisOnZero(i,"y",e,n)}),each(i.y,function(e){fixAxisOnZero(i,"x",e,n)}),this.resize(this.model,t)},gridProto.resize=function(e,t,i){var n=getLayoutRect(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()});this._rect=n;var o=this._axesList;function r(){each(o,function(e){var t=e.isHorizontal(),i=t?[0,n.width]:[0,n.height],o=e.inverse?1:0;e.setExtent(i[o],i[1-o]),updateAxisTransform(e,t?n.x:n.y)})}r(),!i&&e.get("containLabel")&&(each(o,function(e){if(!e.model.get("axisLabel.inside")){var t=estimateLabelUnionRect(e);if(t){var i=e.isHorizontal()?"height":"width",o=e.model.get("axisLabel.margin");n[i]-=t[i]+o,"top"===e.position?n.y+=t.height+o:"left"===e.position&&(n.x+=t.width+o)}}}),r())},gridProto.getAxis=function(e,t){var i=this._axesMap[e];if(null!=i){if(null==t)for(var n in i)if(i.hasOwnProperty(n))return i[n];return i[t]}},gridProto.getAxes=function(){return this._axesList.slice()},gridProto.getCartesian=function(e,t){if(null!=e&&null!=t){var i="x"+e+"y"+t;return this._coordsMap[i]}isObject(e)&&(t=e.yAxisIndex,e=e.xAxisIndex);for(var n=0,o=this._coordsList;n<o.length;n++)if(o[n].getAxis("x").index===e||o[n].getAxis("y").index===t)return o[n]},gridProto.getCartesians=function(){return this._coordsList.slice()},gridProto.convertToPixel=function(e,t,i){var n=this._findConvertTarget(e,t);return n.cartesian?n.cartesian.dataToPoint(i):n.axis?n.axis.toGlobalCoord(n.axis.dataToCoord(i)):null},gridProto.convertFromPixel=function(e,t,i){var n=this._findConvertTarget(e,t);return n.cartesian?n.cartesian.pointToData(i):n.axis?n.axis.coordToData(n.axis.toLocalCoord(i)):null},gridProto._findConvertTarget=function(e,t){var i,n,o=t.seriesModel,r=t.xAxisModel||o&&o.getReferringComponents("xAxis")[0],s=t.yAxisModel||o&&o.getReferringComponents("yAxis")[0],a=t.gridModel,d=this._coordsList;if(o)i=o.coordinateSystem,indexOf(d,i)<0&&(i=null);else if(r&&s)i=this.getCartesian(r.componentIndex,s.componentIndex);else if(r)n=this.getAxis("x",r.componentIndex);else if(s)n=this.getAxis("y",s.componentIndex);else if(a){a.coordinateSystem===this&&(i=this._coordsList[0])}return{cartesian:i,axis:n}},gridProto.containPoint=function(e){var t=this._coordsList[0];if(t)return t.containPoint(e)},gridProto._initCartesian=function(e,t,i){var n={left:!1,right:!1,top:!1,bottom:!1},o={x:{},y:{}},r={x:0,y:0};if(t.eachComponent("xAxis",s("x"),this),t.eachComponent("yAxis",s("y"),this),!r.x||!r.y)return this._axesMap={},void(this._axesList=[]);function s(i){return function(s,a){if(isAxisUsedInTheGrid(s,e,t)){var d=s.get("position");"x"===i?"top"!==d&&"bottom"!==d&&(d=n.bottom?"top":"bottom"):"left"!==d&&"right"!==d&&(d=n.left?"right":"left"),n[d]=!0;var c=new Axis2D(i,createScaleByModel(s),[0,0],s.get("type"),d),x="category"===c.type;c.onBand=x&&s.get("boundaryGap"),c.inverse=s.get("inverse"),s.axis=c,c.model=s,c.grid=this,c.index=a,this._axesList.push(c),o[i][a]=c,r[i]++}}}this._axesMap=o,each(o.x,function(t,i){each(o.y,function(n,o){var r="x"+i+"y"+o,s=new Cartesian2D(r);s.grid=this,s.model=e,this._coordsMap[r]=s,this._coordsList.push(s),s.addAxis(t),s.addAxis(n)},this)},this)},gridProto._updateScale=function(e,t){function i(e,t,i){each(e.mapDimension(t.dim,!0),function(i){t.scale.unionExtentFromData(e,getStackedDimension(e,i))})}each(this._axesList,function(e){e.scale.setExtent(1/0,-1/0)}),e.eachSeries(function(n){if(isCartesian2D(n)){var o=findAxesModels(n,e),r=o[0],s=o[1];if(!isAxisUsedInTheGrid(r,t,e)||!isAxisUsedInTheGrid(s,t,e))return;var a=this.getCartesian(r.componentIndex,s.componentIndex),d=n.getData(),c=a.getAxis("x"),x=a.getAxis("y");"list"===d.type&&(i(d,c,n),i(d,x,n))}},this)},gridProto.getTooltipAxes=function(e){var t=[],i=[];return each(this.getCartesians(),function(n){var o=null!=e&&"auto"!==e?n.getAxis(e):n.getBaseAxis(),r=n.getOtherAxis(o);indexOf(t,o)<0&&t.push(o),indexOf(i,r)<0&&i.push(r)}),{baseAxes:t,otherAxes:i}};var axesTypes=["xAxis","yAxis"];function findAxesModels(e,t){return map(axesTypes,function(t){return e.getReferringComponents(t)[0]})}function isCartesian2D(e){return"cartesian2d"===e.get("coordinateSystem")}Grid.create=function(e,t){var i=[];return e.eachComponent("grid",function(n,o){var r=new Grid(n,e,t);r.name="grid_"+o,r.resize(n,t,!0),n.coordinateSystem=r,i.push(r)}),e.eachSeries(function(t){if(isCartesian2D(t)){var i=findAxesModels(t,e),n=i[0],o=i[1],r=n.getCoordSysModel().coordinateSystem;t.coordinateSystem=r.getCartesian(n.componentIndex,o.componentIndex)}}),i},Grid.dimensions=Grid.prototype.dimensions=Cartesian2D.prototype.dimensions,CoordinateSystem.register("cartesian2d",Grid);var _default=Grid;module.exports=_default;
//# sourceMappingURL=/sm/c6c0edde38f1dcd795d52d601f85a045a73df970cb737f45801812c16c92caec.map