/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/chart/gauge/GaugeView.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var PointerPath=require("./PointerPath"),graphic=require("../../util/graphic"),ChartView=require("../../view/Chart"),_number=require("../../util/number"),parsePercent=_number.parsePercent,round=_number.round,linearMap=_number.linearMap;function parsePosition(e,t){var r=e.get("center"),i=t.getWidth(),a=t.getHeight(),n=Math.min(i,a);return{cx:parsePercent(r[0],t.getWidth()),cy:parsePercent(r[1],t.getHeight()),r:parsePercent(e.get("radius"),n/2)}}function formatLabel(e,t){return t&&("string"==typeof t?e=t.replace("{value}",null!=e?e:""):"function"==typeof t&&(e=t(e))),e}var PI2=2*Math.PI,GaugeView=ChartView.extend({type:"gauge",render:function(e,t,r){this.group.removeAll();var i=e.get("axisLine.lineStyle.color"),a=parsePosition(e,r);this._renderMain(e,t,r,i,a)},dispose:function(){},_renderMain:function(e,t,r,i,a){for(var n=this.group,l=e.getModel("axisLine"),g=l.getModel("lineStyle"),o=e.get("clockwise"),s=-e.get("startAngle")/180*Math.PI,c=((m=-e.get("endAngle")/180*Math.PI)-s)%PI2,h=s,p=g.get("width"),d=l.get("show"),u=0;d&&u<i.length;u++){var m=s+c*Math.min(Math.max(i[u][0],0),1),f=new graphic.Sector({shape:{startAngle:h,endAngle:m,cx:a.cx,cy:a.cy,clockwise:o,r0:a.r-p,r:a.r},silent:!0});f.setStyle({fill:i[u][1]}),f.setStyle(g.getLineStyle(["color","borderWidth","borderColor"])),n.add(f),h=m}var y=function(e){if(e<=0)return i[0][1];for(var t=0;t<i.length;t++)if(i[t][0]>=e&&(0===t?0:i[t-1][0])<e)return i[t][1];return i[t-1][1]};if(!o){var x=s;s=m,m=x}this._renderTicks(e,t,r,y,a,s,m,o),this._renderPointer(e,t,r,y,a,s,m,o),this._renderTitle(e,t,r,y,a),this._renderDetail(e,t,r,y,a)},_renderTicks:function(e,t,r,i,a,n,l,g){for(var o=this.group,s=a.cx,c=a.cy,h=a.r,p=+e.get("min"),d=+e.get("max"),u=e.getModel("splitLine"),m=e.getModel("axisTick"),f=e.getModel("axisLabel"),y=e.get("splitNumber"),x=m.get("splitNumber"),v=parsePercent(u.get("length"),h),M=parsePercent(m.get("length"),h),P=n,w=(l-n)/y,S=w/x,_=u.getModel("lineStyle").getLineStyle(),b=m.getModel("lineStyle").getLineStyle(),I=0;I<=y;I++){var L=Math.cos(P),A=Math.sin(P);if(u.get("show")){var T=new graphic.Line({shape:{x1:L*h+s,y1:A*h+c,x2:L*(h-v)+s,y2:A*(h-v)+c},style:_,silent:!0});"auto"===_.stroke&&T.setStyle({stroke:i(I/y)}),o.add(T)}if(f.get("show")){var k=formatLabel(round(I/y*(d-p)+p),f.get("formatter")),C=f.get("distance"),D=i(I/y);o.add(new graphic.Text({style:graphic.setTextStyle({},f,{text:k,x:L*(h-v-C)+s,y:A*(h-v-C)+c,textVerticalAlign:A<-.4?"top":A>.4?"bottom":"middle",textAlign:L<-.4?"left":L>.4?"right":"center"},{autoColor:D}),silent:!0}))}if(m.get("show")&&I!==y){for(var G=0;G<=x;G++){L=Math.cos(P),A=Math.sin(P);var N=new graphic.Line({shape:{x1:L*h+s,y1:A*h+c,x2:L*(h-M)+s,y2:A*(h-M)+c},silent:!0,style:b});"auto"===b.stroke&&N.setStyle({stroke:i((I+G/x)/y)}),o.add(N),P+=S}P-=S}else P+=w}},_renderPointer:function(e,t,r,i,a,n,l,g){var o=this.group,s=this._data;if(e.get("pointer.show")){var c=[+e.get("min"),+e.get("max")],h=[n,l],p=e.getData(),d=p.mapDimension("value");p.diff(s).add(function(t){var r=new PointerPath({shape:{angle:n}});graphic.initProps(r,{shape:{angle:linearMap(p.get(d,t),c,h,!0)}},e),o.add(r),p.setItemGraphicEl(t,r)}).update(function(t,r){var i=s.getItemGraphicEl(r);graphic.updateProps(i,{shape:{angle:linearMap(p.get(d,t),c,h,!0)}},e),o.add(i),p.setItemGraphicEl(t,i)}).remove(function(e){var t=s.getItemGraphicEl(e);o.remove(t)}).execute(),p.eachItemGraphicEl(function(e,t){var r=p.getItemModel(t),n=r.getModel("pointer");e.setShape({x:a.cx,y:a.cy,width:parsePercent(n.get("width"),a.r),r:parsePercent(n.get("length"),a.r)}),e.useStyle(r.getModel("itemStyle").getItemStyle()),"auto"===e.style.fill&&e.setStyle("fill",i(linearMap(p.get(d,t),c,[0,1],!0))),graphic.setHoverStyle(e,r.getModel("emphasis.itemStyle").getItemStyle())}),this._data=p}else s&&s.eachItemGraphicEl(function(e){o.remove(e)})},_renderTitle:function(e,t,r,i,a){var n=e.getData(),l=n.mapDimension("value"),g=e.getModel("title");if(g.get("show")){var o=g.get("offsetCenter"),s=a.cx+parsePercent(o[0],a.r),c=a.cy+parsePercent(o[1],a.r),h=+e.get("min"),p=+e.get("max"),d=e.getData().get(l,0),u=i(linearMap(d,[h,p],[0,1],!0));this.group.add(new graphic.Text({silent:!0,style:graphic.setTextStyle({},g,{x:s,y:c,text:n.getName(0),textAlign:"center",textVerticalAlign:"middle"},{autoColor:u,forceRich:!0})}))}},_renderDetail:function(e,t,r,i,a){var n=e.getModel("detail"),l=+e.get("min"),g=+e.get("max");if(n.get("show")){var o=n.get("offsetCenter"),s=a.cx+parsePercent(o[0],a.r),c=a.cy+parsePercent(o[1],a.r),h=parsePercent(n.get("width"),a.r),p=parsePercent(n.get("height"),a.r),d=e.getData(),u=d.get(d.mapDimension("value"),0),m=i(linearMap(u,[l,g],[0,1],!0));this.group.add(new graphic.Text({silent:!0,style:graphic.setTextStyle({},n,{x:s,y:c,text:formatLabel(u,n.get("formatter")),textWidth:isNaN(h)?null:h,textHeight:isNaN(p)?null:p,textAlign:"center",textVerticalAlign:"middle"},{autoColor:m,forceRich:!0})}))}}}),_default=GaugeView;module.exports=_default;
//# sourceMappingURL=/sm/79d5cca8ce78775b8f86f1b0838254d8e74d4472395d8ea6aefd4552dde1b8f5.map