/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/chart/pie/PieView.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var zrUtil=require("zrender/lib/core/util"),graphic=require("../../util/graphic"),ChartView=require("../../view/Chart");function updateDataSelected(e,t,i,a){var o=t.getData(),r=this.dataIndex,n=o.getName(r),l=t.get("selectedOffset");a.dispatchAction({type:"pieToggleSelect",from:e,name:n,seriesId:t.id}),o.each(function(e){toggleItemSelected(o.getItemGraphicEl(e),o.getItemLayout(e),t.isSelected(o.getName(e)),l,i)})}function toggleItemSelected(e,t,i,a,o){var r=(t.startAngle+t.endAngle)/2,n=i?a:0,l=[Math.cos(r)*n,Math.sin(r)*n];o?e.animate().when(200,{position:l}).start("bounceOut"):e.attr("position",l)}function PiePiece(e,t){graphic.Group.call(this);var i=new graphic.Sector({z2:2}),a=new graphic.Polyline,o=new graphic.Text;this.add(i),this.add(a),this.add(o),this.updateData(e,t,!0)}var piePieceProto=PiePiece.prototype;piePieceProto.updateData=function(e,t,i){var a=this.childAt(0),o=this.childAt(1),r=this.childAt(2),n=e.hostModel,l=e.getItemModel(t),s=e.getItemLayout(t),g=zrUtil.extend({},s);g.label=null;var h=n.getShallow("animationTypeUpdate");i?(a.setShape(g),"scale"===n.getShallow("animationType")?(a.shape.r=s.r0,graphic.initProps(a,{shape:{r:s.r}},n,t)):(a.shape.endAngle=s.startAngle,graphic.updateProps(a,{shape:{endAngle:s.endAngle}},n,t))):"expansion"===h?a.setShape(g):graphic.updateProps(a,{shape:g},n,t);var c=e.getItemVisual(t,"color");a.useStyle(zrUtil.defaults({lineJoin:"bevel",fill:c},l.getModel("itemStyle").getItemStyle())),a.hoverStyle=l.getModel("emphasis.itemStyle").getItemStyle();var p=l.getShallow("cursor");p&&a.attr("cursor",p),toggleItemSelected(this,e.getItemLayout(t),n.isSelected(null,t),n.get("selectedOffset"),n.get("animation"));var d=!i&&"transition"===h;this._updateLabel(e,t,d),this.highDownOnUpdate=l.get("hoverAnimation")&&n.isAnimationEnabled()?function(e,t){"emphasis"===t?(o.ignore=o.hoverIgnore,r.ignore=r.hoverIgnore,a.stopAnimation(!0),a.animateTo({shape:{r:s.r+n.get("hoverOffset")}},300,"elasticOut")):(o.ignore=o.normalIgnore,r.ignore=r.normalIgnore,a.stopAnimation(!0),a.animateTo({shape:{r:s.r}},300,"elasticOut"))}:null,graphic.setHoverStyle(this)},piePieceProto._updateLabel=function(e,t,i){var a=this.childAt(1),o=this.childAt(2),r=e.hostModel,n=e.getItemModel(t),l=e.getItemLayout(t).label,s=e.getItemVisual(t,"color");if(!l||isNaN(l.x)||isNaN(l.y))o.ignore=o.normalIgnore=o.hoverIgnore=a.ignore=a.normalIgnore=a.hoverIgnore=!0;else{var g={points:l.linePoints||[[l.x,l.y],[l.x,l.y],[l.x,l.y]]},h={x:l.x,y:l.y};i?(graphic.updateProps(a,{shape:g},r,t),graphic.updateProps(o,{style:h},r,t)):(a.attr({shape:g}),o.attr({style:h})),o.attr({rotation:l.rotation,origin:[l.x,l.y],z2:10});var c=n.getModel("label"),p=n.getModel("emphasis.label"),d=n.getModel("labelLine"),u=n.getModel("emphasis.labelLine");s=e.getItemVisual(t,"color");graphic.setLabelStyle(o.style,o.hoverStyle={},c,p,{labelFetcher:e.hostModel,labelDataIndex:t,defaultText:e.getName(t),autoColor:s,useInsideStyle:!!l.inside},{textAlign:l.textAlign,textVerticalAlign:l.verticalAlign,opacity:e.getItemVisual(t,"opacity")}),o.ignore=o.normalIgnore=!c.get("show"),o.hoverIgnore=!p.get("show"),a.ignore=a.normalIgnore=!d.get("show"),a.hoverIgnore=!u.get("show"),a.setStyle({stroke:s,opacity:e.getItemVisual(t,"opacity")}),a.setStyle(d.getModel("lineStyle").getLineStyle()),a.hoverStyle=u.getModel("lineStyle").getLineStyle();var m=d.get("smooth");m&&!0===m&&(m=.4),a.setShape({smooth:m})}},zrUtil.inherits(PiePiece,graphic.Group);var PieView=ChartView.extend({type:"pie",init:function(){var e=new graphic.Group;this._sectorGroup=e},render:function(e,t,i,a){if(!a||a.from!==this.uid){var o=e.getData(),r=this._data,n=this.group,l=t.get("animation"),s=!r,g=e.get("animationType"),h=e.get("animationTypeUpdate"),c=zrUtil.curry(updateDataSelected,this.uid,e,l,i),p=e.get("selectedMode");if(o.diff(r).add(function(e){var t=new PiePiece(o,e);s&&"scale"!==g&&t.eachChild(function(e){e.stopAnimation(!0)}),p&&t.on("click",c),o.setItemGraphicEl(e,t),n.add(t)}).update(function(e,t){var i=r.getItemGraphicEl(t);s||"transition"===h||i.eachChild(function(e){e.stopAnimation(!0)}),i.updateData(o,e),i.off("click"),p&&i.on("click",c),n.add(i),o.setItemGraphicEl(e,i)}).remove(function(e){var t=r.getItemGraphicEl(e);n.remove(t)}).execute(),l&&o.count()>0&&(s?"scale"!==g:"transition"!==h)){for(var d=o.getItemLayout(0),u=1;isNaN(d.startAngle)&&u<o.count();++u)d=o.getItemLayout(u);var m=Math.max(i.getWidth(),i.getHeight())/2,y=zrUtil.bind(n.removeClipPath,n);n.setClipPath(this._createClipPath(d.cx,d.cy,m,d.startAngle,d.clockwise,y,e,s))}else n.removeClipPath();this._data=o}},dispose:function(){},_createClipPath:function(e,t,i,a,o,r,n,l){var s=new graphic.Sector({shape:{cx:e,cy:t,r0:0,r:i,startAngle:a,endAngle:a,clockwise:o}});return(l?graphic.initProps:graphic.updateProps)(s,{shape:{endAngle:a+(o?1:-1)*Math.PI*2}},n,r),s},containPoint:function(e,t){var i=t.getData().getItemLayout(0);if(i){var a=e[0]-i.cx,o=e[1]-i.cy,r=Math.sqrt(a*a+o*o);return r<=i.r&&r>=i.r0}}}),_default=PieView;module.exports=_default;
//# sourceMappingURL=/sm/ae0fa65149a873f7fba623f761e60d7f1f230152f861328d8b4f3e757b01f6e6.map