/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/chart/custom.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var _config=require("../config"),__DEV__=_config.__DEV__,zrUtil=require("zrender/lib/core/util"),graphicUtil=require("../util/graphic"),_labelHelper=require("./helper/labelHelper"),getDefaultLabel=_labelHelper.getDefaultLabel,createListFromArray=require("./helper/createListFromArray"),_barGrid=require("../layout/barGrid"),getLayoutOnAxis=_barGrid.getLayoutOnAxis,DataDiffer=require("../data/DataDiffer"),SeriesModel=require("../model/Series"),Model=require("../model/Model"),ChartView=require("../view/Chart"),_createClipPathFromCoordSys=require("./helper/createClipPathFromCoordSys"),createClipPath=_createClipPathFromCoordSys.createClipPath,prepareCartesian2d=require("../coord/cartesian/prepareCustom"),prepareGeo=require("../coord/geo/prepareCustom"),prepareSingleAxis=require("../coord/single/prepareCustom"),preparePolar=require("../coord/polar/prepareCustom"),prepareCalendar=require("../coord/calendar/prepareCustom"),CACHED_LABEL_STYLE_PROPERTIES=graphicUtil.CACHED_LABEL_STYLE_PROPERTIES,ITEM_STYLE_NORMAL_PATH=["itemStyle"],ITEM_STYLE_EMPHASIS_PATH=["emphasis","itemStyle"],LABEL_NORMAL=["label"],LABEL_EMPHASIS=["emphasis","label"],GROUP_DIFF_PREFIX="e\0\0",prepareCustoms={cartesian2d:prepareCartesian2d,geo:prepareGeo,singleAxis:prepareSingleAxis,polar:preparePolar,calendar:prepareCalendar};function createEl(e){var t,r=e.type;if("path"===r){var a=e.shape,i=null!=a.width&&null!=a.height?{x:a.x||0,y:a.y||0,width:a.width,height:a.height}:null,n=getPathData(a);(t=graphicUtil.makePath(n,null,i,a.layout||"center")).__customPathData=n}else if("image"===r)(t=new graphicUtil.Image({})).__customImagePath=e.style.image;else if("text"===r)(t=new graphicUtil.Text({})).__customText=e.style.text;else if("group"===r)t=new graphicUtil.Group;else{if("compoundPath"===r)throw new Error('"compoundPath" is not supported yet.');t=new(graphicUtil.getShapeClass(r))}return t.__customGraphicType=r,t.name=e.name,t}function updateEl(e,t,r,a,i,n,l){var o={},s=r.style||{};if(r.shape&&(o.shape=zrUtil.clone(r.shape)),r.position&&(o.position=r.position.slice()),r.scale&&(o.scale=r.scale.slice()),r.origin&&(o.origin=r.origin.slice()),r.rotation&&(o.rotation=r.rotation),"image"===e.type&&r.style){var p=o.style={};zrUtil.each(["x","y","width","height"],function(t){prepareStyleTransition(t,p,s,e.style,n)})}if("text"===e.type&&r.style){p=o.style={};zrUtil.each(["x","y"],function(t){prepareStyleTransition(t,p,s,e.style,n)}),!s.hasOwnProperty("textFill")&&s.fill&&(s.textFill=s.fill),!s.hasOwnProperty("textStroke")&&s.stroke&&(s.textStroke=s.stroke)}if("group"!==e.type&&(e.useStyle(s),n)){e.style.opacity=0;var u=s.opacity;null==u&&(u=1),graphicUtil.initProps(e,{style:{opacity:u}},a,t)}n?e.attr(o):graphicUtil.updateProps(e,o,a,t),r.hasOwnProperty("z2")&&e.attr("z2",r.z2||0),r.hasOwnProperty("silent")&&e.attr("silent",r.silent),r.hasOwnProperty("invisible")&&e.attr("invisible",r.invisible),r.hasOwnProperty("ignore")&&e.attr("ignore",r.ignore),r.hasOwnProperty("info")&&e.attr("info",r.info);var d=r.styleEmphasis;graphicUtil.setElementHoverStyle(e,d),l&&graphicUtil.setAsHighDownDispatcher(e,!1!==d)}function prepareStyleTransition(e,t,r,a,i){null==r[e]||i||(t[e]=r[e],r[e]=a[e])}function makeRenderItem(e,t,r,a){var i=e.get("renderItem"),n=e.coordinateSystem,l={};n&&(l=n.prepareCustoms?n.prepareCustoms():prepareCustoms[n.type](n));var o,s,p,u,d,c=zrUtil.defaults({getWidth:a.getWidth,getHeight:a.getHeight,getZr:a.getZr,getDevicePixelRatio:a.getDevicePixelRatio,value:function(e,r){return null==r&&(r=o),t.get(t.getDimension(e||0),r)},style:function(r,a){null==a&&(a=o),m(a);var i=s.getModel(ITEM_STYLE_NORMAL_PATH).getItemStyle();null!=d&&(i.fill=d);var n=t.getItemVisual(a,"opacity");null!=n&&(i.opacity=n);var l=r?applyExtraBefore(r,p):p;return graphicUtil.setTextStyle(i,l,null,{autoColor:d,isRectText:!0}),i.text=l.getShallow("show")?zrUtil.retrieve2(e.getFormattedLabel(a,"normal"),getDefaultLabel(t,a)):null,r&&applyExtraAfter(i,r),i},styleEmphasis:function(r,a){null==a&&(a=o),m(a);var i=s.getModel(ITEM_STYLE_EMPHASIS_PATH).getItemStyle(),n=r?applyExtraBefore(r,u):u;return graphicUtil.setTextStyle(i,n,null,{isRectText:!0},!0),i.text=n.getShallow("show")?zrUtil.retrieve3(e.getFormattedLabel(a,"emphasis"),e.getFormattedLabel(a,"normal"),getDefaultLabel(t,a)):null,r&&applyExtraAfter(i,r),i},visual:function(e,r){return null==r&&(r=o),t.getItemVisual(r,e)},barLayout:function(e){if(n.getBaseAxis){var t=n.getBaseAxis();return getLayoutOnAxis(zrUtil.defaults({axis:t},e),a)}},currentSeriesIndices:function(){return r.getCurrentSeriesIndices()},font:function(e){return graphicUtil.getFont(e,r)}},l.api||{}),h={context:{},seriesId:e.id,seriesName:e.name,seriesIndex:e.seriesIndex,coordSys:l.coordSys,dataInsideLength:t.count(),encode:wrapEncodeDef(e.getData())},g=!0;return function(e,r){return o=e,g=!0,i&&i(zrUtil.defaults({dataIndexInside:e,dataIndex:t.getRawIndex(e),actionType:r?r.type:null},h),c)};function m(e){null==e&&(e=o),g&&(s=t.getItemModel(e),p=s.getModel(LABEL_NORMAL),u=s.getModel(LABEL_EMPHASIS),d=t.getItemVisual(e,"color"),g=!1)}}function wrapEncodeDef(e){var t={};return zrUtil.each(e.dimensions,function(r,a){var i=e.getDimensionInfo(r);if(!i.isExtraCoord){var n=i.coordDim;(t[n]=t[n]||[])[i.coordDimIndex]=a}}),t}function createOrUpdate(e,t,r,a,i,n){return(e=doCreateOrUpdate(e,t,r,a,i,n,!0))&&n.setItemGraphicEl(t,e),e}function doCreateOrUpdate(e,t,r,a,i,n,l){var o=!r,s=(r=r||{}).type,p=r.shape,u=r.style;if(e&&(o||null!=s&&s!==e.__customGraphicType||"path"===s&&hasOwnPathData(p)&&getPathData(p)!==e.__customPathData||"image"===s&&hasOwn(u,"image")&&u.image!==e.__customImagePath||"text"===s&&hasOwn(p,"text")&&u.text!==e.__customText)&&(i.remove(e),e=null),!o){var d=!e;return!e&&(e=createEl(r)),updateEl(e,t,r,a,n,d,l),"group"===s&&mergeChildren(e,t,r,a,n),i.add(e),e}}function mergeChildren(e,t,r,a,i){var n=r.children,l=n?n.length:0,o=r.$mergeChildren,s="byName"===o||r.diffChildrenByName,p=!1===o;if(l||s||p)if(s)diffGroupChildren({oldChildren:e.children()||[],newChildren:n||[],dataIndex:t,animatableModel:a,group:e,data:i});else{p&&e.removeAll();for(var u=0;u<l;u++)n[u]&&doCreateOrUpdate(e.childAt(u),t,n[u],a,e,i)}}function diffGroupChildren(e){new DataDiffer(e.oldChildren,e.newChildren,getKey,getKey,e).add(processAddUpdate).update(processAddUpdate).remove(processRemove).execute()}function getKey(e,t){var r=e&&e.name;return null!=r?r:GROUP_DIFF_PREFIX+t}function processAddUpdate(e,t){var r=this.context,a=null!=e?r.newChildren[e]:null;doCreateOrUpdate(null!=t?r.oldChildren[t]:null,r.dataIndex,a,r.animatableModel,r.group,r.data)}function applyExtraBefore(e,t){var r=new Model({},t);return zrUtil.each(CACHED_LABEL_STYLE_PROPERTIES,function(t,a){e.hasOwnProperty(t)&&(r.option[a]=e[t])}),r}function applyExtraAfter(e,t){for(var r in t)!t.hasOwnProperty(r)&&CACHED_LABEL_STYLE_PROPERTIES.hasOwnProperty(r)||(e[r]=t[r])}function processRemove(e){var t=this.context,r=t.oldChildren[e];r&&t.group.remove(r)}function getPathData(e){return e&&(e.pathData||e.d)}function hasOwnPathData(e){return e&&(e.hasOwnProperty("pathData")||e.hasOwnProperty("d"))}function hasOwn(e,t){return e&&e.hasOwnProperty(t)}SeriesModel.extend({type:"series.custom",dependencies:["grid","polar","geo","singleAxis","calendar"],defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,useTransform:!0,clip:!1},getInitialData:function(e,t){return createListFromArray(this.getSource(),this)},getDataParams:function(e,t,r){var a=SeriesModel.prototype.getDataParams.apply(this,arguments);return r&&(a.info=r.info),a}}),ChartView.extend({type:"custom",_data:null,render:function(e,t,r,a){var i=this._data,n=e.getData(),l=this.group,o=makeRenderItem(e,n,t,r);n.diff(i).add(function(t){createOrUpdate(null,t,o(t,a),e,l,n)}).update(function(t,r){createOrUpdate(i.getItemGraphicEl(r),t,o(t,a),e,l,n)}).remove(function(e){var t=i.getItemGraphicEl(e);t&&l.remove(t)}).execute();var s=e.get("clip",!0)?createClipPath(e.coordinateSystem,!1,e):null;s?l.setClipPath(s):l.removeClipPath(),this._data=n},incrementalPrepareRender:function(e,t,r){this.group.removeAll(),this._data=null},incrementalRender:function(e,t,r,a,i){var n=t.getData(),l=makeRenderItem(t,n,r,a);function o(e){e.isGroup||(e.incremental=!0,e.useHoverLayer=!0)}for(var s=e.start;s<e.end;s++){createOrUpdate(null,s,l(s,i),t,this.group,n).traverse(o)}},dispose:zrUtil.noop,filterForExposedEvent:function(e,t,r,a){var i=t.element;if(null==i||r.name===i)return!0;for(;(r=r.parent)&&r!==this.group;)if(r.name===i)return!0;return!1}});
//# sourceMappingURL=/sm/f6176f14da87ed1da1ac23b8f6bdc076590593c0c7eeec4129bb866910ae41fd.map