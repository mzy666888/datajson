/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/chart/graph/forceLayout.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var _forceHelper=require("./forceHelper"),forceLayout=_forceHelper.forceLayout,_simpleLayoutHelper=require("./simpleLayoutHelper"),simpleLayout=_simpleLayoutHelper.simpleLayout,_circularLayoutHelper=require("./circularLayoutHelper"),circularLayout=_circularLayoutHelper.circularLayout,_number=require("../../util/number"),linearMap=_number.linearMap,vec2=require("zrender/lib/core/vector"),zrUtil=require("zrender/lib/core/util");function _default(e){e.eachSeriesByType("graph",function(e){if(!(p=e.coordinateSystem)||"view"===p.type)if("force"===e.get("layout")){var r=e.preservedPoints||{},t=e.getGraph(),a=t.data,o=t.edgeData,u=e.getModel("force"),i=u.get("initLayout");e.preservedPoints?a.each(function(e){var t=a.getId(e);a.setItemLayout(e,r[t]||[NaN,NaN])}):i&&"none"!==i?"circular"===i&&circularLayout(e,"value"):simpleLayout(e);var n=a.getDataExtent("value"),c=o.getDataExtent("value"),l=u.get("repulsion"),y=u.get("edgeLength");zrUtil.isArray(l)||(l=[l,l]),zrUtil.isArray(y)||(y=[y,y]),y=[y[1],y[0]];var p,s=a.mapArray("value",function(e,r){var t=a.getItemLayout(r),o=linearMap(e,n,l);return isNaN(o)&&(o=(l[0]+l[1])/2),{w:o,rep:o,fixed:a.getItemModel(r).get("fixed"),p:!t||isNaN(t[0])||isNaN(t[1])?null:t}}),g=o.mapArray("value",function(e,r){var a=t.getEdgeByIndex(r),o=linearMap(e,c,y);isNaN(o)&&(o=(y[0]+y[1])/2);var u=a.getModel();return{n1:s[a.node1.dataIndex],n2:s[a.node2.dataIndex],d:o,curveness:u.get("lineStyle.curveness")||0,ignoreForceLayout:u.get("ignoreForceLayout")}}),d=(p=e.coordinateSystem).getBoundingRect(),v=forceLayout(s,g,{rect:d,gravity:u.get("gravity"),friction:u.get("friction")}),f=v.step;v.step=function(e){for(var o=0,u=s.length;o<u;o++)s[o].fixed&&vec2.copy(s[o].p,t.getNodeByIndex(o).getLayout());f(function(o,u,i){for(var n=0,c=o.length;n<c;n++)o[n].fixed||t.getNodeByIndex(n).setLayout(o[n].p),r[a.getId(n)]=o[n].p;for(n=0,c=u.length;n<c;n++){var l=u[n],y=t.getEdgeByIndex(n),p=l.n1.p,s=l.n2.p,g=y.getLayout();(g=g?g.slice():[])[0]=g[0]||[],g[1]=g[1]||[],vec2.copy(g[0],p),vec2.copy(g[1],s),+l.curveness&&(g[2]=[(p[0]+s[0])/2-(p[1]-s[1])*l.curveness,(p[1]+s[1])/2-(s[0]-p[0])*l.curveness]),y.setLayout(g)}e&&e(i)})},e.forceLayout=v,e.preservedPoints=r,v.step()}else e.forceLayout=null})}module.exports=_default;
//# sourceMappingURL=/sm/1e5623a7d56104f5d46e5cb3c1b7eb66dba900ea9a4c9d1fa8382ed471c93b55.map