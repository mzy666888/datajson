/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/chart/heatmap/HeatmapView.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var _config=require("../../config"),__DEV__=_config.__DEV__,echarts=require("../../echarts"),graphic=require("../../util/graphic"),HeatmapLayer=require("./HeatmapLayer"),zrUtil=require("zrender/lib/core/util");function getIsInPiecewiseRange(e,t,a){var i=e[1]-e[0],n=(t=zrUtil.map(t,function(t){return{interval:[(t.interval[0]-e[0])/i,(t.interval[1]-e[0])/i]}})).length,r=0;return function(e){for(var i=r;i<n;i++){if((o=t[i].interval)[0]<=e&&e<=o[1]){r=i;break}}if(i===n)for(i=r-1;i>=0;i--){var o;if((o=t[i].interval)[0]<=e&&e<=o[1]){r=i;break}}return i>=0&&i<n&&a[i]}}function getIsInContinuousRange(e,t){var a=e[1]-e[0];return t=[(t[0]-e[0])/a,(t[1]-e[0])/a],function(e){return e>=t[0]&&e<=t[1]}}function isGeoCoordSys(e){var t=e.dimensions;return"lng"===t[0]&&"lat"===t[1]}var _default=echarts.extendChartView({type:"heatmap",render:function(e,t,a){var i;t.eachComponent("visualMap",function(t){t.eachTargetSeries(function(a){a===e&&(i=t)})}),this.group.removeAll(),this._incrementalDisplayable=null;var n=e.coordinateSystem;"cartesian2d"===n.type||"calendar"===n.type?this._renderOnCartesianAndCalendar(e,a,0,e.getData().count()):isGeoCoordSys(n)&&this._renderOnGeo(n,e,i,a)},incrementalPrepareRender:function(e,t,a){this.group.removeAll()},incrementalRender:function(e,t,a,i){t.coordinateSystem&&this._renderOnCartesianAndCalendar(t,i,e.start,e.end,!0)},_renderOnCartesianAndCalendar:function(e,t,a,i,n){var r,o,l=e.coordinateSystem;if("cartesian2d"===l.type){var s=l.getAxis("x"),g=l.getAxis("y");r=s.getBandWidth(),o=g.getBandWidth()}for(var c=this.group,m=e.getData(),p=e.getModel("itemStyle").getItemStyle(["color"]),u=e.getModel("emphasis.itemStyle").getItemStyle(),d=e.getModel("label"),h=e.getModel("emphasis.label"),y=l.type,f="cartesian2d"===y?[m.mapDimension("x"),m.mapDimension("y"),m.mapDimension("value")]:[m.mapDimension("time"),m.mapDimension("value")],v=a;v<i;v++){var I;if("cartesian2d"===y){if(isNaN(m.get(f[2],v)))continue;var S=l.dataToPoint([m.get(f[0],v),m.get(f[1],v)]);I=new graphic.Rect({shape:{x:S[0]-r/2,y:S[1]-o/2,width:r,height:o},style:{fill:m.getItemVisual(v,"color"),opacity:m.getItemVisual(v,"opacity")}})}else{if(isNaN(m.get(f[1],v)))continue;I=new graphic.Rect({z2:1,shape:l.dataToRect([m.get(f[0],v)]).contentShape,style:{fill:m.getItemVisual(v,"color"),opacity:m.getItemVisual(v,"opacity")}})}var _=m.getItemModel(v);m.hasItemOption&&(p=_.getModel("itemStyle").getItemStyle(["color"]),u=_.getModel("emphasis.itemStyle").getItemStyle(),d=_.getModel("label"),h=_.getModel("emphasis.label"));var x=e.getRawValue(v),M="-";x&&null!=x[2]&&(M=x[2]),graphic.setLabelStyle(p,u,d,h,{labelFetcher:e,labelDataIndex:v,defaultText:M,isRectText:!0}),I.setStyle(p),graphic.setHoverStyle(I,m.hasItemOption?u:zrUtil.extend({},u)),I.incremental=n,n&&(I.useHoverLayer=!0),c.add(I),m.setItemGraphicEl(v,I)}},_renderOnGeo:function(e,t,a,i){var n=a.targetVisuals.inRange,r=a.targetVisuals.outOfRange,o=t.getData(),l=this._hmLayer||this._hmLayer||new HeatmapLayer;l.blurSize=t.get("blurSize"),l.pointSize=t.get("pointSize"),l.minOpacity=t.get("minOpacity"),l.maxOpacity=t.get("maxOpacity");var s=e.getViewRect().clone(),g=e.getRoamTransform();s.applyTransform(g);var c=Math.max(s.x,0),m=Math.max(s.y,0),p=Math.min(s.width+s.x,i.getWidth()),u=Math.min(s.height+s.y,i.getHeight()),d=p-c,h=u-m,y=[o.mapDimension("lng"),o.mapDimension("lat"),o.mapDimension("value")],f=o.mapArray(y,function(t,a,i){var n=e.dataToPoint([t,a]);return n[0]-=c,n[1]-=m,n.push(i),n}),v=a.getExtent(),I="visualMap.continuous"===a.type?getIsInContinuousRange(v,a.option.range):getIsInPiecewiseRange(v,a.getPieceList(),a.option.selected);l.update(f,d,h,n.color.getNormalizer(),{inRange:n.color.getColorMapper(),outOfRange:r.color.getColorMapper()},I);var S=new graphic.Image({style:{width:d,height:h,x:c,y:m,image:l.canvas},silent:!0});this.group.add(S)},dispose:function(){}});module.exports=_default;
//# sourceMappingURL=/sm/867d66408656ad820bd8e452c884aebb1c27546be80a242c4aeb2938746bacad.map