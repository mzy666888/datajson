/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/chart/bar/BarView.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var _config=require("../../config"),__DEV__=_config.__DEV__,echarts=require("../../echarts"),zrUtil=require("zrender/lib/core/util"),graphic=require("../../util/graphic"),_helper=require("./helper"),setLabel=_helper.setLabel,Model=require("../../model/Model"),barItemStyle=require("./barItemStyle"),Path=require("zrender/lib/graphic/Path"),_throttle=require("../../util/throttle"),throttle=_throttle.throttle,_createClipPathFromCoordSys=require("../helper/createClipPathFromCoordSys"),createClipPath=_createClipPathFromCoordSys.createClipPath,Sausage=require("../../util/shape/sausage"),BAR_BORDER_WIDTH_QUERY=["itemStyle","barBorderWidth"],_eventPos=[0,0];function getClipArea(e,t){var a=e.getArea&&e.getArea();if("cartesian2d"===e.type){var r=e.getBaseAxis();if("category"!==r.type||!r.onBand){var i=t.getLayout("bandWidth");r.isHorizontal()?(a.x-=i,a.width+=2*i):(a.y-=i,a.height+=2*i)}}return a}zrUtil.extend(Model.prototype,barItemStyle);var _default=echarts.extendChartView({type:"bar",render:function(e,t,a){this._updateDrawMode(e);var r=e.get("coordinateSystem");return"cartesian2d"!==r&&"polar"!==r||(this._isLargeDraw?this._renderLarge(e,t,a):this._renderNormal(e,t,a)),this.group},incrementalPrepareRender:function(e,t,a){this._clear(),this._updateDrawMode(e)},incrementalRender:function(e,t,a,r){this._incrementalRenderLarge(e,t)},_updateDrawMode:function(e){var t=e.pipelineContext.large;(null==this._isLargeDraw||t^this._isLargeDraw)&&(this._isLargeDraw=t,this._clear())},_renderNormal:function(e,t,a){var r,i=this.group,n=e.getData(),o=this._data,h=e.coordinateSystem,l=h.getBaseAxis();"cartesian2d"===h.type?r=l.isHorizontal():"polar"===h.type&&(r="angle"===l.dim);var s=e.isAnimationEnabled()?e:null,d=e.get("clip",!0),g=getClipArea(h,n);i.removeClipPath();var p=e.get("roundCap",!0);n.diff(o).add(function(t){if(n.hasValue(t)){var a=n.getItemModel(t),o=getLayout[h.type](n,t,a);if(d)if(clip[h.type](g,o))return void i.remove(l);var l=elementCreator[h.type](t,o,r,s,!1,p);n.setItemGraphicEl(t,l),i.add(l),updateStyle(l,n,t,a,o,e,r,"polar"===h.type)}}).update(function(t,a){var l=o.getItemGraphicEl(a);if(n.hasValue(t)){var u=n.getItemModel(t),c=getLayout[h.type](n,t,u);if(d)if(clip[h.type](g,c))return void i.remove(l);l?graphic.updateProps(l,{shape:c},s,t):l=elementCreator[h.type](t,c,r,s,!0,p),n.setItemGraphicEl(t,l),i.add(l),updateStyle(l,n,t,u,c,e,r,"polar"===h.type)}else i.remove(l)}).remove(function(e){var t=o.getItemGraphicEl(e);"cartesian2d"===h.type?t&&removeRect(e,s,t):t&&removeSector(e,s,t)}).execute(),this._data=n},_renderLarge:function(e,t,a){this._clear(),createLarge(e,this.group);var r=e.get("clip",!0)?createClipPath(e.coordinateSystem,!1,e):null;r?this.group.setClipPath(r):this.group.removeClipPath()},_incrementalRenderLarge:function(e,t){createLarge(t,this.group,!0)},dispose:zrUtil.noop,remove:function(e){this._clear(e)},_clear:function(e){var t=this.group,a=this._data;e&&e.get("animation")&&a&&!this._isLargeDraw?a.eachItemGraphicEl(function(t){"sector"===t.type?removeSector(t.dataIndex,e,t):removeRect(t.dataIndex,e,t)}):t.removeAll(),this._data=null}}),mathMax=Math.max,mathMin=Math.min,clip={cartesian2d:function(e,t){var a=t.width<0?-1:1,r=t.height<0?-1:1;a<0&&(t.x+=t.width,t.width=-t.width),r<0&&(t.y+=t.height,t.height=-t.height);var i=mathMax(t.x,e.x),n=mathMin(t.x+t.width,e.x+e.width),o=mathMax(t.y,e.y),h=mathMin(t.y+t.height,e.y+e.height);t.x=i,t.y=o,t.width=n-i,t.height=h-o;var l=t.width<0||t.height<0;return a<0&&(t.x+=t.width,t.width=-t.width),r<0&&(t.y+=t.height,t.height=-t.height),l},polar:function(e){return!1}},elementCreator={cartesian2d:function(e,t,a,r,i){var n=new graphic.Rect({shape:zrUtil.extend({},t)});if(r){var o=a?"height":"width",h={};n.shape[o]=0,h[o]=t[o],graphic[i?"updateProps":"initProps"](n,{shape:h},r,e)}return n},polar:function(e,t,a,r,i,n){var o=t.startAngle<t.endAngle,h=new(!a&&n?Sausage:graphic.Sector)({shape:zrUtil.defaults({clockwise:o},t)});if(r){var l=a?"r":"endAngle",s={};h.shape[l]=a?0:t.startAngle,s[l]=t[l],graphic[i?"updateProps":"initProps"](h,{shape:s},r,e)}return h}};function removeRect(e,t,a){a.style.text=null,graphic.updateProps(a,{shape:{width:0}},t,e,function(){a.parent&&a.parent.remove(a)})}function removeSector(e,t,a){a.style.text=null,graphic.updateProps(a,{shape:{r:a.shape.r0}},t,e,function(){a.parent&&a.parent.remove(a)})}var getLayout={cartesian2d:function(e,t,a){var r=e.getItemLayout(t),i=getLineWidth(a,r),n=r.width>0?1:-1,o=r.height>0?1:-1;return{x:r.x+n*i/2,y:r.y+o*i/2,width:r.width-n*i,height:r.height-o*i}},polar:function(e,t,a){var r=e.getItemLayout(t);return{cx:r.cx,cy:r.cy,r0:r.r0,r:r.r,startAngle:r.startAngle,endAngle:r.endAngle}}};function updateStyle(e,t,a,r,i,n,o,h){var l=t.getItemVisual(a,"color"),s=t.getItemVisual(a,"opacity"),d=r.getModel("itemStyle"),g=r.getModel("emphasis.itemStyle").getBarItemStyle();h||e.setShape("r",d.get("barBorderRadius")||0),e.useStyle(zrUtil.defaults({fill:l,opacity:s},d.getBarItemStyle()));var p=r.getShallow("cursor");p&&e.attr("cursor",p);var u=o?i.height>0?"bottom":"top":i.width>0?"left":"right";h||setLabel(e.style,g,r,l,n,a,u),graphic.setHoverStyle(e,g)}function getLineWidth(e,t){var a=e.get(BAR_BORDER_WIDTH_QUERY)||0;return Math.min(a,Math.abs(t.width),Math.abs(t.height))}var LargePath=Path.extend({type:"largeBar",shape:{points:[]},buildPath:function(e,t){for(var a=t.points,r=this.__startPoint,i=this.__baseDimIdx,n=0;n<a.length;n+=2)r[i]=a[n+i],e.moveTo(r[0],r[1]),e.lineTo(a[n],a[n+1])}});function createLarge(e,t,a){var r=e.getData(),i=[],n=r.getLayout("valueAxisHorizontal")?1:0;i[1-n]=r.getLayout("valueAxisStart");var o=new LargePath({shape:{points:r.getLayout("largePoints")},incremental:!!a,__startPoint:i,__baseDimIdx:n,__largeDataIndices:r.getLayout("largeDataIndices"),__barWidth:r.getLayout("barWidth")});t.add(o),setLargeStyle(o,e,r),o.seriesIndex=e.seriesIndex,e.get("silent")||(o.on("mousedown",largePathUpdateDataIndex),o.on("mousemove",largePathUpdateDataIndex))}var largePathUpdateDataIndex=throttle(function(e){var t=largePathFindDataIndex(this,e.offsetX,e.offsetY);this.dataIndex=t>=0?t:null},30,!1);function largePathFindDataIndex(e,t,a){var r=e.__baseDimIdx,i=1-r,n=e.shape.points,o=e.__largeDataIndices,h=Math.abs(e.__barWidth/2),l=e.__startPoint[i];_eventPos[0]=t,_eventPos[1]=a;for(var s=_eventPos[r],d=_eventPos[1-r],g=s-h,p=s+h,u=0,c=n.length/2;u<c;u++){var m=2*u,y=n[m+r],_=n[m+i];if(y>=g&&y<=p&&(l<=_?d>=l&&d<=_:d>=_&&d<=l))return o[u]}return-1}function setLargeStyle(e,t,a){var r=a.getVisual("borderColor")||a.getVisual("color"),i=t.getModel("itemStyle").getItemStyle(["color","borderColor"]);e.useStyle(i),e.style.fill=null,e.style.stroke=r,e.style.lineWidth=a.getLayout("barWidth")}module.exports=_default;
//# sourceMappingURL=/sm/ef583df11a995cfa9886b9b1c3a6f5087d992a99f03c65afce5330312c82a159.map