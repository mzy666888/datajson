/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/chart/helper/LargeSymbolDraw.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var graphic=require("../../util/graphic"),_symbol=require("../../util/symbol"),createSymbol=_symbol.createSymbol,IncrementalDisplayable=require("zrender/lib/graphic/IncrementalDisplayable"),BOOST_SIZE_THRESHOLD=4,LargeSymbolPath=graphic.extendShape({shape:{points:null},symbolProxy:null,softClipShape:null,buildPath:function(e,t){var a=t.points,r=t.size,o=this.symbolProxy,l=o.shape;if(!((e.getContext?e.getContext():e)&&r[0]<BOOST_SIZE_THRESHOLD))for(var n=0;n<a.length;){var i=a[n++],s=a[n++];isNaN(i)||isNaN(s)||(this.softClipShape&&!this.softClipShape.contain(i,s)||(l.x=i-r[0]/2,l.y=s-r[1]/2,l.width=r[0],l.height=r[1],o.buildPath(e,l,!0)))}},afterBrush:function(e){var t=this.shape,a=t.points,r=t.size;if(r[0]<BOOST_SIZE_THRESHOLD){this.setTransform(e);for(var o=0;o<a.length;){var l=a[o++],n=a[o++];isNaN(l)||isNaN(n)||(this.softClipShape&&!this.softClipShape.contain(l,n)||e.fillRect(l-r[0]/2,n-r[1]/2,r[0],r[1]))}this.restoreTransform(e)}},findDataIndex:function(e,t){for(var a=this.shape,r=a.points,o=a.size,l=Math.max(o[0],4),n=Math.max(o[1],4),i=r.length/2-1;i>=0;i--){var s=2*i,h=r[s]-l/2,m=r[s+1]-n/2;if(e>=h&&t>=m&&e<=h+l&&t<=m+n)return i}return-1}});function LargeSymbolDraw(){this.group=new graphic.Group}var largeSymbolProto=LargeSymbolDraw.prototype;largeSymbolProto.isPersistent=function(){return!this._incremental},largeSymbolProto.updateData=function(e,t){this.group.removeAll();var a=new LargeSymbolPath({rectHover:!0,cursor:"default"});a.setShape({points:e.getLayout("symbolPoints")}),this._setCommon(a,e,!1,t),this.group.add(a),this._incremental=null},largeSymbolProto.updateLayout=function(e){if(!this._incremental){var t=e.getLayout("symbolPoints");this.group.eachChild(function(e){if(null!=e.startIndex){var a=2*(e.endIndex-e.startIndex),r=4*e.startIndex*2;t=new Float32Array(t.buffer,r,a)}e.setShape("points",t)})}},largeSymbolProto.incrementalPrepareUpdate=function(e){this.group.removeAll(),this._clearIncremental(),e.count()>2e6?(this._incremental||(this._incremental=new IncrementalDisplayable({silent:!0})),this.group.add(this._incremental)):this._incremental=null},largeSymbolProto.incrementalUpdate=function(e,t,a){var r;this._incremental?(r=new LargeSymbolPath,this._incremental.addDisplayable(r,!0)):((r=new LargeSymbolPath({rectHover:!0,cursor:"default",startIndex:e.start,endIndex:e.end})).incremental=!0,this.group.add(r)),r.setShape({points:t.getLayout("symbolPoints")}),this._setCommon(r,t,!!this._incremental,a)},largeSymbolProto._setCommon=function(e,t,a,r){var o=t.hostModel;r=r||{};var l=t.getVisual("symbolSize");e.setShape("size",l instanceof Array?l:[l,l]),e.softClipShape=r.clipShape||null,e.symbolProxy=createSymbol(t.getVisual("symbol"),0,0,0,0),e.setColor=e.symbolProxy.setColor;var n=e.shape.size[0]<BOOST_SIZE_THRESHOLD;e.useStyle(o.getModel("itemStyle").getItemStyle(n?["color","shadowBlur","shadowColor"]:["color"]));var i=t.getVisual("color");i&&e.setColor(i),a||(e.seriesIndex=o.seriesIndex,e.on("mousemove",function(t){e.dataIndex=null;var a=e.findDataIndex(t.offsetX,t.offsetY);a>=0&&(e.dataIndex=a+(e.startIndex||0))}))},largeSymbolProto.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll()},largeSymbolProto._clearIncremental=function(){var e=this._incremental;e&&e.clearDisplaybles()};var _default=LargeSymbolDraw;module.exports=_default;
//# sourceMappingURL=/sm/bf0ed73228bffa6343a01340035e32a0ed55bdae509f7774d22eeb9dffcf34d2.map