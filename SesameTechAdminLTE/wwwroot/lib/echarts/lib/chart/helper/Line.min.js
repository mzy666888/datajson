/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/chart/helper/Line.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var zrUtil=require("zrender/lib/core/util"),vector=require("zrender/lib/core/vector"),symbolUtil=require("../../util/symbol"),LinePath=require("./LinePath"),graphic=require("../../util/graphic"),_number=require("../../util/number"),round=_number.round,SYMBOL_CATEGORIES=["fromSymbol","toSymbol"];function makeSymbolTypeKey(t){return"_"+t+"Type"}function createSymbol(t,e,i){var a=e.getItemVisual(i,"color"),l=e.getItemVisual(i,t),o=e.getItemVisual(i,t+"Size");if(l&&"none"!==l){zrUtil.isArray(o)||(o=[o,o]);var r=symbolUtil.createSymbol(l,-o[0]/2,-o[1]/2,o[0],o[1],a);return r.name=t,r}}function createLine(t){var e=new LinePath({name:"line",subPixelOptimize:!0});return setLinePoints(e.shape,t),e}function setLinePoints(t,e){t.x1=e[0][0],t.y1=e[0][1],t.x2=e[1][0],t.y2=e[1][1],t.percent=1;var i=e[2];i?(t.cpx1=i[0],t.cpy1=i[1]):(t.cpx1=NaN,t.cpy1=NaN)}function updateSymbolAndLabelBeforeLineUpdate(){var t=this.childOfName("fromSymbol"),e=this.childOfName("toSymbol"),i=this.childOfName("label");if(t||e||!i.ignore){for(var a=1,l=this.parent;l;)l.scale&&(a/=l.scale[0]),l=l.parent;var o=this.childOfName("line");if(this.__dirty||o.__dirty){var r=o.shape.percent,n=o.pointAt(0),s=o.pointAt(r),h=vector.sub([],s,n);if(vector.normalize(h,h),t){t.attr("position",n);var c=o.tangentAt(0);t.attr("rotation",Math.PI/2-Math.atan2(c[1],c[0])),t.attr("scale",[a*r,a*r])}if(e){e.attr("position",s);c=o.tangentAt(1);e.attr("rotation",-Math.PI/2-Math.atan2(c[1],c[0])),e.attr("scale",[a*r,a*r])}if(!i.ignore){var m,p,u;i.attr("position",s);var d=5*a;if("end"===i.__position)m=[h[0]*d+s[0],h[1]*d+s[1]],p=h[0]>.8?"left":h[0]<-.8?"right":"center",u=h[1]>.8?"top":h[1]<-.8?"bottom":"middle";else if("middle"===i.__position){var g=r/2,y=[(c=o.tangentAt(g))[1],-c[0]],f=o.pointAt(g);y[1]>0&&(y[0]=-y[0],y[1]=-y[1]),m=[f[0]+y[0]*d,f[1]+y[1]*d],p="center",u="bottom";var S=-Math.atan2(c[1],c[0]);s[0]<n[0]&&(S=Math.PI+S),i.attr("rotation",S)}else m=[-h[0]*d+n[0],-h[1]*d+n[1]],p=h[0]>.8?"right":h[0]<-.8?"left":"center",u=h[1]>.8?"bottom":h[1]<-.8?"top":"middle";i.attr({style:{textVerticalAlign:i.__verticalAlign||u,textAlign:i.__textAlign||p},position:m,scale:[a,a]})}}}}function Line(t,e,i){graphic.Group.call(this),this._createLine(t,e,i)}var lineProto=Line.prototype;lineProto.beforeUpdate=updateSymbolAndLabelBeforeLineUpdate,lineProto._createLine=function(t,e,i){var a=t.hostModel,l=createLine(t.getItemLayout(e));l.shape.percent=0,graphic.initProps(l,{shape:{percent:1}},a,e),this.add(l);var o=new graphic.Text({name:"label",lineLabelOriginalOpacity:1});this.add(o),zrUtil.each(SYMBOL_CATEGORIES,function(i){var a=createSymbol(i,t,e);this.add(a),this[makeSymbolTypeKey(i)]=t.getItemVisual(e,i)},this),this._updateCommonStl(t,e,i)},lineProto.updateData=function(t,e,i){var a=t.hostModel,l=this.childOfName("line"),o=t.getItemLayout(e),r={shape:{}};setLinePoints(r.shape,o),graphic.updateProps(l,r,a,e),zrUtil.each(SYMBOL_CATEGORIES,function(i){var a=t.getItemVisual(e,i),l=makeSymbolTypeKey(i);if(this[l]!==a){this.remove(this.childOfName(i));var o=createSymbol(i,t,e);this.add(o)}this[l]=a},this),this._updateCommonStl(t,e,i)},lineProto._updateCommonStl=function(t,e,i){var a=t.hostModel,l=this.childOfName("line"),o=i&&i.lineStyle,r=i&&i.hoverLineStyle,n=i&&i.labelModel,s=i&&i.hoverLabelModel;if(!i||t.hasItemOption){var h=t.getItemModel(e);o=h.getModel("lineStyle").getLineStyle(),r=h.getModel("emphasis.lineStyle").getLineStyle(),n=h.getModel("label"),s=h.getModel("emphasis.label")}var c=t.getItemVisual(e,"color"),m=zrUtil.retrieve3(t.getItemVisual(e,"opacity"),o.opacity,1);l.useStyle(zrUtil.defaults({strokeNoScale:!0,fill:"none",stroke:c,opacity:m},o)),l.hoverStyle=r,zrUtil.each(SYMBOL_CATEGORIES,function(t){var e=this.childOfName(t);e&&(e.setColor(c),e.setStyle({opacity:m}))},this);var p,u,d=n.getShallow("show"),g=s.getShallow("show"),y=this.childOfName("label");if((d||g)&&(p=c||"#000",null==(u=a.getFormattedLabel(e,"normal",t.dataType)))){var f=a.getRawValue(e);u=null==f?t.getName(e):isFinite(f)?round(f):f}var S=d?u:null,v=g?zrUtil.retrieve2(a.getFormattedLabel(e,"emphasis",t.dataType),u):null,b=y.style;null==S&&null==v||(graphic.setTextStyle(y.style,n,{text:S},{autoColor:p}),y.__textAlign=b.textAlign,y.__verticalAlign=b.textVerticalAlign,y.__position=n.get("position")||"middle"),y.hoverStyle=null!=v?{text:v,textFill:s.getTextColor(!0),fontStyle:s.getShallow("fontStyle"),fontWeight:s.getShallow("fontWeight"),fontSize:s.getShallow("fontSize"),fontFamily:s.getShallow("fontFamily")}:{text:null},y.ignore=!d&&!g,graphic.setHoverStyle(this)},lineProto.highlight=function(){this.trigger("emphasis")},lineProto.downplay=function(){this.trigger("normal")},lineProto.updateLayout=function(t,e){this.setLinePoints(t.getItemLayout(e))},lineProto.setLinePoints=function(t){var e=this.childOfName("line");setLinePoints(e.shape,t),e.dirty()},zrUtil.inherits(Line,graphic.Group);var _default=Line;module.exports=_default;
//# sourceMappingURL=/sm/e20d9b759ffefd32cf30388c41feef9b0c7e0f1f8ddbc815ba043fd6cc516a2b.map