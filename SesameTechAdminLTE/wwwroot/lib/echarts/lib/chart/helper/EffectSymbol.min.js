/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/chart/helper/EffectSymbol.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var zrUtil=require("zrender/lib/core/util"),_symbol=require("../../util/symbol"),createSymbol=_symbol.createSymbol,_graphic=require("../../util/graphic"),Group=_graphic.Group,_number=require("../../util/number"),parsePercent=_number.parsePercent,SymbolClz=require("./Symbol"),EFFECT_RIPPLE_NUMBER=3;function normalizeSymbolSize(e){return zrUtil.isArray(e)||(e=[+e,+e]),e}function updateRipplePath(e,t){var o=t.rippleEffectColor||t.color;e.eachChild(function(e){e.attr({z:t.z,zlevel:t.zlevel,style:{stroke:"stroke"===t.brushType?o:null,fill:"fill"===t.brushType?o:null}})})}function EffectSymbol(e,t){Group.call(this);var o=new SymbolClz(e,t),i=new Group;this.add(o),this.add(i),i.beforeUpdate=function(){this.attr(o.getScale())},this.updateData(e,t)}var effectSymbolProto=EffectSymbol.prototype;effectSymbolProto.stopEffectAnimation=function(){this.childAt(1).removeAll()},effectSymbolProto.startEffectAnimation=function(e){for(var t=e.symbolType,o=e.color,i=this.childAt(1),r=0;r<EFFECT_RIPPLE_NUMBER;r++){var l=createSymbol(t,-1,-1,2,2,o);l.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scale:[.5,.5]});var f=-r/EFFECT_RIPPLE_NUMBER*e.period+e.effectOffset;l.animate("",!0).when(e.period,{scale:[e.rippleScale/2,e.rippleScale/2]}).delay(f).start(),l.animateStyle(!0).when(e.period,{opacity:0}).delay(f).start(),i.add(l)}updateRipplePath(i,e)},effectSymbolProto.updateEffectAnimation=function(e){for(var t=this._effectCfg,o=this.childAt(1),i=["symbolType","period","rippleScale"],r=0;r<i.length;r++){var l=i[r];if(t[l]!==e[l])return this.stopEffectAnimation(),void this.startEffectAnimation(e)}updateRipplePath(o,e)},effectSymbolProto.highlight=function(){this.trigger("emphasis")},effectSymbolProto.downplay=function(){this.trigger("normal")},effectSymbolProto.updateData=function(e,t){var o=e.hostModel;this.childAt(0).updateData(e,t);var i=this.childAt(1),r=e.getItemModel(t),l=e.getItemVisual(t,"symbol"),f=normalizeSymbolSize(e.getItemVisual(t,"symbolSize")),a=e.getItemVisual(t,"color");i.attr("scale",f),i.traverse(function(e){e.attr({fill:a})});var s=r.getShallow("symbolOffset");if(s){var n=i.position;n[0]=parsePercent(s[0],f[0]),n[1]=parsePercent(s[1],f[1])}i.rotation=(r.getShallow("symbolRotate")||0)*Math.PI/180||0;var c={};if(c.showEffectOn=o.get("showEffectOn"),c.rippleScale=r.get("rippleEffect.scale"),c.brushType=r.get("rippleEffect.brushType"),c.period=1e3*r.get("rippleEffect.period"),c.effectOffset=t/e.count(),c.z=r.getShallow("z")||0,c.zlevel=r.getShallow("zlevel")||0,c.symbolType=l,c.color=a,c.rippleEffectColor=r.get("rippleEffect.color"),this.off("mouseover").off("mouseout").off("emphasis").off("normal"),"render"===c.showEffectOn)this._effectCfg?this.updateEffectAnimation(c):this.startEffectAnimation(c),this._effectCfg=c;else{this._effectCfg=null,this.stopEffectAnimation();var h=this.childAt(0),p=function(){h.highlight(),"render"!==c.showEffectOn&&this.startEffectAnimation(c)},m=function(){h.downplay(),"render"!==c.showEffectOn&&this.stopEffectAnimation()};this.on("mouseover",p,this).on("mouseout",m,this).on("emphasis",p,this).on("normal",m,this)}this._effectCfg=c},effectSymbolProto.fadeOut=function(e){this.off("mouseover").off("mouseout").off("emphasis").off("normal"),e&&e()},zrUtil.inherits(EffectSymbol,Group);var _default=EffectSymbol;module.exports=_default;
//# sourceMappingURL=/sm/b7c78db3e0cdcba882b1fb1b3bfe2099ca99e659c1083984e83a0ead431f9836.map