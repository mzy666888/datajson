/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/chart/helper/EffectLine.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var graphic=require("../../util/graphic"),Line=require("./Line"),zrUtil=require("zrender/lib/core/util"),_symbol=require("../../util/symbol"),createSymbol=_symbol.createSymbol,vec2=require("zrender/lib/core/vector"),curveUtil=require("zrender/lib/core/curve");function EffectLine(t,e,i){graphic.Group.call(this),this.add(this.createLine(t,e,i)),this._updateEffectSymbol(t,e)}var effectLineProto=EffectLine.prototype;effectLineProto.createLine=function(t,e,i){return new Line(t,e,i)},effectLineProto._updateEffectSymbol=function(t,e){var i=t.getItemModel(e).getModel("effect"),o=i.get("symbolSize"),r=i.get("symbol");zrUtil.isArray(o)||(o=[o,o]);var n=i.get("color")||t.getItemVisual(e,"color"),a=this.childAt(1);this._symbolType!==r&&(this.remove(a),(a=createSymbol(r,-.5,-.5,1,1,n)).z2=100,a.culling=!0,this.add(a)),a&&(a.setStyle("shadowColor",n),a.setStyle(i.getItemStyle(["color"])),a.attr("scale",o),a.setColor(n),a.attr("scale",o),this._symbolType=r,this._updateEffectAnimation(t,i,e))},effectLineProto._updateEffectAnimation=function(t,e,i){var o=this.childAt(1);if(o){var r=this,n=t.getItemLayout(i),a=1e3*e.get("period"),c=e.get("loop"),f=e.get("constantSpeed"),l=zrUtil.retrieve(e.get("delay"),function(e){return e/t.count()*a/3}),u="function"==typeof l;if(o.ignore=!0,this.updateAnimationPoints(o,n),f>0&&(a=this.getLineLength(o)/f*1e3),a!==this._period||c!==this._loop){o.stopAnimation();var s=l;u&&(s=l(i)),o.__t>0&&(s=-a*o.__t),o.__t=0;var _=o.animate("",c).when(a,{__t:1}).delay(s).during(function(){r.updateSymbolPosition(o)});c||_.done(function(){r.remove(o)}),_.start()}this._period=a,this._loop=c}},effectLineProto.getLineLength=function(t){return vec2.dist(t.__p1,t.__cp1)+vec2.dist(t.__cp1,t.__p2)},effectLineProto.updateAnimationPoints=function(t,e){t.__p1=e[0],t.__p2=e[1],t.__cp1=e[2]||[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]},effectLineProto.updateData=function(t,e,i){this.childAt(0).updateData(t,e,i),this._updateEffectSymbol(t,e)},effectLineProto.updateSymbolPosition=function(t){var e=t.__p1,i=t.__p2,o=t.__cp1,r=t.__t,n=t.position,a=curveUtil.quadraticAt,c=curveUtil.quadraticDerivativeAt;n[0]=a(e[0],o[0],i[0],r),n[1]=a(e[1],o[1],i[1],r);var f=c(e[0],o[0],i[0],r),l=c(e[1],o[1],i[1],r);t.rotation=-Math.atan2(l,f)-Math.PI/2,t.ignore=!1},effectLineProto.updateLayout=function(t,e){this.childAt(0).updateLayout(t,e);var i=t.getItemModel(e).getModel("effect");this._updateEffectAnimation(t,i,e)},zrUtil.inherits(EffectLine,graphic.Group);var _default=EffectLine;module.exports=_default;
//# sourceMappingURL=/sm/0a400e6e8d8e78bc98da8cbcbfb29422c82483fe45433ea69dcb56cd4611e427.map