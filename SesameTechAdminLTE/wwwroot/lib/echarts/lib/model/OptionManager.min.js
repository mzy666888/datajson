/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/model/OptionManager.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var zrUtil=require("zrender/lib/core/util"),modelUtil=require("../util/model"),ComponentModel=require("./Component"),each=zrUtil.each,clone=zrUtil.clone,map=zrUtil.map,merge=zrUtil.merge,QUERY_REG=/^(min|max)?(.+)$/;function OptionManager(i){this._api=i,this._timelineOptions=[],this._mediaList=[],this._mediaDefault,this._currentMediaIndices=[],this._optionBackup,this._newBaseOption}function parseRawOption(i,e,t){var n,a,o=[],r=[],s=i.timeline;if(i.baseOption&&(a=i.baseOption),(s||i.options)&&(a=a||{},o=(i.options||[]).slice()),i.media){a=a||{};var l=i.media;each(l,function(i){i&&i.option&&(i.query?r.push(i):n||(n=i))})}return a||(a=i),a.timeline||(a.timeline=s),each([a].concat(o).concat(zrUtil.map(r,function(i){return i.option})),function(i){each(e,function(e){e(i,t)})}),{baseOption:a,timelineOptions:o,mediaDefault:n,mediaList:r}}function applyMediaQuery(i,e,t){var n={width:e,height:t,aspectratio:e/t},a=!0;return zrUtil.each(i,function(i,e){var t=e.match(QUERY_REG);if(t&&t[1]&&t[2]){var o=t[1],r=t[2].toLowerCase();compare(n[r],i,o)||(a=!1)}}),a}function compare(i,e,t){return"min"===t?i>=e:"max"===t?i<=e:i===e}function indicesEquals(i,e){return i.join(",")===e.join(",")}function mergeOption(i,e){each(e=e||{},function(e,t){if(null!=e){var n=i[t];if(ComponentModel.hasClass(t)){e=modelUtil.normalizeToArray(e),n=modelUtil.normalizeToArray(n);var a=modelUtil.mappingToExists(n,e);i[t]=map(a,function(i){return i.option&&i.exist?merge(i.exist,i.option,!0):i.exist||i.option})}else i[t]=merge(n,e,!0)}})}OptionManager.prototype={constructor:OptionManager,setOption:function(i,e){i&&zrUtil.each(modelUtil.normalizeToArray(i.series),function(i){i&&i.data&&zrUtil.isTypedArray(i.data)&&zrUtil.setAsPrimitive(i.data)}),i=clone(i);var t=this._optionBackup,n=parseRawOption.call(this,i,e,!t);this._newBaseOption=n.baseOption,t?(mergeOption(t.baseOption,n.baseOption),n.timelineOptions.length&&(t.timelineOptions=n.timelineOptions),n.mediaList.length&&(t.mediaList=n.mediaList),n.mediaDefault&&(t.mediaDefault=n.mediaDefault)):this._optionBackup=n},mountOption:function(i){var e=this._optionBackup;return this._timelineOptions=map(e.timelineOptions,clone),this._mediaList=map(e.mediaList,clone),this._mediaDefault=clone(e.mediaDefault),this._currentMediaIndices=[],clone(i?e.baseOption:this._newBaseOption)},getTimelineOption:function(i){var e,t=this._timelineOptions;if(t.length){var n=i.getComponent("timeline");n&&(e=clone(t[n.getCurrentIndex()],!0))}return e},getMediaOption:function(i){var e=this._api.getWidth(),t=this._api.getHeight(),n=this._mediaList,a=this._mediaDefault,o=[],r=[];if(!n.length&&!a)return r;for(var s=0,l=n.length;s<l;s++)applyMediaQuery(n[s].query,e,t)&&o.push(s);return!o.length&&a&&(o=[-1]),o.length&&!indicesEquals(o,this._currentMediaIndices)&&(r=map(o,function(i){return clone(-1===i?a.option:n[i].option)})),this._currentMediaIndices=o,r}};var _default=OptionManager;module.exports=_default;
//# sourceMappingURL=/sm/cce14623f865352e3dd2774586edf8d2bd35089b1a499c99610c72d176c67b09.map