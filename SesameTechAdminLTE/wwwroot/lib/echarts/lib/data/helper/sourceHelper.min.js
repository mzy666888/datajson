/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/data/helper/sourceHelper.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var _config=require("../../config"),__DEV__=_config.__DEV__,_model=require("../../util/model"),makeInner=_model.makeInner,getDataItemValue=_model.getDataItemValue,_referHelper=require("../../model/referHelper"),getCoordSysDefineBySeries=_referHelper.getCoordSysDefineBySeries,_util=require("zrender/lib/core/util"),createHashMap=_util.createHashMap,each=_util.each,map=_util.map,isArray=_util.isArray,isString=_util.isString,isObject=_util.isObject,isTypedArray=_util.isTypedArray,isArrayLike=_util.isArrayLike,extend=_util.extend,assert=_util.assert,Source=require("../Source"),_sourceType=require("./sourceType"),SOURCE_FORMAT_ORIGINAL=_sourceType.SOURCE_FORMAT_ORIGINAL,SOURCE_FORMAT_ARRAY_ROWS=_sourceType.SOURCE_FORMAT_ARRAY_ROWS,SOURCE_FORMAT_OBJECT_ROWS=_sourceType.SOURCE_FORMAT_OBJECT_ROWS,SOURCE_FORMAT_KEYED_COLUMNS=_sourceType.SOURCE_FORMAT_KEYED_COLUMNS,SOURCE_FORMAT_UNKNOWN=_sourceType.SOURCE_FORMAT_UNKNOWN,SOURCE_FORMAT_TYPED_ARRAY=_sourceType.SOURCE_FORMAT_TYPED_ARRAY,SERIES_LAYOUT_BY_ROW=_sourceType.SERIES_LAYOUT_BY_ROW,inner=makeInner();function detectSourceFormat(e){var r=e.option.source,n=SOURCE_FORMAT_UNKNOWN;if(isTypedArray(r))n=SOURCE_FORMAT_TYPED_ARRAY;else if(isArray(r)){0===r.length&&(n=SOURCE_FORMAT_ARRAY_ROWS);for(var t=0,i=r.length;t<i;t++){var a=r[t];if(null!=a){if(isArray(a)){n=SOURCE_FORMAT_ARRAY_ROWS;break}if(isObject(a)){n=SOURCE_FORMAT_OBJECT_ROWS;break}}}}else if(isObject(r)){for(var s in r)if(r.hasOwnProperty(s)&&isArrayLike(r[s])){n=SOURCE_FORMAT_KEYED_COLUMNS;break}}else if(null!=r)throw new Error("Invalid data");inner(e).sourceFormat=n}function getSource(e){return inner(e).source}function resetSourceDefaulter(e){inner(e).datasetMap=createHashMap()}function prepareSource(e){var r=e.option,n=r.data,t=isTypedArray(n)?SOURCE_FORMAT_TYPED_ARRAY:SOURCE_FORMAT_ORIGINAL,i=!1,a=r.seriesLayoutBy,s=r.sourceHeader,o=r.dimensions,u=getDatasetModel(e);if(u){var l=u.option;n=l.source,t=inner(u).sourceFormat,i=!0,a=a||l.seriesLayoutBy,null==s&&(s=l.sourceHeader),o=o||l.dimensions}var _=completeBySourceData(n,t,a,s,o),c=r.encode;!c&&u&&(c=makeDefaultEncode(e,u,n,t,a,_)),inner(e).source=new Source({data:n,fromDataset:i,seriesLayoutBy:a,sourceFormat:t,dimensionsDefine:_.dimensionsDefine,startIndex:_.startIndex,dimensionsDetectCount:_.dimensionsDetectCount,encodeDefine:c})}function completeBySourceData(e,r,n,t,i){if(!e)return{dimensionsDefine:normalizeDimensionsDefine(i)};var a,s,o,u;if(r===SOURCE_FORMAT_ARRAY_ROWS)"auto"===t||null==t?arrayRowsTravelFirst(function(e){null!=e&&"-"!==e&&(isString(e)?null==s&&(s=1):s=0)},n,e,10):s=t?1:0,i||1!==s||(i=[],arrayRowsTravelFirst(function(e,r){i[r]=null!=e?e:""},n,e)),a=i?i.length:n===SERIES_LAYOUT_BY_ROW?e.length:e[0]?e[0].length:null;else if(r===SOURCE_FORMAT_OBJECT_ROWS)i||(i=objectRowsCollectDimensions(e),o=!0);else if(r===SOURCE_FORMAT_KEYED_COLUMNS)i||(i=[],o=!0,each(e,function(e,r){i.push(r)}));else if(r===SOURCE_FORMAT_ORIGINAL){var l=getDataItemValue(e[0]);a=isArray(l)&&l.length||1}return o&&each(i,function(e,r){"name"===(isObject(e)?e.name:e)&&(u=r)}),{startIndex:s,dimensionsDefine:normalizeDimensionsDefine(i),dimensionsDetectCount:a,potentialNameDimIndex:u}}function normalizeDimensionsDefine(e){if(e){var r=createHashMap();return map(e,function(e,n){if(null==(e=extend({},isObject(e)?e:{name:e})).name)return e;e.name+="",null==e.displayName&&(e.displayName=e.name);var t=r.get(e.name);return t?e.name+="-"+t.count++:r.set(e.name,{count:1}),e})}}function arrayRowsTravelFirst(e,r,n,t){if(null==t&&(t=1/0),r===SERIES_LAYOUT_BY_ROW)for(var i=0;i<n.length&&i<t;i++)e(n[i]?n[i][0]:null,i);else{var a=n[0]||[];for(i=0;i<a.length&&i<t;i++)e(a[i],i)}}function objectRowsCollectDimensions(e){for(var r,n=0;n<e.length&&!(r=e[n++]););if(r){var t=[];return each(r,function(e,r){t.push(r)}),t}}function makeDefaultEncode(e,r,n,t,i,a){var s=getCoordSysDefineBySeries(e),o={},u=[],l=[],_=e.subType,c=createHashMap(["pie","map","funnel"]),O=createHashMap(["line","bar","pictorialBar","scatter","effectScatter","candlestick","boxplot"]);if(s&&null!=O.get(_)){var R=e.ecModel,f=inner(R).datasetMap,S=r.uid+"_"+i,d=f.get(S)||f.set(S,{categoryWayDim:1,valueWayDim:0});each(s.coordSysDims,function(e){if(null==s.firstCategoryDimIndex){var r=d.valueWayDim++;o[e]=r,l.push(r)}else if(s.categoryAxisMap.get(e))o[e]=0,u.push(0);else{r=d.categoryWayDim++;o[e]=r,l.push(r)}})}else if(null!=c.get(_)){for(var m,A=0;A<5&&null==m;A++)doGuessOrdinal(n,t,i,a.dimensionsDefine,a.startIndex,A)||(m=A);if(null!=m){o.value=m;var p=a.potentialNameDimIndex||Math.max(m-1,0);l.push(p),u.push(p)}}return u.length&&(o.itemName=u),l.length&&(o.seriesName=l),o}function getDatasetModel(e){var r=e.option;if(!r.data)return e.ecModel.getComponent("dataset",r.datasetIndex||0)}function guessOrdinal(e,r){return doGuessOrdinal(e.data,e.sourceFormat,e.seriesLayoutBy,e.dimensionsDefine,e.startIndex,r)}function doGuessOrdinal(e,r,n,t,i,a){var s,o;if(isTypedArray(e))return!1;if(t&&(o=t[a],o=isObject(o)?o.name:o),r===SOURCE_FORMAT_ARRAY_ROWS)if(n===SERIES_LAYOUT_BY_ROW){for(var u=e[a],l=0;l<(u||[]).length&&l<5;l++)if(null!=(s=R(u[i+l])))return s}else for(l=0;l<e.length&&l<5;l++){var _=e[i+l];if(_&&null!=(s=R(_[a])))return s}else if(r===SOURCE_FORMAT_OBJECT_ROWS){if(!o)return;for(l=0;l<e.length&&l<5;l++){if((c=e[l])&&null!=(s=R(c[o])))return s}}else if(r===SOURCE_FORMAT_KEYED_COLUMNS){if(!o)return;if(!(u=e[o])||isTypedArray(u))return!1;for(l=0;l<u.length&&l<5;l++)if(null!=(s=R(u[l])))return s}else if(r===SOURCE_FORMAT_ORIGINAL)for(l=0;l<e.length&&l<5;l++){var c=e[l],O=getDataItemValue(c);if(!isArray(O))return!1;if(null!=(s=R(O[a])))return s}function R(e){return(null==e||!isFinite(e)||""===e)&&(!(!isString(e)||"-"===e)||void 0)}return!1}exports.detectSourceFormat=detectSourceFormat,exports.getSource=getSource,exports.resetSourceDefaulter=resetSourceDefaulter,exports.prepareSource=prepareSource,exports.guessOrdinal=guessOrdinal;
//# sourceMappingURL=/sm/ab425c434e1f7b37b2c28d0aba9f6b294096e32c1b9c9cb27af47d4e4b56a0cf.map