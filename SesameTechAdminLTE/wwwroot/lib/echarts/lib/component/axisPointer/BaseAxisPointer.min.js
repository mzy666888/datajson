/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/component/axisPointer/BaseAxisPointer.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var zrUtil=require("zrender/lib/core/util"),clazzUtil=require("../../util/clazz"),graphic=require("../../util/graphic"),axisPointerModelHelper=require("./modelHelper"),eventTool=require("zrender/lib/core/event"),throttleUtil=require("../../util/throttle"),_model=require("../../util/model"),makeInner=_model.makeInner,inner=makeInner(),clone=zrUtil.clone,bind=zrUtil.bind;function BaseAxisPointer(){}function updateProps(e,t,i,a){propsEqual(inner(i).lastProp,a)||(inner(i).lastProp=a,t?graphic.updateProps(i,a,e):(i.stopAnimation(),i.attr(a)))}function propsEqual(e,t){if(zrUtil.isObject(e)&&zrUtil.isObject(t)){var i=!0;return zrUtil.each(t,function(t,a){i=i&&propsEqual(e[a],t)}),!!i}return e===t}function updateLabelShowHide(e,t){e[t.get("label.show")?"show":"hide"]()}function getHandleTransProps(e){return{position:e.position.slice(),rotation:e.rotation||0}}function updateMandatoryProps(e,t,i){var a=t.get("z"),n=t.get("zlevel");e&&e.traverse(function(e){"group"!==e.type&&(null!=a&&(e.z=a),null!=n&&(e.zlevel=n),e.silent=i)})}BaseAxisPointer.prototype={_group:null,_lastGraphicKey:null,_handle:null,_dragging:!1,_lastValue:null,_lastStatus:null,_payloadInfo:null,animationThreshold:15,render:function(e,t,i,a){var n=t.get("value"),r=t.get("status");if(this._axisModel=e,this._axisPointerModel=t,this._api=i,a||this._lastValue!==n||this._lastStatus!==r){this._lastValue=n,this._lastStatus=r;var o=this._group,l=this._handle;if(!r||"hide"===r)return o&&o.hide(),void(l&&l.hide());o&&o.show(),l&&l.show();var s={};this.makeElOption(s,n,e,t,i);var d=s.graphicKey;d!==this._lastGraphicKey&&this.clear(i),this._lastGraphicKey=d;var h=this._moveAnimation=this.determineAnimation(e,t);if(o){var u=zrUtil.curry(updateProps,t,h);this.updatePointerEl(o,s,u,t),this.updateLabelEl(o,s,u,t)}else o=this._group=new graphic.Group,this.createPointerEl(o,s,e,t),this.createLabelEl(o,s,e,t),i.getZr().add(o);updateMandatoryProps(o,t,!0),this._renderHandle(n)}},remove:function(e){this.clear(e)},dispose:function(e){this.clear(e)},determineAnimation:function(e,t){var i=t.get("animation"),a=e.axis,n="category"===a.type,r=t.get("snap");if(!r&&!n)return!1;if("auto"===i||null==i){var o=this.animationThreshold;if(n&&a.getBandWidth()>o)return!0;if(r){var l=axisPointerModelHelper.getAxisInfo(e).seriesDataCount,s=a.getExtent();return Math.abs(s[0]-s[1])/l>o}return!1}return!0===i},makeElOption:function(e,t,i,a,n){},createPointerEl:function(e,t,i,a){var n=t.pointer;if(n){var r=inner(e).pointerEl=new graphic[n.type](clone(t.pointer));e.add(r)}},createLabelEl:function(e,t,i,a){if(t.label){var n=inner(e).labelEl=new graphic.Rect(clone(t.label));e.add(n),updateLabelShowHide(n,a)}},updatePointerEl:function(e,t,i){var a=inner(e).pointerEl;a&&t.pointer&&(a.setStyle(t.pointer.style),i(a,{shape:t.pointer.shape}))},updateLabelEl:function(e,t,i,a){var n=inner(e).labelEl;n&&(n.setStyle(t.label.style),i(n,{shape:t.label.shape,position:t.label.position}),updateLabelShowHide(n,a))},_renderHandle:function(e){if(!this._dragging&&this.updateHandleTransform){var t,i=this._axisPointerModel,a=this._api.getZr(),n=this._handle,r=i.getModel("handle"),o=i.get("status");if(!r.get("show")||!o||"hide"===o)return n&&a.remove(n),void(this._handle=null);this._handle||(t=!0,n=this._handle=graphic.createIcon(r.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(e){eventTool.stop(e.event)},onmousedown:bind(this._onHandleDragMove,this,0,0),drift:bind(this._onHandleDragMove,this),ondragend:bind(this._onHandleDragEnd,this)}),a.add(n)),updateMandatoryProps(n,i,!1);n.setStyle(r.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var l=r.get("size");zrUtil.isArray(l)||(l=[l,l]),n.attr("scale",[l[0]/2,l[1]/2]),throttleUtil.createOrUpdate(this,"_doDispatchAxisPointer",r.get("throttle")||0,"fixRate"),this._moveHandleToValue(e,t)}},_moveHandleToValue:function(e,t){updateProps(this._axisPointerModel,!t&&this._moveAnimation,this._handle,getHandleTransProps(this.getHandleTransform(e,this._axisModel,this._axisPointerModel)))},_onHandleDragMove:function(e,t){var i=this._handle;if(i){this._dragging=!0;var a=this.updateHandleTransform(getHandleTransProps(i),[e,t],this._axisModel,this._axisPointerModel);this._payloadInfo=a,i.stopAnimation(),i.attr(getHandleTransProps(a)),inner(i).lastProp=null,this._doDispatchAxisPointer()}},_doDispatchAxisPointer:function(){if(this._handle){var e=this._payloadInfo,t=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:e.cursorPoint[0],y:e.cursorPoint[1],tooltipOption:e.tooltipOption,axesInfo:[{axisDim:t.axis.dim,axisIndex:t.componentIndex}]})}},_onHandleDragEnd:function(e){if(this._dragging=!1,this._handle){var t=this._axisPointerModel.get("value");this._moveHandleToValue(t),this._api.dispatchAction({type:"hideTip"})}},getHandleTransform:null,updateHandleTransform:null,clear:function(e){this._lastValue=null,this._lastStatus=null;var t=e.getZr(),i=this._group,a=this._handle;t&&i&&(this._lastGraphicKey=null,i&&t.remove(i),a&&t.remove(a),this._group=null,this._handle=null,this._payloadInfo=null)},doClear:function(){},buildLabel:function(e,t,i){return{x:e[i=i||0],y:e[1-i],width:t[i],height:t[1-i]}}},BaseAxisPointer.prototype.constructor=BaseAxisPointer,clazzUtil.enableClassExtend(BaseAxisPointer);var _default=BaseAxisPointer;module.exports=_default;
//# sourceMappingURL=/sm/094d3c2e5560a0e47977402a7209cb8716be6e7421cfc8ea43a117037e2d05e8.map