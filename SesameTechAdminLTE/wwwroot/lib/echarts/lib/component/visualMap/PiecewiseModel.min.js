/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/component/visualMap/PiecewiseModel.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var _config=require("../../config"),__DEV__=_config.__DEV__,zrUtil=require("zrender/lib/core/util"),VisualMapModel=require("./VisualMapModel"),VisualMapping=require("../../visual/VisualMapping"),visualDefault=require("../../visual/visualDefault"),_number=require("../../util/number"),reformIntervals=_number.reformIntervals,PiecewiseModel=VisualMapModel.extend({type:"visualMap.piecewise",defaultOption:{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieceList:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0,showLabel:null},optionUpdated:function(e,t){PiecewiseModel.superApply(this,"optionUpdated",arguments),this._pieceList=[],this.resetExtent();var i=this._mode=this._determineMode();resetMethods[this._mode].call(this),this._resetSelected(e,t);var s=this.option.categories;this.resetVisual(function(e,t){"categories"===i?(e.mappingMethod="category",e.categories=zrUtil.clone(s)):(e.dataExtent=this.getExtent(),e.mappingMethod="piecewise",e.pieceList=zrUtil.map(this._pieceList,function(e){e=zrUtil.clone(e);return"inRange"!==t&&(e.visual=null),e}))})},completeVisualOption:function(){var e=this.option,t={},i=VisualMapping.listVisualTypes(),s=this.isCategory();function a(e,t,i){return e&&e[t]&&(zrUtil.isObject(e[t])?e[t].hasOwnProperty(i):e[t]===i)}zrUtil.each(e.pieces,function(e){zrUtil.each(i,function(i){e.hasOwnProperty(i)&&(t[i]=1)})}),zrUtil.each(t,function(t,i){var n=0;zrUtil.each(this.stateList,function(t){n|=a(e,t,i)||a(e.target,t,i)},this),!n&&zrUtil.each(this.stateList,function(t){(e[t]||(e[t]={}))[i]=visualDefault.get(i,"inRange"===t?"active":"inactive",s)})},this),VisualMapModel.prototype.completeVisualOption.apply(this,arguments)},_resetSelected:function(e,t){var i=this.option,s=this._pieceList,a=(t?i:e).selected||{};if(i.selected=a,zrUtil.each(s,function(e,t){var i=this.getSelectedMapKey(e);a.hasOwnProperty(i)||(a[i]=!0)},this),"single"===i.selectedMode){var n=!1;zrUtil.each(s,function(e,t){var i=this.getSelectedMapKey(e);a[i]&&(n?a[i]=!1:n=!0)},this)}},getSelectedMapKey:function(e){return"categories"===this._mode?e.value+"":e.index+""},getPieceList:function(){return this._pieceList},_determineMode:function(){var e=this.option;return e.pieces&&e.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber"},setSelected:function(e){this.option.selected=zrUtil.clone(e)},getValueState:function(e){var t=VisualMapping.findPieceIndex(e,this._pieceList);return null!=t&&this.option.selected[this.getSelectedMapKey(this._pieceList[t])]?"inRange":"outOfRange"},findTargetDataIndices:function(e){var t=[];return this.eachTargetSeries(function(i){var s=[],a=i.getData();a.each(this.getDataDimension(a),function(t,i){VisualMapping.findPieceIndex(t,this._pieceList)===e&&s.push(i)},this),t.push({seriesId:i.id,dataIndex:s})},this),t},getRepresentValue:function(e){var t;if(this.isCategory())t=e.value;else if(null!=e.value)t=e.value;else{var i=e.interval||[];t=i[0]===-1/0&&i[1]===1/0?0:(i[0]+i[1])/2}return t},getVisualMeta:function(e){if(!this.isCategory()){var t=[],i=[],s=this,a=this._pieceList.slice();if(a.length){var n=a[0].interval[0];n!==-1/0&&a.unshift({interval:[-1/0,n]}),(n=a[a.length-1].interval[1])!==1/0&&a.push({interval:[n,1/0]})}else a.push({interval:[-1/0,1/0]});var r=-1/0;return zrUtil.each(a,function(e){var t=e.interval;t&&(t[0]>r&&l([r,t[0]],"outOfRange"),l(t.slice()),r=t[1])},this),{stops:t,outerColors:i}}function l(a,n){var r=s.getRepresentValue({interval:a});n||(n=s.getValueState(r));var l=e(r,n);a[0]===-1/0?i[0]=l:a[1]===1/0?i[1]=l:t.push({value:a[0],color:l},{value:a[1],color:l})}}}),resetMethods={splitNumber:function(){var e=this.option,t=this._pieceList,i=Math.min(e.precision,20),s=this.getExtent(),a=e.splitNumber;a=Math.max(parseInt(a,10),1),e.splitNumber=a;for(var n=(s[1]-s[0])/a;+n.toFixed(i)!==n&&i<5;)i++;e.precision=i,n=+n.toFixed(i);var r=0;e.minOpen&&t.push({index:r++,interval:[-1/0,s[0]],close:[0,0]});for(var l=s[0],o=r+a;r<o;l+=n){var u=r===a-1?s[1]:l+n;t.push({index:r++,interval:[l,u],close:[1,1]})}e.maxOpen&&t.push({index:r++,interval:[s[1],1/0],close:[0,0]}),reformIntervals(t),zrUtil.each(t,function(e){e.text=this.formatValueText(e.interval)},this)},categories:function(){var e=this.option;zrUtil.each(e.categories,function(e){this._pieceList.push({text:this.formatValueText(e,!0),value:e})},this),normalizeReverse(e,this._pieceList)},pieces:function(){var e=this.option,t=this._pieceList;zrUtil.each(e.pieces,function(e,i){zrUtil.isObject(e)||(e={value:e});var s={text:"",index:i};if(null!=e.label&&(s.text=e.label),e.hasOwnProperty("value")){var a=s.value=e.value;s.interval=[a,a],s.close=[1,1]}else{for(var n=s.interval=[],r=s.close=[0,0],l=[1,0,1],o=[-1/0,1/0],u=[],c=0;c<2;c++){for(var p=[["gte","gt","min"],["lte","lt","max"]][c],h=0;h<3&&null==n[c];h++)n[c]=e[p[h]],r[c]=l[h],u[c]=2===h;null==n[c]&&(n[c]=o[c])}u[0]&&n[1]===1/0&&(r[0]=0),u[1]&&n[0]===-1/0&&(r[1]=0),n[0]===n[1]&&r[0]&&r[1]&&(s.value=n[0])}s.visual=VisualMapping.retrieveVisuals(e),t.push(s)},this),normalizeReverse(e,t),reformIntervals(t),zrUtil.each(t,function(e){var t=e.close,i=[["<","≤"][t[1]],[">","≥"][t[0]]];e.text=e.text||this.formatValueText(null!=e.value?e.value:e.interval,!1,i)},this)}};function normalizeReverse(e,t){var i=e.inverse;("vertical"===e.orient?!i:i)&&t.reverse()}var _default=PiecewiseModel;module.exports=_default;
//# sourceMappingURL=/sm/91fecf1782707ebc7743aafdfc181dc99941d883269365d57f9732ef7da7df1b.map