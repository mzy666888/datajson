/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/component/marker/MarkLineView.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var zrUtil=require("zrender/lib/core/util"),List=require("../../data/List"),numberUtil=require("../../util/number"),markerHelper=require("./markerHelper"),LineDraw=require("../../chart/helper/LineDraw"),MarkerView=require("./MarkerView"),_dataStackHelper=require("../../data/helper/dataStackHelper"),getStackedDimension=_dataStackHelper.getStackedDimension,markLineTransform=function(e,t,r,i){var a=e.getData(),n=i.type;if(!zrUtil.isArray(i)&&("min"===n||"max"===n||"average"===n||"median"===n||null!=i.xAxis||null!=i.yAxis)){var o,l;if(null!=i.yAxis||null!=i.xAxis)o=t.getAxis(null!=i.yAxis?"y":"x"),l=zrUtil.retrieve(i.yAxis,i.xAxis);else{var s=markerHelper.getAxisInfo(i,a,t,e);o=s.valueAxis;var u=getStackedDimension(a,s.valueDataDim);l=markerHelper.numCalculate(a,u,n)}var m="x"===o.dim?0:1,d=1-m,c=zrUtil.clone(i),g={};c.type=null,c.coord=[],g.coord=[],c.coord[d]=-1/0,g.coord[d]=1/0;var y=r.get("precision");y>=0&&"number"==typeof l&&(l=+l.toFixed(Math.min(y,20))),c.coord[m]=g.coord[m]=l,i=[c,g,{type:n,valueIndex:i.valueIndex,value:l}]}return(i=[markerHelper.dataTransform(e,i[0]),markerHelper.dataTransform(e,i[1]),zrUtil.extend({},i[2])])[2].type=i[2].type||"",zrUtil.merge(i[2],i[0]),zrUtil.merge(i[2],i[1]),i};function isInifinity(e){return!isNaN(e)&&!isFinite(e)}function ifMarkLineHasOnlyDim(e,t,r,i){var a=1-e,n=i.dimensions[e];return isInifinity(t[a])&&isInifinity(r[a])&&t[e]===r[e]&&i.getAxis(n).containData(t[e])}function markLineFilter(e,t){if("cartesian2d"===e.type){var r=t[0].coord,i=t[1].coord;if(r&&i&&(ifMarkLineHasOnlyDim(1,r,i,e)||ifMarkLineHasOnlyDim(0,r,i,e)))return!0}return markerHelper.dataFilter(e,t[0])&&markerHelper.dataFilter(e,t[1])}function updateSingleMarkerEndLayout(e,t,r,i,a){var n,o=i.coordinateSystem,l=e.getItemModel(t),s=numberUtil.parsePercent(l.get("x"),a.getWidth()),u=numberUtil.parsePercent(l.get("y"),a.getHeight());if(isNaN(s)||isNaN(u)){if(i.getMarkerPosition)n=i.getMarkerPosition(e.getValues(e.dimensions,t));else{var m=o.dimensions,d=e.get(m[0],t),c=e.get(m[1],t);n=o.dataToPoint([d,c])}if("cartesian2d"===o.type){var g=o.getAxis("x"),y=o.getAxis("y");m=o.dimensions;isInifinity(e.get(m[0],t))?n[0]=g.toGlobalCoord(g.getExtent()[r?0:1]):isInifinity(e.get(m[1],t))&&(n[1]=y.toGlobalCoord(y.getExtent()[r?0:1]))}isNaN(s)||(n[0]=s),isNaN(u)||(n[1]=u)}else n=[s,u];e.setItemLayout(t,n)}var _default=MarkerView.extend({type:"markLine",updateTransform:function(e,t,r){t.eachSeries(function(e){var t=e.markLineModel;if(t){var i=t.getData(),a=t.__from,n=t.__to;a.each(function(t){updateSingleMarkerEndLayout(a,t,!0,e,r),updateSingleMarkerEndLayout(n,t,!1,e,r)}),i.each(function(e){i.setItemLayout(e,[a.getItemLayout(e),n.getItemLayout(e)])}),this.markerGroupMap.get(e.id).updateLayout()}},this)},renderSeries:function(e,t,r,i){var a=e.coordinateSystem,n=e.id,o=e.getData(),l=this.markerGroupMap,s=l.get(n)||l.set(n,new LineDraw);this.group.add(s.group);var u=createList(a,e,t),m=u.from,d=u.to,c=u.line;t.__from=m,t.__to=d,t.setData(c);var g=t.get("symbol"),y=t.get("symbolSize");function f(t,r,a){var n=t.getItemModel(r);updateSingleMarkerEndLayout(t,r,a,e,i),t.setItemVisual(r,{symbolSize:n.get("symbolSize")||y[a?0:1],symbol:n.get("symbol",!0)||g[a?0:1],color:n.get("itemStyle.color")||o.getVisual("color")})}zrUtil.isArray(g)||(g=[g,g]),"number"==typeof y&&(y=[y,y]),u.from.each(function(e){f(m,e,!0),f(d,e,!1)}),c.each(function(e){var t=c.getItemModel(e).get("lineStyle.color");c.setItemVisual(e,{color:t||m.getItemVisual(e,"color")}),c.setItemLayout(e,[m.getItemLayout(e),d.getItemLayout(e)]),c.setItemVisual(e,{fromSymbolSize:m.getItemVisual(e,"symbolSize"),fromSymbol:m.getItemVisual(e,"symbol"),toSymbolSize:d.getItemVisual(e,"symbolSize"),toSymbol:d.getItemVisual(e,"symbol")})}),s.updateData(c),u.line.eachItemGraphicEl(function(e,r){e.traverse(function(e){e.dataModel=t})}),s.__keep=!0,s.group.silent=t.get("silent")||e.get("silent")}});function createList(e,t,r){var i;i=e?zrUtil.map(e&&e.dimensions,function(e){var r=t.getData().getDimensionInfo(t.getData().mapDimension(e))||{};return zrUtil.defaults({name:e},r)}):[{name:"value",type:"float"}];var a=new List(i,r),n=new List(i,r),o=new List([],r),l=zrUtil.map(r.get("data"),zrUtil.curry(markLineTransform,t,e,r));e&&(l=zrUtil.filter(l,zrUtil.curry(markLineFilter,e)));var s=e?markerHelper.dimValueGetter:function(e){return e.value};return a.initData(zrUtil.map(l,function(e){return e[0]}),null,s),n.initData(zrUtil.map(l,function(e){return e[1]}),null,s),o.initData(zrUtil.map(l,function(e){return e[2]})),o.hasItemOption=!0,{from:a,to:n,line:o}}module.exports=_default;
//# sourceMappingURL=/sm/1beae862fb123f1bb301e941f622dc6cea8e35fdc62e7853d88d1b119e6cd6c5.map