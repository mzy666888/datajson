/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/component/dataZoom/AxisProxy.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var zrUtil=require("zrender/lib/core/util"),numberUtil=require("../../util/number"),helper=require("./helper"),sliderMove=require("../helper/sliderMove"),each=zrUtil.each,asc=numberUtil.asc,AxisProxy=function(e,t,i,n){this._dimName=e,this._axisIndex=t,this._valueWindow,this._percentWindow,this._dataExtent,this._minMaxSpan,this.ecModel=n,this._dataZoomModel=i};function calculateDataExtent(e,t,i){var n=[1/0,-1/0];return each(i,function(e){var i=e.getData();i&&each(i.mapDimension(t,!0),function(e){var t=i.getApproximateExtent(e);t[0]<n[0]&&(n[0]=t[0]),t[1]>n[1]&&(n[1]=t[1])})}),n[1]<n[0]&&(n=[NaN,NaN]),fixExtentByAxis(e,n),n}function fixExtentByAxis(e,t){var i=e.getAxisModel(),n=i.getMin(!0),a="category"===i.get("type"),r=a&&i.getCategories().length;null!=n&&"dataMin"!==n&&"function"!=typeof n?t[0]=n:a&&(t[0]=r>0?0:NaN);var o=i.getMax(!0);return null!=o&&"dataMax"!==o&&"function"!=typeof o?t[1]=o:a&&(t[1]=r>0?r-1:NaN),i.get("scale",!0)||(t[0]>0&&(t[0]=0),t[1]<0&&(t[1]=0)),t}function setAxisModel(e,t){var i=e.getAxisModel(),n=e._percentWindow,a=e._valueWindow;if(n){var r=numberUtil.getPixelPrecision(a,[0,500]);r=Math.min(r,20);var o=t||0===n[0]&&100===n[1];i.setRange(o?null:+a[0].toFixed(r),o?null:+a[1].toFixed(r))}}function setMinMaxSpan(e){var t=e._minMaxSpan={},i=e._dataZoomModel,n=e._dataExtent;each(["min","max"],function(a){var r=i.get(a+"Span"),o=i.get(a+"ValueSpan");null!=o&&(o=e.getAxisModel().axis.scale.parse(o)),null!=o?r=numberUtil.linearMap(n[0]+o,n,[0,100],!0):null!=r&&(o=numberUtil.linearMap(r,[0,100],n,!0)-n[0]),t[a+"Span"]=r,t[a+"ValueSpan"]=o})}AxisProxy.prototype={constructor:AxisProxy,hostedBy:function(e){return this._dataZoomModel===e},getDataValueWindow:function(){return this._valueWindow.slice()},getDataPercentWindow:function(){return this._percentWindow.slice()},getTargetSeriesModels:function(){var e=[],t=this.ecModel;return t.eachSeries(function(i){if(helper.isCoordSupported(i.get("coordinateSystem"))){var n=this._dimName,a=t.queryComponents({mainType:n+"Axis",index:i.get(n+"AxisIndex"),id:i.get(n+"AxisId")})[0];this._axisIndex===(a&&a.componentIndex)&&e.push(i)}},this),e},getAxisModel:function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},getOtherAxisModel:function(){var e,t,i,n=this._dimName,a=this.ecModel,r=this.getAxisModel();return"x"===n||"y"===n?(t="gridIndex",e="x"===n?"y":"x"):(t="polarIndex",e="angle"===n?"radius":"angle"),a.eachComponent(e+"Axis",function(e){(e.get(t)||0)===(r.get(t)||0)&&(i=e)}),i},getMinMaxSpan:function(){return zrUtil.clone(this._minMaxSpan)},calculateDataWindow:function(e){var t,i=this._dataExtent,n=this.getAxisModel().axis.scale,a=this._dataZoomModel.getRangePropMode(),r=[0,100],o=[],s=[];each(["start","end"],function(l,u){var d=e[l],c=e[l+"Value"];"percent"===a[u]?(null==d&&(d=r[u]),c=n.parse(numberUtil.linearMap(d,r,i))):(t=!0,c=null==c?i[u]:n.parse(c),d=numberUtil.linearMap(c,i,r)),s[u]=c,o[u]=d}),asc(s),asc(o);var l=this._minMaxSpan;function u(e,t,i,a,r){var o=r?"Span":"ValueSpan";sliderMove(0,e,i,"all",l["min"+o],l["max"+o]);for(var s=0;s<2;s++)t[s]=numberUtil.linearMap(e[s],i,a,!0),r&&(t[s]=n.parse(t[s]))}return t?u(s,o,i,r,!1):u(o,s,r,i,!0),{valueWindow:s,percentWindow:o}},reset:function(e){if(e===this._dataZoomModel){var t=this.getTargetSeriesModels();this._dataExtent=calculateDataExtent(this,this._dimName,t),setMinMaxSpan(this);var i=this.calculateDataWindow(e.settledOption);this._valueWindow=i.valueWindow,this._percentWindow=i.percentWindow,setAxisModel(this)}},restore:function(e){e===this._dataZoomModel&&(this._valueWindow=this._percentWindow=null,setAxisModel(this,!0))},filterData:function(e,t){if(e===this._dataZoomModel){var i=this._dimName,n=this.getTargetSeriesModels(),a=e.get("filterMode"),r=this._valueWindow;"none"!==a&&each(n,function(e){var t=e.getData(),n=t.mapDimension(i,!0);n.length&&("weakFilter"===a?t.filterSelf(function(e){for(var i,a,o,s=0;s<n.length;s++){var l=t.get(n[s],e),u=!isNaN(l),d=l<r[0],c=l>r[1];if(u&&!d&&!c)return!0;u&&(o=!0),d&&(i=!0),c&&(a=!0)}return o&&i&&a}):each(n,function(i){if("empty"===a)e.setData(t=t.map(i,function(e){return function(e){return e>=r[0]&&e<=r[1]}(e)?e:NaN}));else{var n={};n[i]=r,t.selectRange(n)}}),each(n,function(e){t.setApproximateExtent(r,e)}))})}}};var _default=AxisProxy;module.exports=_default;
//# sourceMappingURL=/sm/e4079ceb18e2fc37ab82e829186cb6ee339e28b40854e3659428b17349b5ad0f.map