/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/component/axis/AxisBuilder.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var _util=require("zrender/lib/core/util"),retrieve=_util.retrieve,defaults=_util.defaults,extend=_util.extend,each=_util.each,formatUtil=require("../../util/format"),graphic=require("../../util/graphic"),Model=require("../../model/Model"),_number=require("../../util/number"),isRadianAroundZero=_number.isRadianAroundZero,remRadian=_number.remRadian,_symbol=require("../../util/symbol"),createSymbol=_symbol.createSymbol,matrixUtil=require("zrender/lib/core/matrix"),_vector=require("zrender/lib/core/vector"),v2ApplyTransform=_vector.applyTransform,_axisHelper=require("../../coord/axisHelper"),shouldShowAllLabels=_axisHelper.shouldShowAllLabels,PI=Math.PI,AxisBuilder=function(e,t){this.opt=t,this.axisModel=e,defaults(t,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0}),this.group=new graphic.Group;var i=new graphic.Group({position:t.position.slice(),rotation:t.rotation});i.updateTransform(),this._transform=i.transform,this._dumbGroup=i};AxisBuilder.prototype={constructor:AxisBuilder,hasBuilder:function(e){return!!builders[e]},add:function(e){builders[e].call(this)},getGroup:function(){return this.group}};var builders={axisLine:function(){var e=this.opt,t=this.axisModel;if(t.get("axisLine.show")){var i=this.axisModel.axis.getExtent(),a=this._transform,r=[i[0],0],n=[i[1],0];a&&(v2ApplyTransform(r,r,a),v2ApplyTransform(n,n,a));var o=extend({lineCap:"round"},t.getModel("axisLine.lineStyle").getLineStyle());this.group.add(new graphic.Line({anid:"line",subPixelOptimize:!0,shape:{x1:r[0],y1:r[1],x2:n[0],y2:n[1]},style:o,strokeContainThreshold:e.strokeContainThreshold||5,silent:!0,z2:1}));var l=t.get("axisLine.symbol"),s=t.get("axisLine.symbolSize"),u=t.get("axisLine.symbolOffset")||0;if("number"==typeof u&&(u=[u,u]),null!=l){"string"==typeof l&&(l=[l,l]),"string"!=typeof s&&"number"!=typeof s||(s=[s,s]);var d=s[0],g=s[1];each([{rotate:e.rotation+Math.PI/2,offset:u[0],r:0},{rotate:e.rotation-Math.PI/2,offset:u[1],r:Math.sqrt((r[0]-n[0])*(r[0]-n[0])+(r[1]-n[1])*(r[1]-n[1]))}],function(t,i){if("none"!==l[i]&&null!=l[i]){var a=createSymbol(l[i],-d/2,-g/2,d,g,o.stroke,!0),n=t.r+t.offset,s=[r[0]+n*Math.cos(e.rotation),r[1]-n*Math.sin(e.rotation)];a.attr({rotation:t.rotate,position:s,silent:!0,z2:11}),this.group.add(a)}},this)}}},axisTickLabel:function(){var e=this.axisModel,t=this.opt,i=buildAxisTick(this,e,t);fixMinMaxLabelShow(e,buildAxisLabel(this,e,t),i)},axisName:function(){var e=this.opt,t=this.axisModel,i=retrieve(e.axisName,t.get("name"));if(i){var a,r,n=t.get("nameLocation"),o=e.nameDirection,l=t.getModel("nameTextStyle"),s=t.get("nameGap")||0,u=this.axisModel.axis.getExtent(),d=u[0]>u[1]?-1:1,g=["start"===n?u[0]-d*s:"end"===n?u[1]+d*s:(u[0]+u[1])/2,isNameLocationCenter(n)?e.labelOffset+o*s:0],x=t.get("nameRotate");null!=x&&(x=x*PI/180),isNameLocationCenter(n)?a=innerTextLayout(e.rotation,null!=x?x:e.rotation,o):(a=endTextLayout(e,n,x||0,u),null!=(r=e.axisNameAvailableWidth)&&(r=Math.abs(r/Math.sin(a.rotation)),!isFinite(r)&&(r=null)));var c=l.getFont(),m=t.get("nameTruncate",!0)||{},p=m.ellipsis,h=retrieve(e.nameTruncateMaxWidth,m.maxWidth,r),f=null!=p&&null!=h?formatUtil.truncateText(i,h,c,p,{minChar:2,placeholder:m.placeholder}):i,b=t.get("tooltip",!0),v=t.mainType,y={componentType:v,name:i,$vars:["name"]};y[v+"Index"]=t.componentIndex;var T=new graphic.Text({anid:"name",__fullText:i,__truncatedText:f,position:g,rotation:a.rotation,silent:isLabelSilent(t),z2:1,tooltip:b&&b.show?extend({content:i,formatter:function(){return i},formatterParams:y},b):null});graphic.setTextStyle(T.style,l,{text:f,textFont:c,textFill:l.getTextColor()||t.get("axisLine.lineStyle.color"),textAlign:l.get("align")||a.textAlign,textVerticalAlign:l.get("verticalAlign")||a.textVerticalAlign}),t.get("triggerEvent")&&(T.eventData=makeAxisEventDataBase(t),T.eventData.targetType="axisName",T.eventData.name=i),this._dumbGroup.add(T),T.updateTransform(),this.group.add(T),T.decomposeTransform()}}},makeAxisEventDataBase=AxisBuilder.makeAxisEventDataBase=function(e){var t={componentType:e.mainType,componentIndex:e.componentIndex};return t[e.mainType+"Index"]=e.componentIndex,t},innerTextLayout=AxisBuilder.innerTextLayout=function(e,t,i){var a,r,n=remRadian(t-e);return isRadianAroundZero(n)?(r=i>0?"top":"bottom",a="center"):isRadianAroundZero(n-PI)?(r=i>0?"bottom":"top",a="center"):(r="middle",a=n>0&&n<PI?i>0?"right":"left":i>0?"left":"right"),{rotation:n,textAlign:a,textVerticalAlign:r}};function endTextLayout(e,t,i,a){var r,n,o=remRadian(i-e.rotation),l=a[0]>a[1],s="start"===t&&!l||"start"!==t&&l;return isRadianAroundZero(o-PI/2)?(n=s?"bottom":"top",r="center"):isRadianAroundZero(o-1.5*PI)?(n=s?"top":"bottom",r="center"):(n="middle",r=o<1.5*PI&&o>PI/2?s?"left":"right":s?"right":"left"),{rotation:o,textAlign:r,textVerticalAlign:n}}var isLabelSilent=AxisBuilder.isLabelSilent=function(e){var t=e.get("tooltip");return e.get("silent")||!(e.get("triggerEvent")||t&&t.show)};function fixMinMaxLabelShow(e,t,i){if(!shouldShowAllLabels(e.axis)){var a=e.get("axisLabel.showMinLabel"),r=e.get("axisLabel.showMaxLabel");i=i||[];var n=(t=t||[])[0],o=t[1],l=t[t.length-1],s=t[t.length-2],u=i[0],d=i[1],g=i[i.length-1],x=i[i.length-2];!1===a?(ignoreEl(n),ignoreEl(u)):isTwoLabelOverlapped(n,o)&&(a?(ignoreEl(o),ignoreEl(d)):(ignoreEl(n),ignoreEl(u))),!1===r?(ignoreEl(l),ignoreEl(g)):isTwoLabelOverlapped(s,l)&&(r?(ignoreEl(s),ignoreEl(x)):(ignoreEl(l),ignoreEl(g)))}}function ignoreEl(e){e&&(e.ignore=!0)}function isTwoLabelOverlapped(e,t,i){var a=e&&e.getBoundingRect().clone(),r=t&&t.getBoundingRect().clone();if(a&&r){var n=matrixUtil.identity([]);return matrixUtil.rotate(n,n,-e.rotation),a.applyTransform(matrixUtil.mul([],n,e.getLocalTransform())),r.applyTransform(matrixUtil.mul([],n,t.getLocalTransform())),a.intersect(r)}}function isNameLocationCenter(e){return"middle"===e||"center"===e}function buildAxisTick(e,t,i){var a=t.axis;if(t.get("axisTick.show")&&!a.scale.isBlank()){for(var r=t.getModel("axisTick"),n=r.getModel("lineStyle"),o=r.get("length"),l=a.getTicksCoords(),s=[],u=[],d=e._transform,g=[],x=0;x<l.length;x++){var c=l[x].coord;s[0]=c,s[1]=0,u[0]=c,u[1]=i.tickDirection*o,d&&(v2ApplyTransform(s,s,d),v2ApplyTransform(u,u,d));var m=new graphic.Line({anid:"tick_"+l[x].tickValue,subPixelOptimize:!0,shape:{x1:s[0],y1:s[1],x2:u[0],y2:u[1]},style:defaults(n.getLineStyle(),{stroke:t.get("axisLine.lineStyle.color")}),z2:2,silent:!0});e.group.add(m),g.push(m)}return g}}function buildAxisLabel(e,t,i){var a=t.axis;if(retrieve(i.axisLabelShow,t.get("axisLabel.show"))&&!a.scale.isBlank()){var r=t.getModel("axisLabel"),n=r.get("margin"),o=a.getViewLabels(),l=(retrieve(i.labelRotate,r.get("rotate"))||0)*PI/180,s=innerTextLayout(i.rotation,l,i.labelDirection),u=t.getCategories&&t.getCategories(!0),d=[],g=isLabelSilent(t),x=t.get("triggerEvent");return each(o,function(o,l){var c=o.tickValue,m=o.formattedLabel,p=o.rawLabel,h=r;u&&u[c]&&u[c].textStyle&&(h=new Model(u[c].textStyle,r,t.ecModel));var f=h.getTextColor()||t.get("axisLine.lineStyle.color"),b=[a.dataToCoord(c),i.labelOffset+i.labelDirection*n],v=new graphic.Text({anid:"label_"+c,position:b,rotation:s.rotation,silent:g,z2:10});graphic.setTextStyle(v.style,h,{text:m,textAlign:h.getShallow("align",!0)||s.textAlign,textVerticalAlign:h.getShallow("verticalAlign",!0)||h.getShallow("baseline",!0)||s.textVerticalAlign,textFill:"function"==typeof f?f("category"===a.type?p:"value"===a.type?c+"":c,l):f}),x&&(v.eventData=makeAxisEventDataBase(t),v.eventData.targetType="axisLabel",v.eventData.value=p),e._dumbGroup.add(v),v.updateTransform(),d.push(v),e.group.add(v),v.decomposeTransform()}),d}}var _default=AxisBuilder;module.exports=_default;
//# sourceMappingURL=/sm/ca41ec6217729fb73b33d019155cf3a4b070a6d8bf8af92b2352ab14e023608e.map