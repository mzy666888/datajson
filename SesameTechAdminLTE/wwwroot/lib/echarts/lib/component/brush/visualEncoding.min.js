/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/component/brush/visualEncoding.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var echarts=require("../../echarts"),zrUtil=require("zrender/lib/core/util"),BoundingRect=require("zrender/lib/core/BoundingRect"),visualSolution=require("../../visual/visualSolution"),selector=require("./selector"),throttleUtil=require("../../util/throttle"),BrushTargetManager=require("../helper/BrushTargetManager"),STATE_LIST=["inBrush","outOfBrush"],DISPATCH_METHOD="__ecBrushSelect",DISPATCH_FLAG="__ecInBrushSelectEvent",PRIORITY_BRUSH=echarts.PRIORITY.VISUAL.BRUSH;function dispatchAction(e,r,t,n,i){if(i){var u=e.getZr();if(!u[DISPATCH_FLAG])u[DISPATCH_METHOD]||(u[DISPATCH_METHOD]=doDispatch),throttleUtil.createOrUpdate(u,DISPATCH_METHOD,t,r)(e,n)}}function doDispatch(e,r){if(!e.isDisposed()){var t=e.getZr();t[DISPATCH_FLAG]=!0,e.dispatchAction({type:"brushSelect",batch:r}),t[DISPATCH_FLAG]=!1}}function checkInRange(e,r,t,n){for(var i=0,u=r.length;i<u;i++){var a=r[i];if(e[a.brushType](n,t,a.selectors,a))return!0}}function getSelectorsByBrushType(e){var r=e.brushSelector;if(zrUtil.isString(r)){var t=[];return zrUtil.each(selector,function(e,n){t[n]=function(t,n,i,u){var a=n.getItemLayout(t);return e[r](a,i,u)}}),t}if(zrUtil.isFunction(r)){var n={};return zrUtil.each(selector,function(e,t){n[t]=r}),n}return r}function brushModelNotControll(e,r){var t=e.option.seriesIndex;return null!=t&&"all"!==t&&(zrUtil.isArray(t)?zrUtil.indexOf(t,r)<0:r!==t)}function bindSelector(e){var r=e.selectors={};return zrUtil.each(selector[e.brushType],function(t,n){r[n]=function(n){return t(n,r,e)}}),e}echarts.registerLayout(PRIORITY_BRUSH,function(e,r,t){e.eachComponent({mainType:"brush"},function(r){t&&"takeGlobalCursor"===t.type&&r.setBrushOption("brush"===t.key?t.brushOption:{brushType:!1}),(r.brushTargetManager=new BrushTargetManager(r.option,e)).setInputRanges(r.areas,e)})}),echarts.registerVisual(PRIORITY_BRUSH,function(e,r,t){var n,i,u=[];e.eachComponent({mainType:"brush"},function(r,t){var a={brushId:r.id,brushIndex:t,brushName:r.name,areas:zrUtil.clone(r.areas),selected:[]};u.push(a);var o=r.option,s=o.brushLink,c=[],l=[],h=[],f=0;t||(n=o.throttleType,i=o.throttleDelay);var g=zrUtil.map(r.areas,function(e){return bindSelector(zrUtil.defaults({boundingRect:boundingRectBuilders[e.brushType](e)},e))}),d=visualSolution.createVisualMappings(r.option,STATE_LIST,function(e){e.mappingMethod="fixed"});function p(e){return"all"===s||c[e]}function T(e){return!!e.length}zrUtil.isArray(s)&&zrUtil.each(s,function(e){c[e]=1}),e.eachSeries(function(t,n){var i=h[n]=[];"parallel"===t.subType?function(e,r){var t=e.coordinateSystem;f|=t.hasAxisBrushed(),p(r)&&t.eachActiveState(e.getData(),function(e,r){"active"===e&&(l[r]=1)})}(t,n):function(t,n,i){var u=getSelectorsByBrushType(t);if(!u||brushModelNotControll(r,n))return;if(zrUtil.each(g,function(n){u[n.brushType]&&r.brushTargetManager.controlSeries(n,t,e)&&i.push(n),f|=T(i)}),p(n)&&T(i)){var a=t.getData();a.each(function(e){checkInRange(u,i,a,e)&&(l[e]=1)})}}(t,n,i)}),e.eachSeries(function(e,r){var t={seriesId:e.id,seriesIndex:r,seriesName:e.name,dataIndex:[]};a.selected.push(t);var n=getSelectorsByBrushType(e),i=h[r],u=e.getData(),o=p(r)?function(e){return l[e]?(t.dataIndex.push(u.getRawIndex(e)),"inBrush"):"outOfBrush"}:function(e){return checkInRange(n,i,u,e)?(t.dataIndex.push(u.getRawIndex(e)),"inBrush"):"outOfBrush"};(p(r)?f:T(i))&&visualSolution.applyVisual(STATE_LIST,d,u,o)})}),dispatchAction(r,n,i,u,t)});var boundingRectBuilders={lineX:zrUtil.noop,lineY:zrUtil.noop,rect:function(e){return getBoundingRectFromMinMax(e.range)},polygon:function(e){for(var r,t=e.range,n=0,i=t.length;n<i;n++){r=r||[[1/0,-1/0],[1/0,-1/0]];var u=t[n];u[0]<r[0][0]&&(r[0][0]=u[0]),u[0]>r[0][1]&&(r[0][1]=u[0]),u[1]<r[1][0]&&(r[1][0]=u[1]),u[1]>r[1][1]&&(r[1][1]=u[1])}return r&&getBoundingRectFromMinMax(r)}};function getBoundingRectFromMinMax(e){return new BoundingRect(e[0][0],e[1][0],e[0][1]-e[0][0],e[1][1]-e[1][0])}
//# sourceMappingURL=/sm/54ce49daa7117d68120e0a7e292377b842b487ed5fe961c2ef1bc7131994abe0.map