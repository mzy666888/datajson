/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/echarts@4.5.0/lib/component/toolbox/feature/DataView.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var echarts=require("../../../echarts"),zrUtil=require("zrender/lib/core/util"),eventTool=require("zrender/lib/core/event"),lang=require("../../../lang"),featureManager=require("../featureManager"),dataViewLang=lang.toolbox.dataView,BLOCK_SPLITER=new Array(60).join("-"),ITEM_SPLITER="\t";function groupSeries(e){var t={},r=[],n=[];return e.eachRawSeries(function(e){var i=e.coordinateSystem;if(!i||"cartesian2d"!==i.type&&"polar"!==i.type)r.push(e);else{var a=i.getBaseAxis();if("category"===a.type){var o=a.dim+"_"+a.index;t[o]||(t[o]={categoryAxis:a,valueAxis:i.getOtherAxis(a),series:[]},n.push({axisDim:a.dim,axisIndex:a.index})),t[o].series.push(e)}else r.push(e)}}),{seriesGroupByCategoryAxis:t,other:r,meta:n}}function assembleSeriesWithCategoryAxis(e){var t=[];return zrUtil.each(e,function(e,r){var n=e.categoryAxis,i=e.valueAxis.dim,a=[" "].concat(zrUtil.map(e.series,function(e){return e.name})),o=[n.model.getCategories()];zrUtil.each(e.series,function(e){o.push(e.getRawData().mapArray(i,function(e){return e}))});for(var s=[a.join(ITEM_SPLITER)],l=0;l<o[0].length;l++){for(var u=[],p=0;p<o.length;p++)u.push(o[p][l]);s.push(u.join(ITEM_SPLITER))}t.push(s.join("\n"))}),t.join("\n\n"+BLOCK_SPLITER+"\n\n")}function assembleOtherSeries(e){return zrUtil.map(e,function(e){var t=e.getRawData(),r=[e.name],n=[];return t.each(t.dimensions,function(){for(var e=arguments.length,i=arguments[e-1],a=t.getName(i),o=0;o<e-1;o++)n[o]=arguments[o];r.push((a?a+ITEM_SPLITER:"")+n.join(ITEM_SPLITER))}),r.join("\n")}).join("\n\n"+BLOCK_SPLITER+"\n\n")}function getContentFromModel(e){var t=groupSeries(e);return{value:zrUtil.filter([assembleSeriesWithCategoryAxis(t.seriesGroupByCategoryAxis),assembleOtherSeries(t.other)],function(e){return e.replace(/[\n\t\s]/g,"")}).join("\n\n"+BLOCK_SPLITER+"\n\n"),meta:t.meta}}function trim(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function isTSVFormat(e){if(e.slice(0,e.indexOf("\n")).indexOf(ITEM_SPLITER)>=0)return!0}var itemSplitRegex=new RegExp("["+ITEM_SPLITER+"]+","g");function parseTSVContents(e){for(var t=e.split(/\n+/g),r=trim(t.shift()).split(itemSplitRegex),n=[],i=zrUtil.map(r,function(e){return{name:e,data:[]}}),a=0;a<t.length;a++){var o=trim(t[a]).split(itemSplitRegex);n.push(o.shift());for(var s=0;s<o.length;s++)i[s]&&(i[s].data[a]=o[s])}return{series:i,categories:n}}function parseListContents(e){for(var t=e.split(/\n+/g),r=trim(t.shift()),n=[],i=0;i<t.length;i++){var a,o=trim(t[i]).split(itemSplitRegex),s="",l=!1;isNaN(o[0])?(l=!0,s=o[0],o=o.slice(1),n[i]={name:s,value:[]},a=n[i].value):a=n[i]=[];for(var u=0;u<o.length;u++)a.push(+o[u]);1===a.length&&(l?n[i].value=a[0]:n[i]=a[0])}return{name:r,data:n}}function parseContents(e,t){var r=e.split(new RegExp("\n*"+BLOCK_SPLITER+"\n*","g")),n={series:[]};return zrUtil.each(r,function(e,r){if(isTSVFormat(e)){var i=parseTSVContents(e),a=t[r],o=a.axisDim+"Axis";a&&(n[o]=n[o]||[],n[o][a.axisIndex]={data:i.categories},n.series=n.series.concat(i.series))}else{i=parseListContents(e);n.series.push(i)}}),n}function DataView(e){this._dom=null,this.model=e}function tryMergeDataOption(e,t){return zrUtil.map(e,function(e,r){var n=t&&t[r];return zrUtil.isObject(n)&&!zrUtil.isArray(n)?(zrUtil.isObject(e)&&!zrUtil.isArray(e)&&(e=e.value),zrUtil.defaults({value:e},n)):e})}DataView.defaultOption={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:zrUtil.clone(dataViewLang.title),lang:zrUtil.clone(dataViewLang.lang),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"},DataView.prototype.onclick=function(e,t){var r=t.getDom(),n=this.model;this._dom&&r.removeChild(this._dom);var i=document.createElement("div");i.style.cssText="position:absolute;left:5px;top:5px;bottom:5px;right:5px;",i.style.backgroundColor=n.get("backgroundColor")||"#fff";var a=document.createElement("h4"),o=n.get("lang")||[];a.innerHTML=o[0]||n.get("title"),a.style.cssText="margin: 10px 20px;",a.style.color=n.get("textColor");var s=document.createElement("div"),l=document.createElement("textarea");s.style.cssText="display:block;width:100%;overflow:auto;";var u=n.get("optionToContent"),p=n.get("contentToOption"),c=getContentFromModel(e);if("function"==typeof u){var d=u(t.getOption());"string"==typeof d?s.innerHTML=d:zrUtil.isDom(d)&&s.appendChild(d)}else s.appendChild(l),l.readOnly=n.get("readOnly"),l.style.cssText="width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;",l.style.color=n.get("textColor"),l.style.borderColor=n.get("textareaBorderColor"),l.style.backgroundColor=n.get("textareaColor"),l.value=c.value;var g=c.meta,h=document.createElement("div");h.style.cssText="position:absolute;bottom:0;left:0;right:0;";var m="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",f=document.createElement("div"),v=document.createElement("div");m+=";background-color:"+n.get("buttonColor"),m+=";color:"+n.get("buttonTextColor");var x=this;function y(){r.removeChild(i),x._dom=null}eventTool.addEventListener(f,"click",y),eventTool.addEventListener(v,"click",function(){var e;try{e="function"==typeof p?p(s,t.getOption()):parseContents(l.value,g)}catch(e){throw y(),new Error("Data view format error "+e)}e&&t.dispatchAction({type:"changeDataView",newOption:e}),y()}),f.innerHTML=o[1],v.innerHTML=o[2],v.style.cssText=m,f.style.cssText=m,!n.get("readOnly")&&h.appendChild(v),h.appendChild(f),i.appendChild(a),i.appendChild(s),i.appendChild(h),s.style.height=r.clientHeight-80+"px",r.appendChild(i),this._dom=i},DataView.prototype.remove=function(e,t){this._dom&&t.getDom().removeChild(this._dom)},DataView.prototype.dispose=function(e,t){this.remove(e,t)},featureManager.register("dataView",DataView),echarts.registerAction({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(e,t){var r=[];zrUtil.each(e.newOption.series,function(e){var n=t.getSeriesByName(e.name)[0];if(n){var i=n.get("data");r.push({name:e.name,data:tryMergeDataOption(e.data,i)})}else r.push(zrUtil.extend({type:"scatter"},e))}),t.mergeOption(zrUtil.defaults({series:r},e.newOption))});var _default=DataView;module.exports=_default;
//# sourceMappingURL=/sm/abe010940c41154e662d15619d806c271d88f713d1ba0adca26421e4907ab5de.map